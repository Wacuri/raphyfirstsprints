{"version":3,"sources":["webpack:///webpack/bootstrap 9aa17758184194ed741a","webpack:///external \"debug\"","webpack:///external \"react\"","webpack:///external \"mongoose\"","webpack:///../client/src/state.js","webpack:///../node_modules/Agenda/lib/utils/index.js","webpack:///external \"react-easy-state\"","webpack:///external \"path\"","webpack:///external \"human-interval\"","webpack:///external \"moment\"","webpack:///external \"express\"","webpack:///external \"opentok-react\"","webpack:///external \"@opentok/client\"","webpack:///external \"dotenv\"","webpack:///external \"fs\"","webpack:///external \"events\"","webpack:///../node_modules/Agenda/lib/job/index.js","webpack:///external \"date.js\"","webpack:///../node_modules/Agenda/lib/utils/create-job.js","webpack:///external \"opentok\"","webpack:///./models/journey_space.js","webpack:///./models/journey_rsvp.js","webpack:///./models/journey_content.js","webpack:///external \"isomorphic-fetch\"","webpack:///external \"react-router\"","webpack:///external \"react-router-dom\"","webpack:///external \"prop-types\"","webpack:///external \"babel-polyfill/lib/index\"","webpack:///./index.js","webpack:///external \"isomorphic-loader/lib/extend-require\"","webpack:///./jobs/index.js","webpack:///../node_modules/Agenda/index.js","webpack:///../node_modules/Agenda/lib/agenda/index.js","webpack:///../node_modules/Agenda/lib/agenda/mongo.js","webpack:///../node_modules/Agenda/lib/agenda/database.js","webpack:///external \"mongodb\"","webpack:///../node_modules/Agenda/lib/agenda/db-init.js","webpack:///../node_modules/Agenda/lib/agenda/name.js","webpack:///../node_modules/Agenda/lib/agenda/process-every.js","webpack:///../node_modules/Agenda/lib/agenda/max-concurrency.js","webpack:///../node_modules/Agenda/lib/agenda/default-concurrency.js","webpack:///../node_modules/Agenda/lib/agenda/locklimit.js","webpack:///../node_modules/Agenda/lib/agenda/default-lock-limit.js","webpack:///../node_modules/Agenda/lib/agenda/default-lock-lifetime.js","webpack:///../node_modules/Agenda/lib/agenda/sort.js","webpack:///../node_modules/Agenda/lib/agenda/create.js","webpack:///../node_modules/Agenda/lib/job/to-json.js","webpack:///../node_modules/Agenda/lib/job/compute-next-run-at.js","webpack:///external \"cron\"","webpack:///external \"moment-timezone\"","webpack:///../node_modules/Agenda/lib/job/repeat-every.js","webpack:///../node_modules/Agenda/lib/job/repeat-at.js","webpack:///../node_modules/Agenda/lib/job/disable.js","webpack:///../node_modules/Agenda/lib/job/enable.js","webpack:///../node_modules/Agenda/lib/job/unique.js","webpack:///../node_modules/Agenda/lib/job/schedule.js","webpack:///../node_modules/Agenda/lib/job/priority.js","webpack:///../node_modules/Agenda/lib/job/fail.js","webpack:///../node_modules/Agenda/lib/job/run.js","webpack:///../node_modules/Agenda/lib/job/is-running.js","webpack:///../node_modules/Agenda/lib/job/save.js","webpack:///../node_modules/Agenda/lib/job/remove.js","webpack:///../node_modules/Agenda/lib/job/touch.js","webpack:///../node_modules/Agenda/lib/agenda/jobs.js","webpack:///../node_modules/Agenda/lib/utils/process-jobs.js","webpack:///../node_modules/Agenda/lib/agenda/purge.js","webpack:///../node_modules/Agenda/lib/agenda/define.js","webpack:///../node_modules/Agenda/lib/agenda/every.js","webpack:///../node_modules/Agenda/lib/agenda/schedule.js","webpack:///../node_modules/Agenda/lib/agenda/now.js","webpack:///../node_modules/Agenda/lib/agenda/cancel.js","webpack:///../node_modules/Agenda/lib/agenda/save-job.js","webpack:///../node_modules/Agenda/lib/agenda/start.js","webpack:///../node_modules/Agenda/lib/agenda/stop.js","webpack:///../node_modules/Agenda/lib/agenda/find-and-lock-next-job.js","webpack:///external \"lodash\"","webpack:///external \"another-mongoose-statemachine\"","webpack:///./routes/index.js","webpack:///external \"ssl-express-www\"","webpack:///external \"body-parser\"","webpack:///./routes/api.js","webpack:///./models/journey_participant.js","webpack:///./routes/ssr.js","webpack:///external \"react-dom/server\"","webpack:///external \"redux\"","webpack:///external \"react-redux\"","webpack:///../client/src/app.js","webpack:///../client/src/components/header.js","webpack:///../client/res/images/CuriousLive-logo.png","webpack:///../client/src/components/home.js","webpack:///../client/src/components/user_list.js","webpack:///../client/src/components/generator_form.js","webpack:///../client/src/components/event_message.js","webpack:///../client/src/components/journey_space_form.js","webpack:///../client/src/components/journey_detail_entry.js","webpack:///../client/src/components/session_info.js","webpack:///../client/src/components/Room.js","webpack:///external \"js-cookie\"","webpack:///external \"react-swipeable-views\"","webpack:///../client/src/components/signature_pad.js","webpack:///external \"uuid\"","webpack:///external \"opentok-layout-js\"","webpack:///../client/src/components/share.js","webpack:///external \"es6-promise\"","webpack:///../client/src/components/countdown_message.js","webpack:///external \"agenda\"","webpack:///external \"agendash\"","webpack:///external \"express-session\"","webpack:///external \"connect-mongo\""],"names":["state","session","sessionId","journeys","joinableJourneys","loggedIn","user","location","audioTag","__CLIENT__","Audio","global","__INITIAL_STATE__","FlagSchema","type","String","reason","JourneySpaceSchema","room","index","name","image","currentTime","Number","journey","default","startAt","Date","flags","timestamps","plugin","states","created","joined","started","paused","completed","ended","expired","failed","transitions","from","to","start","pause","fail","complete","end","expire","reset","methods","skip","JourneySpace","model","JourneyRSVPSchema","Types","ObjectId","ref","JourneyRSVP","JourneyContentSchema","filePath","JourneyContent","dotenv","require","config","__SERVER__","extendRequire","then","catch","err","console","log","agenda","db","address","process","env","MONGODB_URI","MONGO_URL","opentok","OPENTOK_KEY","OPENTOK_SECRET","connection","define","job","done","collection","aggregate","$sample","size","toArray","randomJourney","journeySpace","toLowerCase","replace","getTime","add","toDate","save","schedule","_id","findOne","exec","globalSpace","response","toJSON","rsvps","signal","JSON","stringify","find","$lt","subtract","expiredJourneys","attrs","data","findById","length","on","every","app","use","secret","saveUninitialized","resave","store","url","cookie","expires","set","join","__dirname","json","static","listen","PORT","connect","promisify","fn","promisified","params","Promise","resolve","reject","concat","args","router","Router","generateToken","tokenOptions","role","token","get","req","res","existingSession","createSession","present","lean","participants","currentUserHasRSVP","findIndex","rsvp","id","push","selectedJourney","query","newSession","post","connectionId","body","connections","count","participantExists","participant","sendStatus","$match","$in","$gte","$ne","$lookup","localField","foreignField","as","$sort","put","messageData","userName","description","ready","allReady","journeyFile","journeyContent","userId","sessionID","event","destroy","clearCookie","redirect","fetch","headers","method","mode","JourneyParticipantSchema","Boolean","JourneyParticipant","context","originalUrl","html","renderToString","writeHead","Location","status","render","NODE_ENV","script","openTokKey","OTSession","OTPublisher","OTStreams","OTSubscriber","OT","document","addEventListener","e","play","RequireLoginRoute","Component","component","rest","renderProps","pathname","Login","props","login","preventDefault","credentials","history","field","setState","target","value","padding","width","onChange","propTypes","match","object","isRequired","JoinableJourneyCard","onJoin","cache","referrer","format","AutoCreatedJourneysQueue","roomUrl","sessionHelper","apiKey","onConnect","parse","idx","j","slice","map","App","Header","display","alignItems","color","fontSize","Home","streams","publisherId","totalConnectionsCreated","connectedUsers","publisher","setTimeout","refreshSession","onStreamsUpdated","window","sh","updatedConnectionCount","newData","d","indexOf","splice","tries","fetchRetry","displayMessageVisible","displayMessageText","sessionUrl","UserList","userCount","GeneratorForm","sessionLinkName","sessionLinkUrl","activeJourneys","handleNameChange","bind","urlFriendlyName","createSessionLink","EventMessage","backgroundColor","JourneySpaceForm","visible","toggleVisibility","border","JourneyDetailEntry","sessionVisible","nextProps","detailVisibility","SessionInfo","jumpToSession","sessionLink","sessionVisibility","open","fontWeight","polyfill","AbstractTimerEmitter","millisec","normalizeTime","time","padStart","seconds","toFixed","minutes","Math","floor","parseInt","toString","hours","SecondsTimerEmitter","createdAt","total","passed","interval","setInterval","clearInterval","emit","_displayTime","AudioPlayTickEmitter","audioElement","onTimeUpdate","duration","readyState","FlagControl","currentUserHasFlaggedJourney","onFlag","children","Waiting","onToggle","canvas","fadeOut","ctx","_this","getContext","fillStyle","fillRect","height","signaturePad","penColor","minWidth","maxWidth","overflow","position","el","transform","WebkitOverflowScrolling","overflowY","JourneyStateProgressBar","timer","current","timerValue","newProps","clear","formatState","marginLeft","displayTime","JourneyTimeline","container","stepIndex","bottom","left","right","heightForActive","positionForCaret","items","querySelectorAll","Array","fill","reduce","memo","i","offsetHeight","SkipButton","skipToNext","style","VideoButton","toggle","publishVideo","publishing","AudioButton","publishAudio","PlayButton","player","LeaveRoomButton","onLeave","JourneyStartsIn","borderBottom","SharePrompt","textAlign","fontFamily","lineHeight","onInvite","InviteModal","journeySpaceName","error","onCopy","protocol","host","success","_copy","onComplete","span","createElement","textContent","whiteSpace","top","win","selection","getSelection","appendChild","range","createRange","removeAllRanges","selectNode","addRange","execCommand","remove","onClose","margin","listStyle","cursor","background","flexDirection","justifyContent","Intro","goTo","onChangeIndex","last","onSkip","views","minHeight","swipeable","alignSelf","view","marginRight","onInitPublisher","onConfirmReady","onChangeJourney","onStartSession","onLoadedMetadata","journeyDuration","removeEventListener","playerProgress","playerProgressMS","isHostUser","onShare","navigator","share","title","text","showShareModal","onCloseShareModal","onCompleteShare","playerState","currentlyActivePublisher","showIntro","test","src","search","playPromise","undefined","onAudioCanPlay","isNaN","load","disconnect","currentParticipant","flag","flex","stream","journeyStateTimer","remainingSeconds","secondsEmitter","IntroWrapper","factory","exports","module","SignaturePad","Point","x","y","now","prototype","distanceTo","sqrt","pow","equals","other","velocityFrom","Bezier","startPoint","control2","control1","endPoint","startWidth","endWidth","fromPoints","points","widths","c2","calculateControlPoints","c3","c1","s1","s2","s3","dx1","dy1","dx2","dy2","m1","m2","l1","l2","dxm","dym","k","cm","tx","ty","steps","px","py","t","cx","point","cy","xdiff","ydiff","throttle","wait","previous","timeout","result","storedContext","storedArgs","later","apply","_i","arguments","remaining","clearTimeout","options","_handleMouseDown","which","_mouseButtonDown","_strokeBegin","_handleMouseMove","_strokeMoveUpdate","_handleMouseUp","_strokeEnd","_handleTouchStart","targetTouches","touch","changedTouches","_handleTouchMove","_handleTouchEnd","wasCanvasTouched","velocityFilterWeight","minDistance","_strokeUpdate","dotSize","onBegin","onEnd","_ctx","clearRect","_data","_reset","_isEmpty","fromDataURL","dataUrl","callback","Image","ratio","devicePixelRatio","onload","drawImage","onerror","toDataURL","encoderOptions","_toSVG","_handleMouseEvents","_handleTouchEvents","off","msTouchAction","touchAction","isEmpty","fromData","pointGroups","_fromData","_a","curve","_drawCurve","_drawDot","toData","newPointGroup","clientX","clientY","_createPoint","lastPointGroup","lastPoints","lastPoint","isLastPointTooClose","_addPoint","_points","_lastVelocity","_lastWidth","rect","getBoundingClientRect","unshift","_calculateCurveWidths","shift","velocity","newWidth","_strokeWidth","max","_drawCurveSegment","moveTo","arc","PI","widthDelta","drawSteps","beginPath","tt","ttt","u","uu","uuu","closePath","drawCurve","drawDot","pointGroups_1","group","basicPoint","minX","minY","maxX","maxY","svg","createElementNS","setAttribute","path","attr","circle","prefix","header","innerHTML","dummy","nodes","childNodes","cloneNode","footer","btoa","android","userAgent","ios","isDesktop","shareUrls","whatsapp","payload","telegram","facebook","fbid","encodeURIComponent","email","sms","WebShareUI","_initialized","template","$root","querySelector","$whatsapp","$facebook","$telegram","$email","$sms","$copy","onclick","_hide","classList","payloadObj","facebookId","href","_init","_hideTimer","_setPayload","offsetWidth","forEach","opacity","shareUi","show","CountdownMessage","currentCount","days","countdown","intervalId","deadline","endTime","timeRemaining","totalTimeInMinutes","message"],"mappings":";AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAK;AACL;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;AAEA;AACA;;;;;;;AC7DA,kC;;;;;;ACAA,kC;;;;;;ACAA,qC;;;;;;;;;;;;;;;ACAA;;AAEA,IAAMA,QAAS;AACbC,WAAS,IADI;AAEbC,aAAW,IAFE;AAGbC,YAAU,EAHG;AAIbC,oBAAkB,EAJL;AAKbC,YAAU,KALG;AAMbC,QAAM,IANO;AAObC,YAAU,GAPG;AAQbC,YAAUC,aAAa,IAAIC,KAAJ,CAAU,gEAAV,CAAb,GAA2F;AARxF,GASTC,OAAOC,iBAAP,IAA4B,EATnB,EAAf;;kBAYeZ,K;;;;;;ACdf;AACA;;AAEA;AACA;AACA;AACA;;;;;;;ACNA,6C;;;;;;ACAA,iC;;;;;;ACAA,2C;;;;;;ACAA,mC;;;;;;ACAA,oC;;;;;;ACAA,0C;;;;;;ACAA,4C;;;;;;ACAA,mC;;;;;;ACAA,+B;;;;;;ACAA,mC;;;;;;;ACAA;;AAEA;AACA;AACA,WAAW,cAAc;AACzB,aAAa,OAAO;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;;;;;AChEA,oC;;;;;;;ACAA;AACA;;AAEA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,aAAa,WAAW;AACxB;AACA;AACA;AACA;AACA;;;;;;;ACZA,oC;;;;;;;;;;;;;ACAA;;;;AACA;;;;AACA;;;;;;;;AAEA,IAAMa,aAAa,qBAAW;AAC5BP,QAAM,EAACQ,MAAMC,MAAP,EADsB;AAE5BC,UAAQ,EAACF,MAAMC,MAAP;AAFoB,CAAX,CAAnB;;AAKA,IAAME,qBAAqB,qBAAW;AACpCC,QAAM,EAACJ,MAAMC,MAAP,EAAeI,OAAO,IAAtB,EAD8B;AAEpCC,QAAM,EAACN,MAAMC,MAAP,EAAeI,OAAO,IAAtB,EAF8B;AAGpCE,SAAO,EAACP,MAAMC,MAAP,EAH6B;AAIpCO,eAAa,EAACR,MAAMS,MAAP,EAJuB;AAKpCrB,aAAW,EAACY,MAAMC,MAAP,EAAeI,OAAO,IAAtB,EALyB;AAMpCK,WAAS,EAACV,MAAMC,MAAP,EAAeU,SAAS,4CAAxB,EAN2B;AAOpCC,WAAS,EAACZ,MAAMa,IAAP,EAP2B;AAQpCC,SAAO,EAACd,MAAM,CAACD,UAAD,CAAP,EAAqBY,SAAS,EAA9B;AAR6B,CAAX,EASxB;AACDI,cAAY;AADX,CATwB,CAA3B;;AAaAZ,mBAAmBa,MAAnB,wCAAwC;AACtCC,UAAQ;AACNC,aAAS,EAACP,SAAS,IAAV,EADH;AAENQ,YAAQ,EAFF;AAGNC,aAAS,EAHH;AAINC,YAAQ,EAJF;AAKNC,eAAW,EALL;AAMNC,WAAO,EAND;AAONC,aAAS,EAPH;AAQNC,YAAQ;AARF,GAD8B;AAWtCC,eAAa;AACXP,YAAQ,EAAEQ,MAAM,SAAR,EAAmBC,IAAI,QAAvB,EADG;AAEXC,WAAO,EAAEF,MAAM,CAAC,QAAD,EAAW,SAAX,EAAsB,QAAtB,EAAgC,QAAhC,CAAR,EAAmDC,IAAI,SAAvD,EAFI;AAGXE,WAAO,EAAEH,MAAM,CAAC,SAAD,CAAR,EAAqBC,IAAI,QAAzB,EAHI;AAIXG,UAAM,EAAEJ,MAAM,CAAC,QAAD,EAAW,SAAX,CAAR,EAA+BC,IAAI,QAAnC,EAJK;AAKXI,cAAU,EAAEL,MAAM,CAAC,SAAD,EAAY,SAAZ,CAAR,EAAgCC,IAAI,WAApC,EALC;AAMXK,SAAK,EAAEN,MAAM,GAAR,EAAaC,IAAI,OAAjB,EANM;AAOXM,YAAQ,EAAEP,MAAM,GAAR,EAAaC,IAAI,SAAjB,EAPG;AAQXO,WAAO,EAAER,MAAM,GAAR,EAAaC,IAAI,SAAjB;AARI;AAXyB,CAAxC;;AAuBAzB,mBAAmBiC,OAAnB,CAA2BC,IAA3B,2DAAkC;AAAA;AAAA;AAAA;AAAA;AAAA,wBACzB,KAAKnD,KADoB;AAAA,0CAEzB,QAFyB,uBAKzB,SALyB,uBAQzB,WARyB,uBAWzB,OAXyB;AAAA;;AAAA;AAAA;AAAA,iBAGtB,KAAK2C,KAAL,EAHsB;;AAAA;AAAA;;AAAA;AAAA;AAAA,iBAMtB,KAAKG,QAAL,EANsB;;AAAA;AAAA;;AAAA;AAAA;AAAA,iBAStB,KAAKC,GAAL,EATsB;;AAAA;AAAA;;AAAA;AAAA;AAAA,iBAYtB,KAAKC,MAAL,EAZsB;;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,CAAlC;;AAkBA,IAAMI,eAAe,mBAASC,KAAT,CAAe,cAAf,EAA+BpC,kBAA/B,CAArB;;kBAEemC,Y;;;;;;;;;;;;;ACjEf;;;;;;AAEA,IAAME,oBAAoB,qBAAW;AACnC9B,WAAS,EAACV,MAAM,iBAAOyC,KAAP,CAAaC,QAApB,EAA8BC,KAAK,cAAnC,EAD0B;AAEnCnD,QAAM,EAACQ,MAAMC,MAAP;AAF6B,CAAX,CAA1B;;AAKA,IAAM2C,cAAc,mBAASL,KAAT,CAAe,aAAf,EAA8BC,iBAA9B,CAApB;;kBAEeI,W;;;;;;;;;;;;;ACTf;;;;;;AAEA,IAAMC,uBAAuB,qBAAW;AACtCC,YAAU,EAAC9C,MAAMC,MAAP,EAD4B;AAEtCK,QAAM,EAACN,MAAMC,MAAP,EAFgC;AAGtCM,SAAO,EAACP,MAAMC,MAAP;AAH+B,CAAX,EAI1B;AACDc,cAAY;AADX,CAJ0B,CAA7B;;AAQA,IAAMgC,iBAAiB,mBAASR,KAAT,CAAe,gBAAf,EAAiCM,oBAAjC,CAAvB;;kBAEeE,c;;;;;;ACZf,6C;;;;;;ACAA,yC;;;;;;ACAA,6C;;;;;;ACAA,uC;;;;;;;;;;;;;;ACAA,qD;;;;;;;;;ACAA,IAAMC,SAAS,mBAAAC,CAAQ,EAAR,CAAf;;AAEAD,OAAOE,MAAP;AACArD,OAAOF,UAAP,GAAoB,KAApB;AACAE,OAAOsD,UAAP,GAAoB,IAApB;;AAEA,IAAIC,gBAAgB,mBAAAH,CAAQ,EAAR,CAApB;;AAEA,mBAAAA,CAAQ,EAAR;;AAEAG,gBAAgBC,IAAhB,CAAqB,YAAY;AAC7BJ,IAAA,mBAAAA,CAAQ,EAAR;AACH,CAFD,EAEGK,KAFH,CAES,UAAUC,GAAV,EAAe;AACpBC,YAAQC,GAAR,CAAYF,GAAZ;AACH,CAJD,E;;;;;;ACVA,iE;;;;;;;;;ACAA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;;;;;AAEA,IAAMG,SAAS,qBAAW,EAACC,IAAI,EAACC,SAASC,QAAQC,GAAR,CAAYC,WAAZ,IAA2BF,QAAQC,GAAR,CAAYE,SAAjD,EAAL,EAAX,CAAf;AACA,IAAMC,UAAU,sBAAYJ,QAAQC,GAAR,CAAYI,WAAxB,EAAqCL,QAAQC,GAAR,CAAYK,cAAjD,CAAhB;AACA,IAAMR,KAAK,mBAASS,UAApB;;AAEAV,OAAOW,MAAP,CAAc,sBAAd;AAAA,qEAAsC,iBAAeC,GAAf,EAAoBC,IAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAELZ,GAAGa,UAAH,CAAc,iBAAd,EAAiCC,SAAjC,CAA2C,CAAC,EAACC,SAAS,EAACC,MAAM,CAAP,EAAV,EAAD,CAA3C,EAAmEC,OAAnE,EAFK;;AAAA;AAE5BC,yBAF4B,iBAEyE,CAFzE;AAG5BC,wBAH4B,GAGb,4BAAiB;AACpCpE,uBAASmE,cAAc/B,QADa;AAEpCxC,oBAAMuE,cAAcvE,IAFgB;AAGpCC,qBAAOsE,cAActE,KAHe;AAIpCH,oBAASyE,cAAcvE,IAAd,CAAmByE,WAAnB,GAAiCC,OAAjC,CAAyC,UAAzC,EAAqD,GAArD,CAAT,SAAuE,IAAInE,IAAJ,EAAD,CAAaoE,OAAb,EAJlC;AAKpCrE,uBAAS,wBAASsE,GAAT,CAAa,EAAb,EAAiB,SAAjB,EAA4BC,MAA5B;AAL2B,aAAjB,CAHa;AAAA;AAAA,mBAU5BL,aAAaM,IAAb,EAV4B;;AAAA;AAAA;AAAA,mBAW5B1B,OAAO2B,QAAP,CAAgBP,aAAalE,OAA7B,EAAsC,eAAtC,EAAuD,EAACF,SAASoE,aAAaQ,GAAvB,EAAvD,CAX4B;;AAAA;AAAA;AAAA,mBAYR,wBAAaC,OAAb,CAAqB,EAACnF,MAAM,oBAAP,EAArB,EAAmDoF,IAAnD,EAZQ;;AAAA;AAY5BC,uBAZ4B;;AAalC,gBAAIA,WAAJ,EAAiB;AACTC,sBADS,GACEZ,aAAaa,MAAb,EADF;;AAEfD,uBAASE,KAAT,GAAiB,EAAjB;AACA3B,sBAAQ4B,MAAR,CAAeJ,YAAYrG,SAA3B,EAAsC,IAAtC,EAA4C,EAAE,QAAQ,mBAAV,EAA+B,QAAQ0G,KAAKC,SAAL,CAAeL,QAAf,CAAvC,EAA5C,EAA+GnB,IAA/G;AACD,aAJD,MAIO;AACLA;AACD;AAnBiC;AAAA;;AAAA;AAAA;AAAA;;AAqBlCf,oBAAQC,GAAR;AACAc;;AAtBkC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAtC;;AAAA;AAAA;AAAA;AAAA;;AA0BAb,OAAOW,MAAP,CAAc,wBAAd;AAAA,sEAAwC,kBAAeC,GAAf,EAAoBC,IAApB;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAEN,wBAAayB,IAAb,CAAkB,EAAC9G,OAAO,SAAR,EAAmB0B,SAAS,EAACqF,KAAK,wBAASC,QAAT,CAAkB,CAAlB,EAAqB,SAArB,CAAN,EAA5B,EAAlB,EAAuFV,IAAvF,EAFM;;AAAA;AAE9BW,2BAF8B;AAAA;AAAA,mBAGV,wBAAaZ,OAAb,CAAqB,EAACnF,MAAM,oBAAP,EAArB,EAAmDoF,IAAnD,EAHU;;AAAA;AAG9BC,uBAH8B;AAAA;AAAA;AAAA;AAAA;AAAA,wBAIhBU,eAJgB;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAI3BzF,mBAJ2B;AAAA;AAAA,mBAK5BA,QAAQwB,MAAR,EAL4B;;AAAA;AAMlC,gBAAIuD,WAAJ,EAAiB;AACfxB,sBAAQ4B,MAAR,CAAeJ,YAAYrG,SAA3B,EAAsC,IAAtC,EAA4C,EAAE,QAAQ,gBAAV,EAA4B,QAAQ0G,KAAKC,SAAL,CAAerF,OAAf,CAApC,EAA5C,EAA2G,YAAM,CAAE,CAAnH;AACD;;AARiC;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAUpC6D;AAVoC;AAAA;;AAAA;AAAA;AAAA;;AAYpCf,oBAAQC,GAAR;AACAc;;AAboC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAxC;;AAAA;AAAA;AAAA;AAAA;;AAiBAb,OAAOW,MAAP,CAAc,eAAd;AAAA,sEAA+B,kBAAeC,GAAf,EAAoBC,IAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEpB7D,mBAFoB,GAET4D,IAAI8B,KAAJ,CAAUC,IAFD,CAEpB3F,OAFoB;AAAA;AAAA,mBAGA,wBAAa4F,QAAb,CAAsB5F,OAAtB,EAA+B8E,IAA/B,EAHA;;AAAA;AAGrBV,wBAHqB;AAAA;AAAA,mBAID,wBAAaS,OAAb,CAAqB,EAACnF,MAAM,oBAAP,EAArB,EAAmDoF,IAAnD,EAJC;;AAAA;AAIrBC,uBAJqB;AAAA;AAAA,mBAKP,uBAAYO,IAAZ,CAAiB,EAACtF,SAASoE,aAAaQ,GAAvB,EAAjB,EAA8CE,IAA9C,EALO;;AAAA;AAKrBI,iBALqB;;AAAA,kBAMvBA,MAAMW,MAAN,GAAe,CANQ;AAAA;AAAA;AAAA;;AAAA;AAAA,mBAOnBzB,aAAajD,KAAb,EAPmB;;AAAA;AAQzBoC,oBAAQ4B,MAAR,CAAef,aAAa1F,SAA5B,EAAuC,IAAvC,EAA6C,EAAE,QAAQ,cAAV,EAA0B,QAAQ0G,KAAKC,SAAL,CAAe,EAACrF,gBAAD,EAAf,CAAlC,EAA7C,EAA4G,YAAM,CAAE,CAApH;AARyB;AAAA;;AAAA;AAAA;AAAA,mBAUnBoE,aAAa/C,IAAb,EAVmB;;AAAA;AAWzBkC,oBAAQ4B,MAAR,CAAef,aAAa1F,SAA5B,EAAuC,IAAvC,EAA6C,EAAE,QAAQ,aAAV,EAAyB,QAAQ0G,KAAKC,SAAL,CAAe,EAACrF,gBAAD,EAAf,CAAjC,EAA7C,EAA2G,YAAM,CAAE,CAAnH;AACAuD,oBAAQ4B,MAAR,CAAeJ,YAAYrG,SAA3B,EAAsC,IAAtC,EAA4C,EAAE,QAAQ,aAAV,EAAyB,QAAQ0G,KAAKC,SAAL,CAAejB,aAAaa,MAAb,EAAf,CAAjC,EAA5C,EAAsH,YAAM,CAAE,CAA9H;;AAZyB;AAc3BpB;AAd2B;AAAA;;AAAA;AAAA;AAAA;;AAgB3BA;;AAhB2B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAA/B;;AAAA;AAAA;AAAA;AAAA;;AAqBAb,OAAO8C,EAAP,CAAU,OAAV,EAAmB,YAAW;AAC5B9C,SAAO+C,KAAP,CAAa,UAAb,EAAyB,sBAAzB;AACA/C,SAAO+C,KAAP,CAAa,UAAb,EAAyB,wBAAzB;;AAEA/C,SAAO7B,KAAP;AACD,CALD,E;;;;;;AC/EA;;AAEA;;;;;;;;ACFA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6EAA6E;AAC7E,iCAAiC;AACjC,mCAAmC,QAAQ,eAAe,qDAAqD;;AAE/G;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA,mDAAgD;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;;;;;;ACnEA;;AAEA;AACA;AACA,WAAW,YAAY;AACvB,WAAW,OAAO;AAClB,WAAW,SAAS;AACpB,aAAa,QAAQ;AACrB;AACA;AACA;AACA;AACA;AACA;;;;;;;;ACbA;AACA;AACA;;AAEA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,SAAS;AACpB,aAAa;AACb;AACA,gEAAgE,0BAA0B;AAC1F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,2BAA2B,oGAAoG;AAC/H;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;;;;;;ACzCA,oC;;;;;;;ACAA;AACA;;AAEA;AACA;AACA,WAAW,MAAM;AACjB,WAAW,EAAE;AACb,WAAW,OAAO;AAClB,WAAW,SAAS;AACpB,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,SAAS;AACpB,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,GAAG;AACH;;;;;;;;ACjDA;AACA;;AAEA;AACA;AACA,WAAW,OAAO;AAClB,aAAa,QAAQ;AACrB;AACA;AACA;AACA;AACA;AACA;;;;;;;;ACZA;AACA;AACA;;AAEA;AACA;AACA,WAAW,OAAO;AAClB,aAAa,QAAQ;AACrB;AACA;AACA;AACA;AACA;AACA;;;;;;;;ACbA;AACA;;AAEA;AACA;AACA,WAAW,OAAO;AAClB,aAAa,QAAQ;AACrB;AACA;AACA;AACA;AACA;AACA;;;;;;;;ACZA;AACA;;AAEA;AACA;AACA,WAAW,OAAO;AAClB,aAAa,QAAQ;AACrB;AACA;AACA;AACA;AACA;AACA;;;;;;;;ACZA;AACA;;AAEA;AACA;AACA;AACA,WAAW,OAAO;AAClB,aAAa,QAAQ;AACrB;AACA;AACA;AACA;AACA;AACA;;;;;;;;ACbA;AACA;;AAEA;AACA;AACA,WAAW,OAAO;AAClB,aAAa,QAAQ;AACrB;AACA;AACA;AACA;AACA;AACA;;;;;;;;ACZA;AACA;;AAEA;AACA;AACA;AACA,WAAW,OAAO;AAClB,aAAa,QAAQ;AACrB;AACA;AACA;AACA;AACA;AACA;;;;;;;;ACbA;AACA;;AAEA;AACA;AACA,eAAe;AACf,WAAW,OAAO;AAClB,aAAa,QAAQ;AACrB;AACA;AACA;AACA;AACA;AACA;;;;;;;;ACbA;AACA;AACA;;AAEA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB;AACA,aAAa,WAAW;AACxB;AACA;AACA;AACA;AACA,uBAAuB,mDAAmD;AAC1E;AACA;;;;;;;;AChBA;;AAEA;AACA;AACA,aAAa,OAAO;AACpB;AACA;AACA;AACA;AACA;;AAEA;AACA,UAAU;AACV;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;;;;;;;;ACzBA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,aAAa,QAAQ;AACrB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,OAAO;AACP,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;;;;;;AC3FA,iC;;;;;;ACAA,4C;;;;;;;ACAA;;AAEA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,aAAa,QAAQ;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;ACbA;;AAEA;AACA;AACA,WAAW,OAAO;AAClB,aAAa,QAAQ;AACrB;AACA;AACA;AACA;AACA;;;;;;;;ACVA;;AAEA;AACA;AACA,aAAa,QAAQ;AACrB;AACA;AACA;AACA;AACA;;;;;;;;ACTA;;AAEA;AACA;AACA,aAAa,QAAQ;AACrB;AACA;AACA;AACA;AACA;;;;;;;;ACTA;;AAEA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,aAAa,QAAQ;AACrB;AACA;AACA;AACA;AACA;AACA;;;;;;;;ACZA;AACA;;AAEA;AACA;AACA,WAAW,OAAO;AAClB,aAAa,QAAQ;AACrB;AACA;AACA;AACA;AACA;;;;;;;;ACXA;;AAEA;AACA;AACA,WAAW,cAAc;AACzB,aAAa,OAAO;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW,OAAO;AAClB,aAAa,QAAQ;AACrB;AACA;AACA;AACA;AACA;;;;;;;;AC7BA;AACA;;AAEA;AACA;AACA,WAAW,aAAa;AACxB,aAAa,QAAQ;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;ACnBA;AACA;;AAEA;AACA;AACA,WAAW,SAAS;AACpB,aAAa;AACb;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,wCAAwC;AACxC;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,KAAK;AACL,GAAG;AACH;;;;;;;;ACpEA;;AAEA;AACA;AACA;AACA;AACA;AACA,aAAa,QAAQ;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;ACpBA;;AAEA;AACA;AACA,WAAW,SAAS;AACpB,aAAa,QAAQ;AACrB;AACA;AACA;AACA;AACA;;;;;;;;ACVA;;AAEA;AACA;AACA,WAAW,SAAS;AACpB,aAAa;AACb;AACA;AACA,sBAAsB,oBAAoB;AAC1C;;;;;;;;ACTA;;AAEA;AACA;AACA,WAAW,SAAS;AACpB,aAAa;AACb;AACA;AACA;AACA;AACA;;;;;;;;ACVA;AACA;;AAEA;;AAEA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,SAAS;AACpB,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;;;;;;;ACpBA;AACA;AACA,iGAAiG;AACjG;AACA;;AAEA;AACA;AACA,WAAW,WAAW;AACtB,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAa,OAAO;AACpB,eAAe,QAAQ;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,aAAa,EAAE;AACf,aAAa,QAAQ;AACrB,eAAe;AACf;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,4BAA4B,iBAAiB;AAC7C;AACA;AACA;AACA;;AAEA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;;AAEA;AACA,oBAAoB,OAAO;AAC3B,qBAAqB;;AAErB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA,aAAa,OAAO;AACpB,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,oCAAoC,UAAU;AAC9C;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,aAAa,MAAM;AACnB,aAAa,WAAW;AACxB,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;;;;;;;AC7UA;AACA;;AAEA;AACA;AACA;AACA,WAAW,SAAS;AACpB,aAAa;AACb;AACA;AACA;AACA;AACA,eAAe,OAAO,OAAO,oBAAoB;AACjD;;;;;;;;ACbA;AACA;;AAEA;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,SAAS;AACpB,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;AC1BA;AACA;;AAEA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,EAAE;AACb,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,SAAS;AACpB,aAAa,EAAE;AACf;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA,aAAa,OAAO;AACpB,aAAa,EAAE;AACf,aAAa,OAAO;AACpB,aAAa,OAAO;AACpB,aAAa,SAAS;AACtB,eAAe,WAAW;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,aAAa,OAAO;AACpB,aAAa,EAAE;AACf,aAAa,OAAO;AACpB,aAAa,OAAO;AACpB,aAAa,SAAS;AACtB,eAAe,EAAE;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,OAAO;AACP,KAAK;AACL;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;;;;;;;ACjFA;AACA;;AAEA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,EAAE;AACb,WAAW,OAAO;AAClB,WAAW,SAAS;AACpB,aAAa,EAAE;AACf;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,aAAa,OAAO;AACpB,aAAa,OAAO;AACpB,aAAa,OAAO;AACpB,aAAa,SAAS;AACtB,eAAe,WAAW;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,aAAa,OAAO;AACpB,aAAa,EAAE;AACf,aAAa,OAAO;AACpB,aAAa,SAAS;AACtB,eAAe,EAAE;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,OAAO;AACP,KAAK;AACL;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;;;;;;;ACzEA;AACA;;AAEA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,SAAS;AACpB,aAAa,WAAW;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;ACpBA;AACA;;AAEA;AACA;AACA,YAAY,OAAO;AACnB,YAAY,SAAS;AACrB;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,GAAG;AACH;;;;;;;;ACtBA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,WAAW,WAAW;AACtB,WAAW,SAAS;AACpB,aAAa;AACb;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,gBAAgB;AAChB;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,gBAAgB;AAChB;;AAEA;AACA;AACA,sDAAsD,oCAAoC;AAC1F,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa,MAAM;AACnB,aAAa,EAAE;AACf;AACA,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;;;;;;;AC9IA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;;;;;;;AClBA;AACA;;AAEA;AACA;AACA,WAAW,SAAS;AACpB,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,SAAS;AACtB;AACA,eAAe;AACf;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,iCAAiC,MAAM,aAAa,GAAG,OAAO,gBAAgB;AAC9E;AACA;AACA;;AAEA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;;;;;;;;AC1CA;AACA;AAC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","file":"./server.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 26);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 9aa17758184194ed741a","module.exports = require(\"debug\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"debug\"\n// module id = 0\n// module chunks = 0","module.exports = require(\"react\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"react\"\n// module id = 1\n// module chunks = 0","module.exports = require(\"mongoose\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"mongoose\"\n// module id = 2\n// module chunks = 0","import { store } from 'react-easy-state'\n\nconst state =  store({\n  session: null,\n  sessionId: null,\n  journeys: [],\n  joinableJourneys: [],\n  loggedIn: false,\n  user: null,\n  location: '/',\n  audioTag: __CLIENT__ ? new Audio('/journeys/Journey to The Magnetic Field of the Earth+Music.mp3') : null,\n  ...(global.__INITIAL_STATE__ || {})\n});\n\nexport default state;\n\n\n\n// WEBPACK FOOTER //\n// ../client/src/state.js","const createJob = require('./create-job');\nconst processJobs = require('./process-jobs');\n\nmodule.exports = {\n  createJob,\n  processJobs\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/lib/utils/index.js\n// module id = 4\n// module chunks = 0","module.exports = require(\"react-easy-state\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"react-easy-state\"\n// module id = 5\n// module chunks = 0","module.exports = require(\"path\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"path\"\n// module id = 6\n// module chunks = 0","module.exports = require(\"human-interval\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"human-interval\"\n// module id = 7\n// module chunks = 0","module.exports = require(\"moment\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"moment\"\n// module id = 8\n// module chunks = 0","module.exports = require(\"express\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"express\"\n// module id = 9\n// module chunks = 0","module.exports = require(\"opentok-react\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"opentok-react\"\n// module id = 10\n// module chunks = 0","module.exports = require(\"@opentok/client\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"@opentok/client\"\n// module id = 11\n// module chunks = 0","module.exports = require(\"dotenv\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"dotenv\"\n// module id = 12\n// module chunks = 0","module.exports = require(\"fs\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"fs\"\n// module id = 13\n// module chunks = 0","module.exports = require(\"events\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"events\"\n// module id = 14\n// module chunks = 0","'use strict';\n\n/**\n * Internal method to turn priority into a number\n * @param {String|Number} priority string to parse into number\n * @returns {Number} priority that was parsed\n */\nconst parsePriority = priority => {\n  const priorityMap = {\n    lowest: -20,\n    low: -10,\n    normal: 0,\n    high: 10,\n    highest: 20\n  };\n  if (typeof priority === 'number' || priority instanceof Number) {\n    return priority;\n  }\n  return priorityMap[priority];\n};\n\nclass Job {\n  constructor(args) {\n    args = args || {};\n\n    // Remove special args\n    this.agenda = args.agenda;\n    delete args.agenda;\n\n    // Process args\n    args.priority = parsePriority(args.priority) || 0;\n\n    // Set attrs to args\n    const attrs = {};\n    for (const key in args) {\n      if ({}.hasOwnProperty.call(args, key)) {\n        attrs[key] = args[key];\n      }\n    }\n\n    // Set defaults if undefined\n    // NOTE: What is the difference between 'once' here and 'single' in agenda/index.js?\n    attrs.nextRunAt = attrs.nextRunAt || new Date();\n    attrs.type = attrs.type || 'once';\n    this.attrs = attrs;\n  }\n}\n\nJob.prototype.toJSON = require('./to-json');\nJob.prototype.computeNextRunAt = require('./compute-next-run-at');\nJob.prototype.repeatEvery = require('./repeat-every');\nJob.prototype.repeatAt = require('./repeat-at');\nJob.prototype.disable = require('./disable');\nJob.prototype.enable = require('./enable');\nJob.prototype.unique = require('./unique');\nJob.prototype.schedule = require('./schedule');\nJob.prototype.priority = require('./priority');\nJob.prototype.fail = require('./fail');\nJob.prototype.run = require('./run');\nJob.prototype.isRunning = require('./is-running');\nJob.prototype.save = require('./save');\nJob.prototype.remove = require('./remove');\nJob.prototype.touch = require('./touch');\n\nmodule.exports = Job;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/lib/job/index.js\n// module id = 15\n// module chunks = 0","module.exports = require(\"date.js\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"date.js\"\n// module id = 16\n// module chunks = 0","'use strict';\nconst Job = require('../job');\n\n/**\n * Create Job object from data\n * @param {Object} agenda instance of Agenda\n * @param {Object} jobData job data\n * @returns {module.Job} returns created job\n */\nmodule.exports = (agenda, jobData) => {\n  jobData.agenda = agenda;\n  return new Job(jobData);\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/lib/utils/create-job.js\n// module id = 17\n// module chunks = 0","module.exports = require(\"opentok\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"opentok\"\n// module id = 18\n// module chunks = 0","import mongoose, {Schema} from 'mongoose';\nimport statemachine from 'another-mongoose-statemachine';\nimport moment from 'moment';\n\nconst FlagSchema = new Schema({\n  user: {type: String},\n  reason: {type: String},\n});\n\nconst JourneySpaceSchema = new Schema({\n  room: {type: String, index: true},\n  name: {type: String, index: true},\n  image: {type: String},\n  currentTime: {type: Number},\n  sessionId: {type: String, index: true},\n  journey: {type: String, default: '/journeys/Journey to A Spiderweb+Music.mp3'},\n  startAt: {type: Date},\n  flags: {type: [FlagSchema], default: []},\n}, {\n  timestamps: true\n});\n\nJourneySpaceSchema.plugin(statemachine, {\n  states: {\n    created: {default: true},\n    joined: {},\n    started: {},\n    paused: {},\n    completed: {},\n    ended: {},\n    expired: {},\n    failed: {},\n  },\n  transitions: {\n    joined: { from: 'created', to: 'joined' },\n    start: { from: ['joined', 'created', 'failed', 'paused'], to: 'started' },\n    pause: { from: ['started'], to: 'paused' },\n    fail: { from: ['joined', 'created'], to: 'failed' },\n    complete: { from: ['started', 'created'], to: 'completed' },\n    end: { from: '*', to: 'ended' },\n    expire: { from: '*', to: 'expired' },\n    reset: { from: '*', to: 'created' }\n  }\n});\n\nJourneySpaceSchema.methods.skip = async function() {\n  switch(this.state) {\n    case 'joined':\n      await this.start();\n      break;\n    case 'started':\n      await this.complete();\n      break;\n    case 'completed':\n      await this.end();\n      break;\n    case 'ended':\n      await this.expire();\n      break;\n  }\n  return;\n}\n\nconst JourneySpace = mongoose.model('JourneySpace', JourneySpaceSchema);\n\nexport default JourneySpace;\n\n\n\n\n// WEBPACK FOOTER //\n// ./models/journey_space.js","import mongoose, {Schema} from 'mongoose';\n\nconst JourneyRSVPSchema = new Schema({\n  journey: {type: Schema.Types.ObjectId, ref: 'JourneySpace'},\n  user: {type: String},\n});\n\nconst JourneyRSVP = mongoose.model('JourneyRSVP', JourneyRSVPSchema);\n\nexport default JourneyRSVP;\n\n\n\n\n\n// WEBPACK FOOTER //\n// ./models/journey_rsvp.js","import mongoose, {Schema} from 'mongoose';\n\nconst JourneyContentSchema = new Schema({\n  filePath: {type: String},\n  name: {type: String},\n  image: {type: String},\n}, {\n  timestamps: true\n});\n\nconst JourneyContent = mongoose.model('JourneyContent', JourneyContentSchema);\n\nexport default JourneyContent;\n\n\n\n\n\n// WEBPACK FOOTER //\n// ./models/journey_content.js","module.exports = require(\"isomorphic-fetch\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"isomorphic-fetch\"\n// module id = 22\n// module chunks = 0","module.exports = require(\"react-router\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"react-router\"\n// module id = 23\n// module chunks = 0","module.exports = require(\"react-router-dom\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"react-router-dom\"\n// module id = 24\n// module chunks = 0","module.exports = require(\"prop-types\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"prop-types\"\n// module id = 25\n// module chunks = 0","module.exports = require(\"babel-polyfill/lib/index\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"babel-polyfill/lib/index\"\n// module id = 27\n// module chunks = 0","const dotenv = require('dotenv');\n\ndotenv.config();\nglobal.__CLIENT__ = false;\nglobal.__SERVER__ = true;\n\nvar extendRequire = require(\"isomorphic-loader/lib/extend-require\");\n\nrequire('./jobs');\n\nextendRequire().then(function () {\n    require(\"./routes\");\n}).catch(function (err) {\n    console.log(err);\n});\n\n\n\n// WEBPACK FOOTER //\n// ./index.js","module.exports = require(\"isomorphic-loader/lib/extend-require\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"isomorphic-loader/lib/extend-require\"\n// module id = 29\n// module chunks = 0","import fs from 'fs';\nimport path from 'path';\nimport Agenda from 'Agenda';\nimport _ from 'lodash';\nimport OpenTok from 'opentok';\nimport moment from 'moment';\nimport mongoose from 'mongoose';\nimport JourneySpace from '../models/journey_space';\nimport JourneyRSVP from '../models/journey_rsvp';\nimport JourneyContent from '../models/journey_content';\n\nconst agenda = new Agenda({db: {address: process.env.MONGODB_URI || process.env.MONGO_URL}});\nconst opentok = new OpenTok(process.env.OPENTOK_KEY, process.env.OPENTOK_SECRET);\nconst db = mongoose.connection;\n\nagenda.define('create journey space', async function(job, done) {\n  try {\n    const randomJourney = (await db.collection('journeycontents').aggregate([{$sample: {size: 1}}]).toArray())[0];\n    const journeySpace = new JourneySpace({\n      journey: randomJourney.filePath,\n      name: randomJourney.name,\n      image: randomJourney.image,\n      room: `${randomJourney.name.toLowerCase().replace(/[^a-z]/ig, '-')}-${(new Date()).getTime()}`,\n      startAt: moment().add(10, 'minutes').toDate()\n    });\n    await journeySpace.save();\n    await agenda.schedule(journeySpace.startAt, 'start journey', {journey: journeySpace._id});\n    const globalSpace = await JourneySpace.findOne({room: 'temp-home-location'}).exec();\n    if (globalSpace) {\n      const response = journeySpace.toJSON();\n      response.rsvps = [];\n      opentok.signal(globalSpace.sessionId, null, { 'type': 'createdNewJourney', 'data': JSON.stringify(response) }, done);\n    } else {\n      done();\n    }\n  } catch(e) {\n    console.log(e);\n    done(e);\n  }\n});\n\nagenda.define('clear expired journeys', async function(job, done) {\n  try {\n    const expiredJourneys = await JourneySpace.find({state: 'created', startAt: {$lt: moment().subtract(1, 'minutes')}}).exec();\n    const globalSpace = await JourneySpace.findOne({room: 'temp-home-location'}).exec();\n    for (let journey of expiredJourneys) {\n      await journey.expire();\n      if (globalSpace) {\n        opentok.signal(globalSpace.sessionId, null, { 'type': 'expiredJourney', 'data': JSON.stringify(journey) }, () => {});\n      }\n    }\n    done();\n  } catch(e) {\n    console.log(e);\n    done(e);\n  }\n});\n\nagenda.define('start journey', async function(job, done) {\n  try {\n    const {journey} = job.attrs.data;\n    const journeySpace = await JourneySpace.findById(journey).exec();\n    const globalSpace = await JourneySpace.findOne({room: 'temp-home-location'}).exec();\n    const rsvps = await JourneyRSVP.find({journey: journeySpace._id}).exec();\n    if (rsvps.length > 1) {\n      await journeySpace.start();\n      opentok.signal(journeySpace.sessionId, null, { 'type': 'startJourney', 'data': JSON.stringify({journey}) }, () => {});\n    } else {\n      await journeySpace.fail();\n      opentok.signal(journeySpace.sessionId, null, { 'type': 'failJourney', 'data': JSON.stringify({journey}) }, () => {});\n      opentok.signal(globalSpace.sessionId, null, { 'type': 'failJourney', 'data': JSON.stringify(journeySpace.toJSON()) }, () => {});\n    }\n    done();\n  } catch(e) {\n    done(e);\n  }\n});\n\n\nagenda.on('ready', function() {\n  agenda.every('1 minute', 'create journey space');\n  agenda.every('1 minute', 'clear expired journeys');\n\n  agenda.start();\n});\n\n\n\n\n// WEBPACK FOOTER //\n// ./jobs/index.js","const Agenda = require('./lib/agenda');\n\nmodule.exports = Agenda;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/index.js\n// module id = 31\n// module chunks = 0","'use strict';\n/**\n * General Notes:\n * - Refactor remaining deprecated MongoDB Native Driver methods: findAndModify()\n */\n\nconst Emitter = require('events').EventEmitter;\nconst humanInterval = require('human-interval');\n\nclass Agenda extends Emitter {\n  constructor(config, cb) {\n    super();\n\n    if (!(this instanceof Agenda)) {\n      return new Agenda(config);\n    }\n\n    config = config || {};\n\n    this._name = config.name;\n    this._processEvery = humanInterval(config.processEvery) || humanInterval('5 seconds');\n    this._defaultConcurrency = config.defaultConcurrency || 5;\n    this._maxConcurrency = config.maxConcurrency || 20;\n    this._defaultLockLimit = config.defaultLockLimit || 0;\n    this._lockLimit = config.lockLimit || 0;\n    this._definitions = {};\n    this._runningJobs = [];\n    this._lockedJobs = [];\n    this._jobQueue = [];\n    this._defaultLockLifetime = config.defaultLockLifetime || 10 * 60 * 1000; // 10 minute default lockLifetime\n    this._sort = config.sort || {nextRunAt: 1, priority: -1};\n    this._indices = Object.assign({name: 1}, this._sort, {priority: -1, lockedAt: 1, nextRunAt: 1, disabled: 1});\n\n    this._isLockingOnTheFly = false;\n    this._jobsToLock = [];\n    if (config.mongo) {\n      this.mongo(config.mongo, config.db ? config.db.collection : undefined, cb);\n    } else if (config.db) {\n      this.database(config.db.address, config.db.collection, config.db.options, cb);\n    }\n  }\n}\n\nAgenda.prototype.mongo = require('./mongo');\nAgenda.prototype.database = require('./database');\nAgenda.prototype.db_init = require('./db-init'); // eslint-disable-line camelcase\nAgenda.prototype.name = require('./name');\nAgenda.prototype.processEvery = require('./process-every');\nAgenda.prototype.maxConcurrency = require('./max-concurrency');\nAgenda.prototype.defaultConcurrency = require('./default-concurrency');\nAgenda.prototype.lockLimit = require('./locklimit');\nAgenda.prototype.defaultLockLimit = require('./default-lock-limit');\nAgenda.prototype.defaultLockLifetime = require('./default-lock-lifetime');\nAgenda.prototype.sort = require('./sort');\nAgenda.prototype.create = require('./create');\nAgenda.prototype.jobs = require('./jobs');\nAgenda.prototype.purge = require('./purge');\nAgenda.prototype.define = require('./define');\nAgenda.prototype.every = require('./every');\nAgenda.prototype.schedule = require('./schedule');\nAgenda.prototype.now = require('./now');\nAgenda.prototype.cancel = require('./cancel');\nAgenda.prototype.saveJob = require('./save-job');\nAgenda.prototype.start = require('./start');\nAgenda.prototype.stop = require('./stop');\nAgenda.prototype._findAndLockNextJob = require('./find-and-lock-next-job');\n\nmodule.exports = Agenda;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/lib/agenda/index.js\n// module id = 32\n// module chunks = 0","'use strict';\n\n/**\n * Build method used to add MongoDB connection details\n * @param {MongoClient} mdb instance of MongoClient to use\n * @param {String} collection name collection we want to use ('agendaJobs')\n * @param {Function} cb called when MongoDB connection fails or passes\n * @returns {exports} instance of Agenda\n */\nmodule.exports = function(mdb, collection, cb) {\n  this._mdb = mdb;\n  this.db_init(collection, cb);\n  return this;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/lib/agenda/mongo.js\n// module id = 33\n// module chunks = 0","'use strict';\nconst MongoClient = require('mongodb').MongoClient;\nconst debug = require('debug')('agenda:database');\n\n/**\n * Connect to the spec'd MongoDB server and database.\n * @param {String} url MongoDB server URI\n * @param {String} collection name of collection to use\n * @param {Object} options options for connecting\n * @param {Function} cb callback of MongoDB connection\n * @returns {exports}\n * NOTE:\n * If `url` includes auth details then `options` must specify: { 'uri_decode_auth': true }. This does Auth on\n * the specified database, not the Admin database. If you are using Auth on the Admin DB and not on the Agenda DB,\n * then you need to authenticate against the Admin DB and then pass the MongoDB instance into the constructor\n * or use Agenda.mongo(). If your app already has a MongoDB connection then use that. ie. specify config.mongo in\n * the constructor or use Agenda.mongo().\n */\nmodule.exports = function(url, collection, options, cb) {\n  const self = this;\n  if (!url.match(/^mongodb:\\/\\/.*/)) {\n    url = 'mongodb://' + url;\n  }\n\n  collection = collection || 'agendaJobs';\n  options = Object.assign({autoReconnect: true, reconnectTries: Number.MAX_SAFE_INTEGER, reconnectInterval: this._processEvery}, options);\n  MongoClient.connect(url, options, (error, db) => {\n    if (error) {\n      debug('error connecting to MongoDB using collection: [%s]', collection);\n      if (cb) {\n        cb(error, null);\n      } else {\n        throw error;\n      }\n      return;\n    }\n    debug('successful connection to MongoDB using collection: [%s]', collection);\n    self._mdb = db;\n    self.db_init(collection, cb);\n  });\n  return this;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/lib/agenda/database.js\n// module id = 34\n// module chunks = 0","module.exports = require(\"mongodb\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"mongodb\"\n// module id = 35\n// module chunks = 0","'use strict';\nconst debug = require('debug')('agenda:db_init');\n\n/**\n * Internal method called in the case where new indices have an error during creation\n * @param {Error} err error returned from index creation from before\n * @param {*} result result passed in from earlier attempt of creating index\n * @param {Agenda} self instance of Agenda\n * @param {Function} cb called when indices fail or pass\n * @returns {undefined}\n */\nconst handleLegacyCreateIndex = (err, result, self, cb) => {\n  if (err && err.message !== 'no such cmd: createIndex') {\n    debug('not attempting legacy index, emitting error');\n    self.emit('error', err);\n  } else {\n    // Looks like a mongo.version < 2.4.x\n    err = null;\n    self._collection.ensureIndex(self._indices, {\n      name: 'findAndLockNextJobIndex'\n    });\n    self.emit('ready');\n  }\n  if (cb) {\n    cb(err, self._collection);\n  }\n};\n\n/**\n * Setup and initialize the collection used to manage Jobs.\n * @param {String} collection name or undefined for default 'agendaJobs'\n * @param {Function} cb called when the db is initialized\n * @returns {undefined}\n */\nmodule.exports = function(collection, cb) {\n  const self = this;\n  debug('init database collection using name [%s]', collection);\n  this._collection = this._mdb.collection(collection || 'agendaJobs');\n  debug('attempting index creation');\n  this._collection.createIndex(this._indices, {\n    name: 'findAndLockNextJobIndex'\n  }, (err, result) => {\n    if (err) {\n      debug('index creation failed, attempting legacy index creation next');\n    } else {\n      debug('index creation success');\n    }\n    handleLegacyCreateIndex(err, result, self, cb);\n  });\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/lib/agenda/db-init.js\n// module id = 36\n// module chunks = 0","'use strict';\nconst debug = require('debug')('agenda:name');\n\n/**\n * Set name of queue\n * @param {String} name name of agenda instance\n * @returns {exports} agenda instance\n */\nmodule.exports = function(name) {\n  debug('Agenda.name(%s)', name);\n  this._name = name;\n  return this;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/lib/agenda/name.js\n// module id = 37\n// module chunks = 0","'use strict';\nconst humanInterval = require('human-interval');\nconst debug = require('debug')('agenda:processEvery');\n\n/**\n * Set the default process interval\n * @param {Number} time time to process\n * @returns {exports} agenda instance\n */\nmodule.exports = function(time) {\n  debug('Agenda.processEvery(%d)', time);\n  this._processEvery = humanInterval(time);\n  return this;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/lib/agenda/process-every.js\n// module id = 38\n// module chunks = 0","'use strict';\nconst debug = require('debug')('agenda:maxConcurrency');\n\n/**\n * Set the concurrency for jobs (globally), type does not matter\n * @param {Number} num max concurrency value\n * @returns {exports} agenda instance\n */\nmodule.exports = function(num) {\n  debug('Agenda.maxConcurrency(%d)', num);\n  this._maxConcurrency = num;\n  return this;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/lib/agenda/max-concurrency.js\n// module id = 39\n// module chunks = 0","'use strict';\nconst debug = require('debug')('agenda:defaultConcurrency');\n\n/**\n * Set the default concurrency for each job\n * @param {Number} num default concurrency\n * @returns {exports} agenda instance\n */\nmodule.exports = function(num) {\n  debug('Agenda.defaultConcurrency(%d)', num);\n  this._defaultConcurrency = num;\n  return this;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/lib/agenda/default-concurrency.js\n// module id = 40\n// module chunks = 0","'use strict';\nconst debug = require('debug')('agenda:locklimit');\n\n/**\n * Set the default amount jobs that are allowed to be locked at one time (GLOBAL)\n * NOTE: Is this different than max concurrency?\n * @param {Number} num Lock limit\n * @returns {exports} agenda instance\n */\nmodule.exports = function(num) {\n  debug('Agenda.lockLimit(%d)', num);\n  this._lockLimit = num;\n  return this;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/lib/agenda/locklimit.js\n// module id = 41\n// module chunks = 0","'use strict';\nconst debug = require('debug')('agenda:defaultLockLimit');\n\n/**\n * Set default lock limit per job type\n * @param {Number} num Lock limit per job\n * @returns {exports} agenda instance\n */\nmodule.exports = function(num) {\n  debug('Agenda.defaultLockLimit(%d)', num);\n  this._defaultLockLimit = num;\n  return this;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/lib/agenda/default-lock-limit.js\n// module id = 42\n// module chunks = 0","'use strict';\nconst debug = require('debug')('agenda:defaultLockLifetime');\n\n/**\n * Set the default lock time (in ms)\n * Default is 10 * 60 * 1000 ms (10 minutes)\n * @param {Number} ms time in ms to set default lock\n * @returns {exports} agenda instance\n */\nmodule.exports = function(ms) {\n  debug('Agenda.defaultLockLifetime(%d)', ms);\n  this._defaultLockLifetime = ms;\n  return this;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/lib/agenda/default-lock-lifetime.js\n// module id = 43\n// module chunks = 0","'use strict';\nconst debug = require('debug')('agenda:sort');\n\n/**\n * Set the sort query for finding next job\n * Default is { nextRunAt: 1, priority: -1 }\n * @param {Object} query sort query object for MongoDB\n * @returns {exports} agenda instance\n */\nmodule.exports = function(query) {\n  debug('Agenda.sort([Object])');\n  this._sort = query;\n  return this;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/lib/agenda/sort.js\n// module id = 44\n// module chunks = 0","'use strict';\nconst debug = require('debug')('agenda:create');\nconst Job = require('../job');\n\n/**\n * Given a name and some data, create a new job\n * @param {String} name name of job\n * @param {Object} data data to set for job\n * @access protected\n * @returns {module.Job} instance of new job\n */\nmodule.exports = function(name, data) {\n  debug('Agenda.create(%s, [Object])', name);\n  const priority = this._definitions[name] ? this._definitions[name].priority : 0;\n  const job = new Job({name, data, type: 'normal', priority, agenda: this});\n  return job;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/lib/agenda/create.js\n// module id = 45\n// module chunks = 0","'use strict';\n\n/**\n * Given a job, turn it into an object we can store in Mongo\n * @returns {Object} json object from Job\n */\nmodule.exports = function() {\n  const self = this;\n  const attrs = self.attrs || {};\n  const result = {};\n\n  for (const prop in attrs) {\n    if ({}.hasOwnProperty.call(attrs, prop)) {\n      result[prop] = attrs[prop];\n    }\n  }\n\n  const dates = ['lastRunAt', 'lastFinishedAt', 'nextRunAt', 'failedAt', 'lockedAt'];\n  dates.forEach(d => {\n    if (result[d]) {\n      result[d] = new Date(result[d]);\n    }\n  });\n\n  return result;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/lib/job/to-json.js\n// module id = 46\n// module chunks = 0","'use strict';\nconst humanInterval = require('human-interval');\nconst CronTime = require('cron').CronTime;\nconst moment = require('moment-timezone');\nconst date = require('date.js');\nconst debug = require('debug')('agenda:job');\n\n/**\n * Internal method used to compute next time a job should run and sets the proper values\n * @returns {exports} instance of Job instance\n */\nmodule.exports = function() {\n  const interval = this.attrs.repeatInterval;\n  const timezone = this.attrs.repeatTimezone;\n  const repeatAt = this.attrs.repeatAt;\n  this.attrs.nextRunAt = undefined;\n\n  const dateForTimezone = date => {\n    date = moment(date);\n    if (timezone !== null) {\n      date.tz(timezone);\n    }\n    return date;\n  };\n\n  /**\n   * Internal method that computes the interval\n   * @returns {undefined}\n   */\n  const computeFromInterval = () => {\n    debug('[%s:%s] computing next run via interval [%s]', this.attrs.name, this.attrs._id, interval);\n    let lastRun = this.attrs.lastRunAt || new Date();\n    lastRun = dateForTimezone(lastRun);\n    try {\n      const cronTime = new CronTime(interval);\n      let nextDate = cronTime._getNextDateFrom(lastRun);\n      if (nextDate.valueOf() === lastRun.valueOf()) {\n        // Handle cronTime giving back the same date for the next run time\n        nextDate = cronTime._getNextDateFrom(dateForTimezone(new Date(lastRun.valueOf() + 1000)));\n      }\n      this.attrs.nextRunAt = nextDate;\n      debug('[%s:%s] nextRunAt set to [%s]', this.attrs.name, this.attrs._id, this.attrs.nextRunAt.toISOString());\n    } catch (e) {\n      // Nope, humanInterval then!\n      try {\n        if (!this.attrs.lastRunAt && humanInterval(interval)) {\n          this.attrs.nextRunAt = lastRun.valueOf();\n          debug('[%s:%s] nextRunAt set to [%s]', this.attrs.name, this.attrs._id, this.attrs.nextRunAt.toISOString());\n        } else {\n          this.attrs.nextRunAt = lastRun.valueOf() + humanInterval(interval);\n          debug('[%s:%s] nextRunAt set to [%s]', this.attrs.name, this.attrs._id, this.attrs.nextRunAt.toISOString());\n        }\n      } catch (e) {}\n    } finally {\n      if (isNaN(this.attrs.nextRunAt)) {\n        this.attrs.nextRunAt = undefined;\n        debug('[%s:%s] failed to calculate nextRunAt due to invalid repeat interval', this.attrs.name, this.attrs._id);\n        this.fail('failed to calculate nextRunAt due to invalid repeat interval');\n      }\n    }\n  };\n\n  /**\n   * Internal method to compute next run time from the repeat string\n   * @returns {undefined}\n   */\n  function computeFromRepeatAt() {\n    const lastRun = this.attrs.lastRunAt || new Date();\n    const nextDate = date(repeatAt).valueOf();\n\n    // If you do not specify offset date for below test it will fail for ms\n    const offset = Date.now();\n    if (offset === date(repeatAt, offset).valueOf()) {\n      this.attrs.nextRunAt = undefined;\n      debug('[%s:%s] failed to calculate repeatAt due to invalid format', this.attrs.name, this.attrs._id);\n      this.fail('failed to calculate repeatAt time due to invalid format');\n    } else if (nextDate.valueOf() === lastRun.valueOf()) {\n      this.attrs.nextRunAt = date('tomorrow at ', repeatAt);\n      debug('[%s:%s] nextRunAt set to [%s]', this.attrs.name, this.attrs._id, this.attrs.nextRunAt.toISOString());\n    } else {\n      this.attrs.nextRunAt = date(repeatAt);\n      debug('[%s:%s] nextRunAt set to [%s]', this.attrs.name, this.attrs._id, this.attrs.nextRunAt.toISOString());\n    }\n  }\n\n  if (interval) {\n    computeFromInterval.call(this);\n  } else if (repeatAt) {\n    computeFromRepeatAt.call(this);\n  }\n  return this;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/lib/job/compute-next-run-at.js\n// module id = 47\n// module chunks = 0","module.exports = require(\"cron\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"cron\"\n// module id = 48\n// module chunks = 0","module.exports = require(\"moment-timezone\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"moment-timezone\"\n// module id = 49\n// module chunks = 0","'use strict';\n\n/**\n * Sets a job to repeat every X amount of time\n * @param {String} interval repeat every X\n * @param {Object} options options to use for job\n * @returns {exports} instance of Job\n */\nmodule.exports = function(interval, options) {\n  options = options || {};\n  this.attrs.repeatInterval = interval;\n  this.attrs.repeatTimezone = options.timezone ? options.timezone : null;\n  return this;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/lib/job/repeat-every.js\n// module id = 50\n// module chunks = 0","'use strict';\n\n/**\n * Sets a job to repeat at a specific time\n * @param {String} time time to repeat job at (human readable or number)\n * @returns {exports} instance of Job\n */\nmodule.exports = function(time) {\n  this.attrs.repeatAt = time;\n  return this;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/lib/job/repeat-at.js\n// module id = 51\n// module chunks = 0","'use strict';\n\n/**\n * Prevents the job type from running\n * @returns {exports} instance of Job\n */\nmodule.exports = function() {\n  this.attrs.disabled = true;\n  return this;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/lib/job/disable.js\n// module id = 52\n// module chunks = 0","'use strict';\n\n/**\n * Allows job type to run\n * @returns {exports} instance of Job\n */\nmodule.exports = function() {\n  this.attrs.disabled = false;\n  return this;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/lib/job/enable.js\n// module id = 53\n// module chunks = 0","'use strict';\n\n/**\n * Data to ensure is unique for job to be created\n * @param {Object} unique mongo data query for unique\n * @param {Object} opts unique options\n * @returns {exports} instance of Job\n */\nmodule.exports = function(unique, opts) {\n  this.attrs.unique = unique;\n  this.attrs.uniqueOpts = opts;\n  return this;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/lib/job/unique.js\n// module id = 54\n// module chunks = 0","'use strict';\nconst date = require('date.js');\n\n/**\n * Schedules a job to run at specified time\n * @param {String} time schedule a job to run \"then\"\n * @returns {exports} instance of Job\n */\nmodule.exports = function(time) {\n  this.attrs.nextRunAt = (time instanceof Date) ? time : date(time);\n  return this;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/lib/job/schedule.js\n// module id = 55\n// module chunks = 0","'use strict';\n\n/**\n * Internal method to turn priority into a number\n * @param {String|Number} priority string to parse into number\n * @returns {Number} priority that was parsed\n */\nconst parsePriority = priority => {\n  const priorityMap = {\n    lowest: -20,\n    low: -10,\n    normal: 0,\n    high: 10,\n    highest: 20\n  };\n  if (typeof priority === 'number' || priority instanceof Number) {\n    return priority;\n  }\n  return priorityMap[priority];\n};\n\n/**\n * Sets priority of the job\n * @param {String} priority priority of when job should be queued\n * @returns {exports} instance of Job\n */\nmodule.exports = function(priority) {\n  this.attrs.priority = parsePriority(priority);\n  return this;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/lib/job/priority.js\n// module id = 56\n// module chunks = 0","'use strict';\nconst debug = require('debug')('agenda:job');\n\n/**\n * Fails the job with a reason (error) specified\n * @param {Error|String} reason reason job failed\n * @returns {exports} instance of Job\n */\nmodule.exports = function(reason) {\n  if (reason instanceof Error) {\n    reason = reason.message;\n  }\n  this.attrs.failReason = reason;\n  this.attrs.failCount = (this.attrs.failCount || 0) + 1;\n  const now = new Date();\n  this.attrs.failedAt = now;\n  this.attrs.lastFinishedAt = now;\n  debug('[%s:%s] fail() called [%d] times so far', this.attrs.name, this.attrs._id, this.attrs.failCount);\n  return this;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/lib/job/fail.js\n// module id = 57\n// module chunks = 0","'use strict';\nconst debug = require('debug')('agenda:job');\n\n/**\n * Internal method (RUN)\n * @param {Function} cb called when job persistence in MongoDB fails or passes\n * @returns {undefined}\n */\nmodule.exports = function(cb) {\n  const self = this;\n  const agenda = self.agenda;\n  const definition = agenda._definitions[self.attrs.name];\n\n  setImmediate(() => {\n    self.attrs.lastRunAt = new Date();\n    debug('[%s:%s] setting lastRunAt to: %s', self.attrs.name, self.attrs._id, self.attrs.lastRunAt.toISOString());\n    self.computeNextRunAt();\n    self.save(() => {\n      const jobCallback = function(err) {\n        if (err) {\n          self.fail(err);\n        }\n\n        if (!err) {\n          self.attrs.lastFinishedAt = new Date();\n        }\n        self.attrs.lockedAt = null;\n        debug('[%s:%s] job finished at [%s] and was unlocked', self.attrs.name, self.attrs._id, self.attrs.lastFinishedAt);\n\n        self.save((saveErr, job) => {\n          cb && cb(err || saveErr, job);  // eslint-disable-line no-unused-expressions\n          if (err) {\n            agenda.emit('fail', err, self);\n            agenda.emit('fail:' + self.attrs.name, err, self);\n            debug('[%s:%s] failed to be saved to MongoDB', self.attrs.name, self.attrs._id);\n          } else {\n            agenda.emit('success', self);\n            agenda.emit('success:' + self.attrs.name, self);\n            debug('[%s:%s] was saved successfully to MongoDB', self.attrs.name, self.attrs._id);\n          }\n          agenda.emit('complete', self);\n          agenda.emit('complete:' + self.attrs.name, self);\n          debug('[%s:%s] job has finished', self.attrs.name, self.attrs._id);\n        });\n      };\n\n      try {\n        agenda.emit('start', self);\n        agenda.emit('start:' + self.attrs.name, self);\n        debug('[%s:%s] starting job', self.attrs.name, self.attrs._id);\n        if (!definition) {\n          debug('[%s:%s] has no definition, can not run', self.attrs.name, self.attrs._id);\n          throw new Error('Undefined job');\n        }\n        if (definition.fn.length === 2) {\n          debug('[%s:%s] process function being called', self.attrs.name, self.attrs._id);\n          definition.fn(self, jobCallback);\n        } else {\n          debug('[%s:%s] process function being called', self.attrs.name, self.attrs._id);\n          definition.fn(self);\n          jobCallback();\n        }\n      } catch (err) {\n        debug('[%s:%s] unknown error occurred', self.attrs.name, self.attrs._id);\n        jobCallback(err);\n      }\n    });\n  });\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/lib/job/run.js\n// module id = 58\n// module chunks = 0","'use strict';\n\n/**\n * A job is running if:\n * (lastRunAt exists AND lastFinishedAt does not exist)\n * OR\n * (lastRunAt exists AND lastFinishedAt exists but the lastRunAt is newer [in time] than lastFinishedAt)\n * @returns {boolean} whether or not job is running at the moment (true for running)\n */\nmodule.exports = function() {\n  if (!this.attrs.lastRunAt) {\n    return false;\n  }\n  if (!this.attrs.lastFinishedAt) {\n    return true;\n  }\n  if (this.attrs.lockedAt && this.attrs.lastRunAt.getTime() > this.attrs.lastFinishedAt.getTime()) {\n    return true;\n  }\n  return false;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/lib/job/is-running.js\n// module id = 59\n// module chunks = 0","'use strict';\n\n/**\n * Saves a job into the MongoDB\n * @param {Function} cb called after job is saved or errors\n * @returns {exports} instance of Job\n */\nmodule.exports = function(cb) {\n  this.agenda.saveJob(this, cb);\n  return this;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/lib/job/save.js\n// module id = 60\n// module chunks = 0","'use strict';\n\n/**\n * Remove the job from MongoDB\n * @param {Function} cb called when job removal fails or passes\n * @returns {undefined}\n */\nmodule.exports = function(cb) {\n  this.agenda.cancel({_id: this.attrs._id}, cb);\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/lib/job/remove.js\n// module id = 61\n// module chunks = 0","'use strict';\n\n/**\n * Updates \"lockedAt\" time so the job does not get picked up again\n * @param {Function} cb called when job \"touch\" fails or passes\n * @returns {undefined}\n */\nmodule.exports = function(cb) {\n  this.attrs.lockedAt = new Date();\n  this.save(cb);\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/lib/job/touch.js\n// module id = 62\n// module chunks = 0","'use strict';\nconst utils = require('../utils');\n\nconst createJob = utils.createJob;\n\n/**\n * Finds all jobs matching 'query'\n * @param {Object} query object for MongoDB\n * @param {Function} cb called when fails or passes\n * @returns {undefined}\n */\nmodule.exports = function(query, cb) {\n  const self = this;\n  this._collection.find(query).toArray((error, result) => {\n    let jobs;\n    if (!error) {\n      jobs = result.map(createJob.bind(null, self));\n    }\n    cb(error, jobs);\n  });\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/lib/agenda/jobs.js\n// module id = 63\n// module chunks = 0","'use strict';\n// @TODO: What should we use for internal util functions?\n//        Maybe we should use agenda:util:processJobs which would move agenda:* to agenda:agenda;*\nconst debug = require('debug')('agenda:internal:processJobs');\nconst createJob = require('./create-job');\n\n/**\n * Process methods for jobs\n * @param {module.Job} extraJob job to run immediately\n * @returns {undefined}\n */\nmodule.exports = function(extraJob) {\n  debug('starting to process jobs');\n  // Make sure an interval has actually been set\n  // Prevents race condition with 'Agenda.stop' and already scheduled run\n  if (!this._processInterval) {\n    debug('no _processInterval set when calling processJobs, returning');\n    return;\n  }\n\n  const self = this;\n  const definitions = this._definitions;\n  const jobQueue = this._jobQueue;\n  let jobName;\n\n  // Determine whether or not we have a direct process call!\n  if (!extraJob) {\n    // Go through each jobName set in 'Agenda.process' and fill the queue with the next jobs\n    for (jobName in definitions) {\n      if ({}.hasOwnProperty.call(definitions, jobName)) {\n        debug('queuing up job to process: [%s]', jobName);\n        jobQueueFilling(jobName);\n      }\n    }\n  } else if (definitions[extraJob.attrs.name]) {\n    // Add the job to list of jobs to lock and then lock it immediately!\n    debug('job [%s] was passed directly to processJobs(), locking and running immediately', extraJob.attrs.name);\n    self._jobsToLock.push(extraJob);\n    lockOnTheFly();\n  }\n\n  /**\n   * Returns true if a job of the specified name can be locked.\n   * Considers maximum locked jobs at any time if self._lockLimit is > 0\n   * Considers maximum locked jobs of the specified name at any time if jobDefinition.lockLimit is > 0\n   * @param {String} name name of job to check if we should lock or not\n   * @returns {boolean} whether or not you should lock job\n   */\n  function shouldLock(name) {\n    const jobDefinition = definitions[name];\n    let shouldLock = true;\n    if (self._lockLimit && self._lockLimit <= self._lockedJobs.length) {\n      shouldLock = false;\n    }\n    if (jobDefinition.lockLimit && jobDefinition.lockLimit <= jobDefinition.locked) {\n      shouldLock = false;\n    }\n    debug('job [%s] lock status: shouldLock = %s', name, shouldLock);\n    return shouldLock;\n  }\n\n  /**\n   * Internal method that adds jobs to be processed to the local queue\n   * @param {*} jobs Jobs to queue\n   * @param {boolean} inFront puts the job in front of queue if true\n   * @returns {undefined}\n   */\n  function enqueueJobs(jobs, inFront) {\n    if (!Array.isArray(jobs)) {\n      jobs = [jobs];\n    }\n\n    jobs.forEach(job => {\n      let jobIndex;\n      let start;\n      let loopCondition;\n      let endCondition;\n      let inc;\n\n      if (inFront) {\n        start = jobQueue.length ? jobQueue.length - 1 : 0;\n        inc = -1;\n        loopCondition = function() {\n          return jobIndex >= 0;\n        };\n        endCondition = function(queuedJob) {\n          return !queuedJob || queuedJob.attrs.priority < job.attrs.priority;\n        };\n      } else {\n        start = 0;\n        inc = 1;\n        loopCondition = function() {\n          return jobIndex < jobQueue.length;\n        };\n        endCondition = function(queuedJob) {\n          return queuedJob.attrs.priority >= job.attrs.priority;\n        };\n      }\n\n      for (jobIndex = start; loopCondition(); jobIndex += inc) {\n        if (endCondition(jobQueue[jobIndex])) {\n          break;\n        }\n      }\n\n      // Insert the job to the queue at its prioritized position for processing\n      jobQueue.splice(jobIndex, 0, job);\n    });\n  }\n\n  /**\n   * Internal method that will lock a job and store it on MongoDB\n   * This method is called when we immediately start to process a job without using the process interval\n   * We do this because sometimes jobs are scheduled but will be run before the next process time\n   * @returns {undefined}\n   */\n  function lockOnTheFly() {\n    // Already running this? Return\n    if (self._isLockingOnTheFly) {\n      debug('lockOnTheFly() already running, returning');\n      return;\n    }\n\n    // Don't have any jobs to run? Return\n    if (self._jobsToLock.length === 0) {\n      debug('no jobs to current lock on the fly, returning');\n      self._isLockingOnTheFly = false;\n      return;\n    }\n\n    // Set that we are running this\n    self._isLockingOnTheFly = true;\n\n    // Grab a job that needs to be locked\n    const now = new Date();\n    const job = self._jobsToLock.pop();\n\n    // If locking limits have been hit, stop locking on the fly.\n    // Jobs that were waiting to be locked will be picked up during a\n    // future locking interval.\n    if (!shouldLock(job.attrs.name)) {\n      debug('lock limit hit for: [%s]', job.attrs.name);\n      self._jobsToLock = [];\n      self._isLockingOnTheFly = false;\n      return;\n    }\n\n    // Query to run against collection to see if we need to lock it\n    const criteria = {\n      _id: job.attrs._id,\n      lockedAt: null,\n      nextRunAt: job.attrs.nextRunAt,\n      disabled: {$ne: true}\n    };\n\n    // Update / options for the MongoDB query\n    const update = {$set: {lockedAt: now}};\n    const options = {returnOriginal: false};\n\n    // Lock the job in MongoDB!\n    self._collection.findOneAndUpdate(criteria, update, options, (err, resp) => {\n      if (err) {\n        throw err;\n      }\n      // Did the \"job\" get locked? Create a job object and run\n      if (resp.value) {\n        const job = createJob(self, resp.value);\n        debug('found job [%s] that can be locked on the fly', job.attrs.name);\n        self._lockedJobs.push(job);\n        definitions[job.attrs.name].locked++;\n        enqueueJobs(job);\n        jobProcessing();\n      }\n\n      // Mark lock on fly is done for now\n      self._isLockingOnTheFly = false;\n\n      // Re-run in case anything is in the queue\n      lockOnTheFly();\n    });\n  }\n\n  /**\n   * Internal method used to fill a queue with jobs that can be run\n   * @param {String} name fill a queue with specific job name\n   * @returns {undefined}\n   */\n  function jobQueueFilling(name) {\n    // Don't lock because of a limit we have set (lockLimit, etc)\n    if (!shouldLock(name)) {\n      debug('lock limit reached in queue filling for [%s]', name);\n      return;\n    }\n\n    // Set the date of the next time we are going to run _processEvery function\n    const now = new Date();\n    self._nextScanAt = new Date(now.valueOf() + self._processEvery);\n\n    // For this job name, find the next job to run and lock it!\n    self._findAndLockNextJob(name, definitions[name], (err, job) => {\n      if (err) {\n        debug('[%s] job lock failed while filling queue', name);\n        throw err;\n      }\n\n      // Still have the job?\n      // 1. Add it to lock list\n      // 2. Add count of locked jobs\n      // 3. Queue the job to actually be run now that it is locked\n      // 4. Recursively run this same method we are in to check for more available jobs of same type!\n      if (job) {\n        debug('[%s:%s] job locked while filling queue', name, job.attrs._id);\n        self._lockedJobs.push(job);\n        definitions[job.attrs.name].locked++;\n        enqueueJobs(job);\n        jobQueueFilling(name);\n        jobProcessing();\n      }\n    });\n  }\n\n  /**\n   * Internal method that processes any jobs in the local queue (array)\n   * @returns {undefined}\n   */\n  function jobProcessing() {\n    // Ensure we have jobs\n    if (jobQueue.length === 0) {\n      return;\n    }\n\n    // Store for all sorts of things\n    const now = new Date();\n\n    // Get the next job that is not blocked by concurrency\n    let next;\n    for (next = jobQueue.length - 1; next > 0; next -= 1) {\n      const def = definitions[jobQueue[next].attrs.name];\n      if (def.concurrency > def.running) {\n        break;\n      }\n    }\n\n    // We now have the job we are going to process and its definition\n    const job = jobQueue.splice(next, 1)[0];\n    const jobDefinition = definitions[job.attrs.name];\n\n    debug('[%s:%s] about to process job', job.attrs.name, job.attrs._id);\n\n    // If the 'nextRunAt' time is older than the current time, run the job\n    // Otherwise, setTimeout that gets called at the time of 'nextRunAt'\n    if (job.attrs.nextRunAt < now) {\n      debug('[%s:%s] nextRunAt is in the past, run the job immediately', job.attrs.name, job.attrs._id);\n      runOrRetry();\n    } else {\n      const runIn = job.attrs.nextRunAt - now;\n      debug('[%s:%s] nextRunAt is in the future, calling setTimeout(%d)', job.attrs.name, job.attrs._id, runIn);\n      setTimeout(runOrRetry, runIn);\n    }\n\n    /**\n     * Internal method that tries to run a job and if it fails, retries again!\n     * @returns {undefined}\n     */\n    function runOrRetry() {\n      if (self._processInterval) {\n        if (jobDefinition.concurrency > jobDefinition.running && self._runningJobs.length < self._maxConcurrency) {\n          // Get the deadline of when the job is not supposed to go past for locking\n          const lockDeadline = new Date(Date.now() - jobDefinition.lockLifetime);\n\n          // This means a job has \"expired\", as in it has not been \"touched\" within the lockoutTime\n          // Remove from local lock\n          // NOTE: Shouldn't we update the 'lockedAt' value in MongoDB so it can be picked up on restart?\n          if (job.attrs.lockedAt < lockDeadline) {\n            debug('[%s:%s] job lock has expired, freeing it up', job.attrs.name, job.attrs._id);\n            self._lockedJobs.splice(self._lockedJobs.indexOf(job), 1);\n            jobDefinition.locked--;\n            jobProcessing();\n            return;\n          }\n\n          // Add to local \"running\" queue\n          self._runningJobs.push(job);\n          jobDefinition.running++;\n\n          // CALL THE ACTUAL METHOD TO PROCESS THE JOB!!!\n          debug('[%s:%s] processing job', job.attrs.name, job.attrs._id);\n          job.run(processJobResult);\n\n          // Re-run the loop to check for more jobs to process (locally)\n          jobProcessing();\n        } else {\n          // Run the job immediately by putting it on the top of the queue\n          debug('[%s:%s] concurrency preventing immediate run, pushing job to top of queue', job.attrs.name, job.attrs._id);\n          enqueueJobs(job, true);\n        }\n      }\n    }\n  }\n\n  /**\n   * Internal method used to run the job definition\n   * @param {Error} err thrown if can't process job\n   * @param {module.Job} job job to process\n   * @returns {undefined}\n   */\n  function processJobResult(err, job) {\n    if (err && !job) {\n      throw (err);\n    }\n    const name = job.attrs.name;\n\n    // Job isn't in running jobs so throw an error\n    if (self._runningJobs.indexOf(job) === -1) {\n      debug('[%s] callback was called, job must have been marked as complete already', job.attrs._id);\n      throw new Error('callback already called - job ' + name + ' already marked complete');\n    }\n\n    // Remove the job from the running queue\n    self._runningJobs.splice(self._runningJobs.indexOf(job), 1);\n    if (definitions[name].running > 0) {\n      definitions[name].running--;\n    }\n\n    // Remove the job from the locked queue\n    self._lockedJobs.splice(self._lockedJobs.indexOf(job), 1);\n    if (definitions[name].locked > 0) {\n      definitions[name].locked--;\n    }\n\n    // Re-process jobs now that one has finished\n    jobProcessing();\n  }\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/lib/utils/process-jobs.js\n// module id = 64\n// module chunks = 0","'use strict';\nconst debug = require('debug')('agenda:purge');\n\n/**\n * Removes all jobs from queue\n * NOTE: Only use after defining your jobs\n * @param {Function} cb called when fails or passes\n * @returns {undefined}\n */\nmodule.exports = function(cb) {\n  const definedNames = Object.keys(this._definitions);\n  debug('Agenda.purge(%o)');\n  this.cancel({name: {$not: {$in: definedNames}}}, cb);\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/lib/agenda/purge.js\n// module id = 65\n// module chunks = 0","'use strict';\nconst debug = require('debug')('agenda:define');\n\n/**\n * Setup definition for job\n * Method is used by consumers of lib to setup their functions\n * @param {String} name name of job\n * @param {Object} options options for job to run\n * @param {Function} processor function to be called to run actual job\n * @returns {undefined}\n */\nmodule.exports = function(name, options, processor) {\n  if (!processor) {\n    processor = options;\n    options = {};\n  }\n  this._definitions[name] = {\n    fn: processor,\n    concurrency: options.concurrency || this._defaultConcurrency,\n    lockLimit: options.lockLimit || this._defaultLockLimit,\n    priority: options.priority || 0,\n    lockLifetime: options.lockLifetime || this._defaultLockLifetime,\n    running: 0,\n    locked: 0\n  };\n  debug('job [%s] defined with following options: \\n%O', name, this._definitions[name]);\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/lib/agenda/define.js\n// module id = 66\n// module chunks = 0","'use strict';\nconst debug = require('debug')('agenda:every');\n\n/**\n * Creates a scheduled job with given interval and name/names of the job to run\n * @param {Number} interval run every X interval\n * @param {*} names String or strings of jobs to schedule\n * @param {Object} data data to run for job\n * @param {Object} options options to run job for\n * @param {Function} cb called when schedule fails or passes\n * @returns {*} Job or jobs created\n */\nmodule.exports = function(interval, names, data, options, cb) {\n  const self = this;\n\n  if (cb === undefined && typeof data === 'function') {\n    cb = data;\n    data = undefined;\n  } else if (cb === undefined && typeof options === 'function') {\n    cb = options;\n    options = undefined;\n  }\n\n  /**\n   * Internal method to setup job that gets run every interval\n   * @param {Number} interval run every X interval\n   * @param {*} name String job to schedule\n   * @param {Object} data data to run for job\n   * @param {Object} options options to run job for\n   * @param {Function} cb called when schedule fails or passes\n   * @returns {module.Job} instance of job\n   */\n  const createJob = (interval, name, data, options, cb) => {\n    const job = self.create(name, data);\n    job.attrs.type = 'single';\n    job.repeatEvery(interval, options);\n    job.computeNextRunAt();\n    job.save(cb);\n    return job;\n  };\n\n  /**\n   * Internal helper method that uses createJob to create jobs for an array of names\n   * @param {Number} interval run every X interval\n   * @param {*} names Strings of jobs to schedule\n   * @param {Object} data data to run for job\n   * @param {Object} options options to run job for\n   * @param {Function} cb called when schedule fails or passes\n   * @returns {*} array of jobs created\n   */\n  const createJobs = (interval, names, data, options, cb) => {\n    const results = [];\n    let pending = names.length;\n    let errored = false;\n    return names.map((name, i) => {\n      return createJob(interval, name, data, options, (err, result) => {\n        if (err) {\n          if (!errored) {\n            cb(err);\n          }\n          errored = true;\n          return;\n        }\n        results[i] = result;\n        if (--pending === 0 && cb) {\n          debug('every() -> all jobs created successfully');\n          cb(null, results);\n        } else {\n          debug('every() -> error creating one or more of the jobs');\n        }\n      });\n    });\n  };\n\n  if (typeof names === 'string' || names instanceof String) {\n    debug('Agenda.every(%s, %O, [Object], %O, cb)', interval, names, options);\n    return createJob(interval, names, data, options, cb);\n  } else if (Array.isArray(names)) {\n    debug('Agenda.every(%s, %s, [Object], %O, cb)', interval, names, options);\n    return createJobs(interval, names, data, options, cb);\n  }\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/lib/agenda/every.js\n// module id = 67\n// module chunks = 0","'use strict';\nconst debug = require('debug')('agenda:schedule');\n\n/**\n * Schedule a job or jobs at a specific time\n * @param {String} when when the job gets run\n * @param {*} names array of job names to run\n * @param {Object} data data to send to job\n * @param {Function} cb called when schedule fails or passes\n * @returns {*} job or jobs created\n */\nmodule.exports = function(when, names, data, cb) {\n  const self = this;\n\n  if (cb === undefined && typeof data === 'function') {\n    cb = data;\n    data = undefined;\n  }\n\n  /**\n   * Internal method that creates a job with given date\n   * @param {String} when when the job gets run\n   * @param {String} name of job to run\n   * @param {Object} data data to send to job\n   * @param {Function} cb called when job persistence in MongoDB fails or passes\n   * @returns {module.Job} instance of new job\n   */\n  const createJob = (when, name, data, cb) => {\n    const job = self.create(name, data);\n    job.schedule(when);\n    job.save(cb);\n    return job;\n  };\n\n  /**\n   * Internal helper method that calls createJob on a names array\n   * @param {String} when when the job gets run\n   * @param {*} names of jobs to run\n   * @param {Object} data data to send to job\n   * @param {Function} cb called when job(s) persistence in MongoDB fails or passes\n   * @returns {*} jobs that were created\n   */\n  const createJobs = (when, names, data, cb) => {\n    const results = [];\n    let pending = names.length;\n    let errored = false;\n    return names.map((name, i) => {\n      return createJob(when, name, data, (err, result) => {\n        if (err) {\n          if (!errored) {\n            cb(err);\n          }\n          errored = true;\n          return;\n        }\n        results[i] = result;\n        if (--pending === 0 && cb) {\n          debug('Agenda.schedule()::createJobs() -> all jobs created successfully');\n          cb(null, results);\n        } else {\n          debug('Agenda.schedule()::createJobs() -> error creating one or more of the jobs');\n        }\n      });\n    });\n  };\n\n  if (typeof names === 'string' || names instanceof String) {\n    debug('Agenda.schedule(%s, %O, [Object], cb)', when, names);\n    return createJob(when, names, data, cb);\n  } else if (Array.isArray(names)) {\n    debug('Agenda.schedule(%s, %O, [Object], cb)', when, names);\n    return createJobs(when, names, data, cb);\n  }\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/lib/agenda/schedule.js\n// module id = 68\n// module chunks = 0","'use strict';\nconst debug = require('debug')('agenda:now');\n\n/**\n * Create a job for this exact moment\n * @param {String} name name of job to schedule\n * @param {Object} data data to pass to job\n * @param {Function} cb called when job scheduling fails or passes\n * @returns {module.Job} new job instance created\n */\nmodule.exports = function(name, data, cb) {\n  if (!cb && typeof data === 'function') {\n    cb = data;\n    data = undefined;\n  }\n  debug('Agenda.now(%s, [Object])', name);\n  const job = this.create(name, data);\n  job.schedule(new Date());\n  job.save(cb);\n  return job;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/lib/agenda/now.js\n// module id = 69\n// module chunks = 0","'use strict';\nconst debug = require('debug')('agenda:cancel');\n\n/**\n * Cancels any jobs matching the passed MongoDB query, and removes them from the database.\n *  @param {Object} query MongoDB query to use when cancelling\n *  @param {Function} cb callback(error, numRemoved) when cancellation fails or passes\n *  @caller client code, Agenda.purge(), Job.remove()\n *  @returns {undefined}\n */\nmodule.exports = function(query, cb) {\n  debug('attempting to cancel all Agenda jobs', query);\n  this._collection.deleteMany(query, (error, result) => {\n    if (cb) {\n      if (error) {\n        debug('error trying to delete jobs from MongoDB');\n      } else {\n        debug('jobs cancelled');\n      }\n      cb(error, result && result.result ? result.result.n : undefined);\n    }\n  });\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/lib/agenda/cancel.js\n// module id = 70\n// module chunks = 0","'use strict';\nconst debug = require('debug')('agenda:saveJob');\nconst utils = require('../utils');\n\nconst processJobs = utils.processJobs;\n\n/**\n * Save the properties on a job to MongoDB\n * @param {module.Job} job job to save into MongoDB\n * @param {Function} cb called when job is saved or errors\n * @returns {undefined}\n */\nmodule.exports = function(job, cb) {\n  debug('attempting to save a job into Agenda instance');\n\n  // Grab information needed to save job but that we don't want to persist in MongoDB\n  const fn = cb;\n  const self = this;\n  const id = job.attrs._id;\n  const unique = job.attrs.unique;\n  const uniqueOpts = job.attrs.uniqueOpts;\n\n  // Store job as JSON and remove props we don't want to store from object\n  const props = job.toJSON();\n  delete props._id;\n  delete props.unique;\n  delete props.uniqueOpts;\n\n  // Store name of agenda queue as last modifier in job data\n  props.lastModifiedBy = this._name;\n  debug('set job props: \\n%O', props);\n\n  // Grab current time and set default query options for MongoDB\n  const now = new Date();\n  const protect = {};\n  let update = {$set: props};\n  debug('current time stored as %s', now.toISOString());\n\n  // If the job already had an ID, then update the properties of the job\n  // i.e, who last modified it, etc\n  if (id) {\n    // Update the job and process the resulting data'\n    debug('job already has _id, calling findOneAndUpdate() using _id as query');\n    this._collection.findOneAndUpdate({\n      _id: id\n    },\n    update, {\n      returnOriginal: false\n    },\n    processDbResult);\n  } else if (props.type === 'single') {\n    // Job type set to 'single' so...\n    // NOTE: Again, not sure about difference between 'single' here and 'once' in job.js\n    debug('job with type of \"single\" found');\n\n    // If the nextRunAt time is older than the current time, \"protect\" that property, meaning, don't change\n    // a scheduled job's next run time!\n    if (props.nextRunAt && props.nextRunAt <= now) {\n      debug('job has a scheduled nextRunAt time, protecting that field from upsert');\n      protect.nextRunAt = props.nextRunAt;\n      delete props.nextRunAt;\n    }\n\n    // If we have things to protect, set them in MongoDB using $setOnInsert\n    if (Object.keys(protect).length > 0) {\n      update.$setOnInsert = protect;\n    }\n\n    // Try an upsert\n    // NOTE: 'single' again, not exactly sure what it means\n    debug('calling findOneAndUpdate() with job name and type of \"single\" as query');\n    this._collection.findOneAndUpdate({\n      name: props.name,\n      type: 'single'\n    },\n    update, {\n      upsert: true,\n      returnOriginal: false\n    },\n    processDbResult);\n  } else if (unique) {\n    // If we want the job to be unique, then we can upsert based on the 'unique' query object that was passed in\n    const query = job.attrs.unique;\n    query.name = props.name;\n    if (uniqueOpts && uniqueOpts.insertOnly) {\n      update = {$setOnInsert: props};\n    }\n\n    // Use the 'unique' query object to find an existing job or create a new one\n    debug('calling findOneAndUpdate() with unique object as query: \\n%O', query);\n    this._collection.findOneAndUpdate(query, update, {upsert: true, returnOriginal: false}, processDbResult);\n  } else {\n    // If all else fails, the job does not exist yet so we just insert it into MongoDB\n    debug('using default behavior, inserting new job via insertOne() with props that were set: \\n%O', props);\n    this._collection.insertOne(props, processDbResult);\n  }\n\n  /**\n   * Given a result for findOneAndUpdate() or insert() above, determine whether to process\n   * the job immediately or to let the processJobs() interval pick it up later\n   * @param {Error} err error passed in via MongoDB call as to whether modify call failed or passed\n   * @param {*} result the data returned from the findOneAndUpdate() call or insertOne() call\n   * @access private\n   * @returns {undefined}\n   */\n  function processDbResult(err, result) {\n    // Check if there is an error and either cb(error) or throw if there is no callback\n    if (err) {\n      debug('processDbResult() received an error, job was not updated/created');\n      if (fn) {\n        return fn(err);\n      }\n      throw err;\n    } else if (result) {\n      debug('processDbResult() called with success, checking whether to process job immediately or not');\n\n      // We have a result from the above calls\n      // findAndModify() returns different results than insertOne() so check for that\n      let res = result.ops ? result.ops : result.value;\n      if (res) {\n        // If it is an array, grab the first job\n        if (Array.isArray(res)) {\n          res = res[0];\n        }\n\n        // Grab ID and nextRunAt from MongoDB and store it as an attribute on Job\n        job.attrs._id = res._id;\n        job.attrs.nextRunAt = res.nextRunAt;\n\n        // If the current job would have been processed in an older scan, process the job immediately\n        if (job.attrs.nextRunAt && job.attrs.nextRunAt < self._nextScanAt) {\n          debug('[%s:%s] job would have ran by nextScanAt, processing the job immediately', job.attrs.name, res._id);\n          processJobs.call(self, job);\n        }\n      }\n    }\n\n    // If we have a callback, return the Job instance\n    if (fn) {\n      fn(null, job);\n    }\n  }\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/lib/agenda/save-job.js\n// module id = 71\n// module chunks = 0","'use strict';\nconst debug = require('debug')('agenda:start');\nconst utils = require('../utils');\n\nconst processJobs = utils.processJobs;\n\n/**\n * Starts processing jobs using processJobs() methods, storing an interval ID\n * @returns {undefined}\n */\nmodule.exports = function() {\n  if (this._processInterval) {\n    debug('Agenda.start was already called, ignoring');\n  } else {\n    debug('Agenda.start called, creating interval to call processJobs every [%dms]', this._processEvery);\n    this._processInterval = setInterval(processJobs.bind(this), this._processEvery);\n    process.nextTick(processJobs.bind(this));\n  }\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/lib/agenda/start.js\n// module id = 72\n// module chunks = 0","'use strict';\nconst debug = require('debug')('agenda:stop');\n\n/**\n * Clear the interval that processes the jobs\n * @param {Function} cb called when job unlocking fails or passes\n * @returns {undefined}\n */\nmodule.exports = function(cb) {\n  const self = this;\n  /**\n   * Internal method to unlock jobs so that they can be re-run\n   * NOTE: May need to update what properties get set here, since job unlocking seems to fail\n   * @param {Function} done callback called when job unlocking fails or passes\n   * @access private\n   * @returns {undefined}\n   */\n  const _unlockJobs = function(done) {\n    debug('Agenda._unlockJobs()');\n    const jobIds = self._lockedJobs.map(job => job.attrs._id);\n\n    if (jobIds.length === 0) {\n      debug('no jobs to unlock');\n      return done();\n    }\n\n    debug('about to unlock jobs with ids: %O', jobIds);\n    self._collection.updateMany({_id: {$in: jobIds}}, {$set: {lockedAt: null}}, err => {\n      if (err) {\n        return done(err);\n      }\n\n      self._lockedJobs = [];\n      return done();\n    });\n  };\n\n  debug('Agenda.stop called, clearing interval for processJobs()');\n  cb = cb || function() {};\n  clearInterval(this._processInterval);\n  this._processInterval = undefined;\n  _unlockJobs(cb);\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/lib/agenda/stop.js\n// module id = 73\n// module chunks = 0","'use strict';\nconst debug = require('debug')('agenda:_findAndLockNextJob');\nconst utils = require('../utils');\n\nconst createJob = utils.createJob;\n\n/**\n * Find and lock jobs\n * @param {String} jobName name of job to try to lock\n * @param {Object} definition definition used to tell how job is run\n * @param {Function} cb called when job lock fails or passes\n * @access protected\n * @caller jobQueueFilling() only\n * @returns {undefined}\n */\nmodule.exports = function(jobName, definition, cb) {\n  const self = this;\n  const now = new Date();\n  const lockDeadline = new Date(Date.now().valueOf() - definition.lockLifetime);\n  debug('_findAndLockNextJob(%s, [Function], cb)', jobName);\n\n  // Don't try and access MongoDB if we've lost connection to it.\n  // Trying to resolve crash on Dev PC when it resumes from sleep. NOTE: Does this still happen?\n  const s = this._mdb.s || this._mdb.db.s;\n  if (s.topology.connections().length === 0) {\n    if (s.topology.autoReconnect && !s.topology.isDestroyed()) {\n      // Continue processing but notify that Agenda has lost the connection\n      debug('Missing MongoDB connection, not attempting to find and lock a job');\n      self.emit('error', new Error('Lost MongoDB connection'));\n      cb();\n    } else {\n      // No longer recoverable\n      debug('topology.autoReconnect: %s, topology.isDestroyed(): %s', s.topology.autoReconnect, s.topology.isDestroyed());\n      cb(new Error('MongoDB connection is not recoverable, application restart required'));\n    }\n  } else {\n    /**\n    * Query used to find job to run\n    * @type {{$or: [*]}}\n    */\n    const JOB_PROCESS_WHERE_QUERY = {\n      $or: [{\n        name: jobName,\n        lockedAt: null,\n        nextRunAt: {$lte: this._nextScanAt},\n        disabled: {$ne: true}\n      }, {\n        name: jobName,\n        lockedAt: {$exists: false},\n        nextRunAt: {$lte: this._nextScanAt},\n        disabled: {$ne: true}\n      }, {\n        name: jobName,\n        lockedAt: {$lte: lockDeadline},\n        disabled: {$ne: true}\n      }]\n    };\n\n    /**\n    * Query used to set a job as locked\n    * @type {{$set: {lockedAt: Date}}}\n    */\n    const JOB_PROCESS_SET_QUERY = {$set: {lockedAt: now}};\n\n    /**\n    * Query used to affect what gets returned\n    * @type {{returnOriginal: boolean, sort: object}}\n    */\n    const JOB_RETURN_QUERY = {returnOriginal: false, sort: this._sort};\n\n    // Find ONE and ONLY ONE job and set the 'lockedAt' time so that job begins to be processed\n    this._collection.findOneAndUpdate(JOB_PROCESS_WHERE_QUERY, JOB_PROCESS_SET_QUERY, JOB_RETURN_QUERY, (err, result) => {\n      let job;\n      if (!err && result.value) {\n        debug('found a job available to lock, creating a new job on Agenda with id [%s]', result.value._id);\n        job = createJob(self, result.value);\n      }\n      if (err) {\n        debug('error occurred when running query to find and lock job');\n      }\n      cb(err, job);\n    });\n  }\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/lib/agenda/find-and-lock-next-job.js\n// module id = 74\n// module chunks = 0","module.exports = require(\"lodash\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"lodash\"\n// module id = 75\n// module chunks = 0","module.exports = require(\"another-mongoose-statemachine\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"another-mongoose-statemachine\"\n// module id = 76\n// module chunks = 0","import path from 'path';\nimport express from 'express';\nimport secure from 'ssl-express-www';\nimport bodyParser from 'body-parser';\nimport api from './api';\nimport ssr from './ssr';\n\nimport Agenda from 'agenda';\nimport Agendash from 'agendash';\n\nimport session from 'express-session';\nimport createMongoStore from 'connect-mongo';\n\n\nconst app = express();\napp.use(secure);\nconst agenda = new Agenda({db: {address: process.env.MONGODB_URI || process.env.MONGO_URL}});\n\napp.use(session({\n    secret: 'qVaNxeu5VVEAtkyFJ/62EKcp7Lw=',\n    saveUninitialized: true, // don't create session until something stored\n\t  resave: false, //don't save session if unmodified\n    store: new (createMongoStore(session))({url: process.env.MONGODB_URI || process.env.MONGO_URL}),\n    cookie: {expires: new Date(253402300000000)}\n}));\n\napp.use('/jobs', Agendash(agenda));\n\napp.set('view engine', 'ejs');\napp.set('views', path.join(__dirname, '../views'));\napp.use(bodyParser.json());\n\napp.use(express.static(path.join(__dirname, '..', 'public')));\n\napp.use('/api', api);\napp.use('/*', ssr);\n\napp.listen(process.env.PORT || 5000, () => {\n  console.log('Hello World listening on port 5000!');\n});\n\n\n\n// WEBPACK FOOTER //\n// ./routes/index.js","module.exports = require(\"ssl-express-www\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"ssl-express-www\"\n// module id = 78\n// module chunks = 0","module.exports = require(\"body-parser\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"body-parser\"\n// module id = 79\n// module chunks = 0","import fs from 'fs';\nimport path from 'path';\nimport express from 'express';\nimport OpenTok from 'opentok';\nimport mongoose from 'mongoose';\nimport JourneySpace from '../models/journey_space';\nimport JourneyParticipant from '../models/journey_participant';\nimport JourneyRSVP from '../models/journey_rsvp';\nimport JourneyContent from '../models/journey_content';\nimport dotenv from 'dotenv';\nrequire('isomorphic-fetch');\n\ndotenv.config();\n\nmongoose.connect(process.env.MONGODB_URI || process.env.MONGO_URL);\n\nfunction promisify(fn) {\n  /**\n   * @param {...Any} params The params to pass into *fn*\n   * @return {Promise<Any|Any[]>}\n   */\n  return function promisified(...params) {\n    return new Promise((resolve, reject) => fn(...params.concat([(err, ...args) => err ? reject(err) : resolve( args.length < 2 ? args[0] : args )])))\n  }\n}\n\nconst opentok = new OpenTok(process.env.OPENTOK_KEY, process.env.OPENTOK_SECRET);\nconst router = express.Router();\n\nfunction generateToken(sessionId) {\n\tlet tokenOptions = {};\n\ttokenOptions.role = \"publisher\";\n\t// Generate a token.\n\tconst token = opentok.generateToken(sessionId, tokenOptions);\n\treturn token;\n}\n\n// TODO: switch to POST, just using GET for easier testing\nrouter.get('/sessions/:room', async (req, res) => {\n\tconst {room} = req.params;\n\tconst existingSession = await JourneySpace.findOne({room}).exec();\n\tif (existingSession) {\n    if (!existingSession.sessionId) {\n      const session = await new Promise((resolve, reject) => {\n        opentok.createSession(async (err, session) => {\n          if (err) reject(err);\n          resolve(session);\n        });\n      });\n      existingSession.sessionId = session.sessionId;\n      await existingSession.save();\n    }\n    const participants = await JourneyParticipant.find({session: existingSession, present: true}).lean().exec();\n    const rsvps = await JourneyRSVP.find({journey: existingSession}).lean().exec();\n    const currentUserHasRSVP = rsvps.findIndex(rsvp => rsvp.user === req.session.id) > -1;\n    if (!currentUserHasRSVP) {\n      const rsvp = new JourneyRSVP({journey: existingSession, user: req.session.id});\n      await rsvp.save();\n      rsvps.push(rsvp);\n    }\n    const response = existingSession.toJSON();\n    response.participants = participants;\n    response.rsvps = rsvps;\n\t\tres.json({\n\t\t\t...response,\n\t\t\ttoken: generateToken(existingSession.sessionId),\n\t\t});\n\t} else {\n\t\topentok.createSession(async (err, session) => {\n\t\t  if (err) throw err;\n\t\t\t// create new journey space, save tok session id\n      const db = mongoose.connection;\n      let selectedJourney;\n      if (req.query.journey) {\n        selectedJourney = await JourneyContent.findOne({name: req.query.journey}).lean().exec();\n      }\n      if (!selectedJourney) {\n        const randomJourney = (await db.collection('journeycontents').aggregate([{$sample: {size: 1}}]).toArray())[0];\n        selectedJourney = randomJourney;\n      }\n      const newSession = new JourneySpace({\n        room, \n        sessionId: session.sessionId,\n        journey: selectedJourney.filePath,\n        name: req.query.name || selectedJourney.name,\n        image: selectedJourney.image,\n      });\n\t\t\tawait newSession.save();\n      const response = newSession.toJSON();\n      response.participants = [];\n      response.rsvps = [];\n\t\t\tres.json({\n\t\t\t\t...response,\n\t\t\t\ttoken: generateToken(session.sessionId),\n\t\t\t});\n\t\t});\n\t}\n});\n\nrouter.post('/sessions/:room/joined', async (req, res) => {\n\tconst {room} = req.params;\n  const {id: connectionId} = req.body;\n  req.session.connections = req.session.connections || {};\n  req.session.connections[room] = connectionId;\n\tconst existingSession = await JourneySpace.findOne({room}).lean().exec();\n\tif (existingSession) {\n      const participantExists = (await JourneyParticipant.count({session: existingSession, connectionId})) > 0;\n      if (!participantExists) {\n        const participant = new JourneyParticipant({session: existingSession, connectionId: connectionId, user: req.session.user});\n        await participant.save();\n      }\n  }\n  res.sendStatus(200);\n});\n\nrouter.get('/sessions/:room/:connectionId', async (req, res) => {\n  const {room, connectionId} = req.params;\n\tconst existingSession = await JourneySpace.findOne({room}).lean().exec();\n\tif (existingSession) {\n    const participant = await JourneyParticipant.findOne({session: existingSession, connectionId}).exec();\n    res.json(participant);\n    return;\n  }\n  res.sendStatus(500);\n});\n\nrouter.get('/active_journeys', async(req, res) => {\n  const journeys = await JourneySpace.aggregate([\n    {\n      $match: {\n        state: {$in: ['created', 'joined']}, startAt: {$gte: new Date()}, room: {$ne: 'temp-home-location'}\n      }\n    }, \n\n    {\n      $lookup: {\n        from: 'journeyrsvps',\n        localField: '_id',\n        foreignField: 'journey',\n        as: 'rsvps'\n      }\n    },\n\n    {\n      $sort: {startAt: 1}\n    }\n  ]);\n  \n  res.json(journeys);\n});\n\nrouter.post('/journeys/:id/rsvp', async (req, res) => {\n  const journey = await JourneySpace.findById(req.params.id).exec();\n  try {\n    await journey.joined();\n  } catch(e) {\n    console.log(e);\n  }\n  const rsvp = new JourneyRSVP({journey, user: req.session.id});\n  await rsvp.save();\n  const globalSpace = await JourneySpace.findOne({room: 'temp-home-location'}).exec();\n  if (globalSpace) {\n    opentok.signal(globalSpace.sessionId, null, { 'type': 'newRSVP', 'data': JSON.stringify(rsvp) }, () => {});\n  }\n  res.sendStatus(200);\n});\n\nrouter.post('/journeys/:room/completed', async (req, res) => {\n  const journey = await JourneySpace.findOne({room: req.params.room}).exec();\n  await journey.complete();\n  const response = journey.toJSON();\n  const participants = await JourneyParticipant.find({session: journey, present: true}).lean().exec();\n  response.participants = participants;\n  opentok.signal(journey.sessionId, null, { 'type': 'journeyUpdated', 'data': JSON.stringify(response) }, () => {});\n  res.sendStatus(200);\n});\n\nrouter.put('/journeys/:room/progress', async (req, res) => {\n  const {currentTime} = req.body;\n  const journey = await JourneySpace.findOne({room: req.params.room}).exec();\n  journey.currentTime = currentTime;\n  await journey.save();\n  res.sendStatus(200);\n});\n\nrouter.post('/journeys/:id/skip', async (req, res) => {\n  const journey = await JourneySpace.findOne({room: req.params.id}).exec();\n  await journey.skip();\n  const response = journey.toJSON();\n  const participants = await JourneyParticipant.find({session: journey, present: true}).lean().exec();\n  response.participants = participants;\n  opentok.signal(journey.sessionId, null, { 'type': 'journeyUpdated', 'data': JSON.stringify(response) }, () => {});\n});\n\n// TEMP: Use get for convenience. hardcode temp-home-location for the room\n// Trigger a general announcement to everyone\nrouter.get('/sessions/test/temp-home-location', async (req, res) => {\n  // const {room, connection} = req.params;\n  const existingSession = await JourneySpace.findOne({room:'temp-home-location'}).exec();\n  if (existingSession) {\n  console.log(\"**** SENDING SIGNAL\")\n  let messageData = {\n    userName: \"Bob\",\n    description: \"some text\",\n    url: \"http://www.news.google.com\"\n  }\n\n  signal(existingSession.sessionId, {type: 'displayJourneyRequest', data: JSON.stringify(messageData)});\n  return res.sendStatus(200);\n  }\n  res.sendStatus(200);\n});\n\nrouter.get('/sessions/:room/connections/:connection/ready', async (req, res) => {\n  const {room, connection} = req.params;\n  const existingSession = await JourneySpace.findOne({room}).exec();\n\tif (existingSession) {\n    const participant = await JourneyParticipant.findOne({session: existingSession, connectionId: connection});\n    participant.ready = true;\n    await participant.save();\n    signal(existingSession.sessionId, {type: 'ready', data: 'foo'});\n    const allReady = (await JourneyParticipant.count({session: existingSession, ready: false, present: true})) === 0;\n    if (allReady) {\n      // signal(existingSession.sessionId, {type: 'startJourney', data: 'foo'});\n    }\n    return res.sendStatus(200);\n  }\n  res.sendStatus(200);\n});\n\nrouter.get('/journeys', async (req, res) => {\n  const journeys = await JourneyContent.find().exec();\n  res.json(journeys);\n});\n\nrouter.put('/sessions/:room/journey', async (req, res) => {\n  const {journey: journeyFile} = req.body;\n  const {room} = req.params;\n  const journey = await JourneySpace.findOne({room}).exec();\n  const journeyContent = await JourneyContent.findOne({filePath: journeyFile}).exec();\n\tif (journey) {\n    journey.journey = journeyContent.filePath;\n    journey.image = journeyContent.image;\n    journey['name'] = journeyContent.get('name');\n    await journey.save();\n    await journey.reset();\n    const response = journey.toJSON();\n    const participants = await JourneyParticipant.find({session: journey, present: true}).lean().exec();\n    response.participants = participants;\n    opentok.signal(journey.sessionId, null, { 'type': 'journeyUpdated', 'data': JSON.stringify(response) }, () => {});\n  }\n  res.sendStatus(200);\n});\n\n// TODO: this should really verify that the user hitting this endpoint is authorized to do so (e.g. that they are the journey's host)\nrouter.post('/sessions/:room/start', async (req, res) => {\n  const {room} = req.params;\n  const existingSession = await JourneySpace.findOne({room}).exec();\n\tif (existingSession) {\n    try {\n      await existingSession.start();\n    } catch(e) {\n      console.log('error starting journey', e);\n    }\n    signal(existingSession.sessionId, {type: 'startJourney', data: ''});\n  }\n});\n\nrouter.post('/sessions/:room/pause', async (req, res) => {\n  const {room} = req.params;\n  const existingSession = await JourneySpace.findOne({room}).exec();\n\tif (existingSession) {\n    try {\n      await existingSession.pause();\n    } catch(e) {\n      console.log('error pausing journey', e);\n    }\n    signal(existingSession.sessionId, {type: 'pauseJourney', data: ''});\n  }\n});\n\n\nrouter.post('/sessions/:room/flag', async (req, res) => {\n  const {room} = req.params;\n  const userId = req.sessionID; // using sessionId as representation of user for now\n  const existingSession = await JourneySpace.findOne({room}).exec();\n\tif (existingSession) {\n    existingSession.flags.push({user: userId});\n    await existingSession.save();\n    const participants = await JourneyParticipant.find({session: existingSession, present: true}).lean().exec();\n    return res.json({...existingSession.toJSON(), participants});\n  }\n  res.sendStatus(404);\n});\n\nrouter.post('/event', async (req, res) => {\n  const {sessionId, connection} = req.body;\n  const session = await JourneySpace.findOne({sessionId}).exec();\n\n  console.log(\"*******\" + req.body)\n\n  switch(req.body.event) {\n    case 'connectionCreated':\n      if (session) {\n        const participantExists = (await JourneyParticipant.count({session, connectionId: connection.id})) > 0;\n        if (!participantExists) {\n          const participant = new JourneyParticipant({session, connectionId: connection.id});\n          await participant.save();\n        }\n      }\n      break;\n    case 'connectionDestroyed':\n      if (session) {\n        const participant= await JourneyParticipant.findOne({session, connectionId: connection.id});\n        if (participant) {\n          participant.present = false;\n          await participant.save();\n        }\n      }\n      break\n  }\n});\n\nrouter.post('/login', (req, res) => {\n  req.session.loggedIn = true;\n  req.session.user = {\n    name: req.body.name\n  };\n  res.json({loggedIn: true, user: {name: req.body.name}});\n});\n\nrouter.get('/logout', (req, res) => {\n  req.session.destroy(() => {\n      res\n        .clearCookie('connect.sid')\n        .redirect('/login')\n    });\n});\n\nfunction signal(sessionId, data) {\n  fetch(`https://api.opentok.com/v2/project/${process.env.OPENTOK_KEY}/session/${sessionId}/signal`, {\n    headers: {\n      'X-TB-PARTNER-AUTH': `${process.env.OPENTOK_KEY}:${process.env.OPENTOK_SECRET}`\n    },\n    method: 'POST',\n    mode: 'cors',\n    body: JSON.stringify(data)\n  }).then(response => console.log(response));\n}\n\nexport default router;\n\n\n\n\n// WEBPACK FOOTER //\n// ./routes/api.js","import mongoose, {Schema} from 'mongoose';\n\nconst JourneyParticipantSchema = new Schema({\n  \"connectionId\": {type: String, index: true},\n  \"session\": {type: Schema.Types.ObjectId, ref: 'JourneySpace'},\n  \"ready\": {type: Boolean, default: false},\n  \"present\": {type: Boolean, default: true},\n  user: new Schema({name: String})\n});\n\nconst JourneyParticipant = mongoose.model('JourneyParticipant', JourneyParticipantSchema);\n\nexport default JourneyParticipant;\n\n\n\n\n// WEBPACK FOOTER //\n// ./models/journey_participant.js","import express from 'express';\nimport React from 'react';\nimport ReactDOMServer from 'react-dom/server';\nimport { createStore } from 'redux';\nimport { Provider } from 'react-redux';\nimport { StaticRouter } from 'react-router';\nimport App from '../../client/src/app';\nimport state from '../../client/src/state';\n\nconst router = express.Router();\n\nrouter.get('/', (req, res) => {\n  const context = {};\n\n  state.loggedIn = req.session.loggedIn;\n  state.user = req.session.user;\n  console.log('GOT SESSION', req.session, req.originalUrl);\n\n  const html = ReactDOMServer.renderToString(\n    <StaticRouter\n      location={req.originalUrl}\n      context={context}\n    >\n      <App />\n    </StaticRouter>\n  );\n\n  console.log('GOT HTML', html, context.url);\n  if (context.url) {\n    console.log('REDIRECT');\n    if (req.originalUrl != '/favicon.ico') {\n      res.writeHead(301, {\n        Location: context.url,\n      });\n    }\n    res.end();\n  } else {\n    res.status(200).render(process.env.NODE_ENV === 'production' ? 'index.ejs' : 'index.dev.ejs', {\n      html,\n      script: JSON.stringify({openTokKey: process.env.OPENTOK_KEY, loggedIn: req.session.loggedIn, user: req.session.user, sessionId: req.sessionID}),\n    });\n  }\n});\n\n\nexport default router;\n\n\n\n// WEBPACK FOOTER //\n// ./routes/ssr.js","module.exports = require(\"react-dom/server\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"react-dom/server\"\n// module id = 83\n// module chunks = 0","module.exports = require(\"redux\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"redux\"\n// module id = 84\n// module chunks = 0","module.exports = require(\"react-redux\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"react-redux\"\n// module id = 85\n// module chunks = 0","import React, {Component} from 'react';\nimport { Route, Redirect, Switch, Link } from 'react-router-dom';\nimport { withRouter } from 'react-router';\nimport { view } from 'react-easy-state';\nimport PropTypes from 'prop-types';\nimport moment from 'moment';\nimport Header from './components/header';\nimport Home from './components/home';\nimport Room from './components/Room';\nimport CountdownMessage from './components/countdown_message';\nimport state from './state';\n\nvar { OTSession, OTPublisher, OTStreams, OTSubscriber, createSession } = {};\n\nif (__CLIENT__) {\n  var { OTSession, OTPublisher, OTStreams, OTSubscriber, createSession } = require('opentok-react');\n  const OT = require('@opentok/client');\n  document.body.addEventListener('click', (e) => {\n    if (state.audioTag && state.audioTag.paused) {\n      state.audioTag.play().then(() => {\n        state.audioTag.pause();\n      });\n    }\n  });\n}\n\n\nconst RequireLoginRoute = ({component: Component, ...rest}) => {\n  return (\n    <Route {...rest} render={renderProps => {\n        return (\n          state.loggedIn ?\n            <Component {...renderProps} />\n          : <Redirect to={ {\n                pathname: '/login'\n            }} />\n        )\n    }}/>\n  )\n};\n\nclass Login extends Component {\n  static propTypes = {\n    match: PropTypes.object.isRequired,\n    location: PropTypes.object.isRequired,\n    history: PropTypes.object.isRequired\n  }\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      name: ''\n    }\n  }\n\n  onChange(field) {\n    return (e) => {\n      this.setState({\n        [field]: e.target.value\n      });\n    }\n  }\n\n  login = (e) => {\n    e.preventDefault();\n    fetch(`/api/login`, {\n      body: JSON.stringify({name: this.state.name}), // must match 'Content-Type' header\n      method: 'POST', // *GET, POST, PUT, DELETE, etc.\n      credentials: 'same-origin',\n      headers: {\n        'content-type': 'application/json'\n      }\n    })\n    .then(response => response.json())\n    .then(json => {\n      state.loggedIn = json.loggedIn;\n      state.user = json.user;\n      this.props.history.push('/');\n    });\n  }\n\n  render() {\n    return (\n      <div style={{padding: '20px', width: '50%'}}>\n        <form onSubmit={this.login}>\n          <div className=\"form-group\">\n            <label htmlFor=\"name\">Name</label>\n            <input type=\"text\" onChange={this.onChange('name')} value={this.state.name} className=\"form-control\" id=\"name\" aria-describedby=\"nameHelp\" placeholder=\"Enter name\"/>\n          </div>\n          <button type=\"submit\" className=\"btn btn-primary\">Submit</button>\n        </form>\n      </div>\n    )\n  }\n}\n\nclass JoinableJourneyCard extends Component {\n\n  onJoin = (e) => {\n    e.preventDefault();\n    fetch(`/api/journeys/${this.props.journey._id}/rsvp`, {\n      cache: 'no-cache', // *default, no-cache, reload, force-cache, only-if-cached\n      credentials: 'same-origin', // include, same-origin, *omit\n      headers: {\n        'content-type': 'application/json'\n      },\n      method: 'POST', // *GET, POST, PUT, DELETE, etc.\n      mode: 'cors', // no-cors, cors, *same-origin\n      redirect: 'follow', // manual, *follow, error\n      referrer: 'no-referrer', // *client, no-referrer\n    });\n  }\n\n  render() {\n    const {journey} = this.props;\n    const currentUserHasRSVP = (journey.rsvps || []).find(rsvp => rsvp.user === state.sessionId) != null;\n\n    return (\n      <div className='joinable-journey-card'>\n        <div className='image'>\n          <img src={journey.image}/>\n        </div>\n        <div className='content'>\n        <CountdownMessage endTime={journey.startAt} />\n          <h4>{journey.name}</h4>\n          <p>Starts at: {moment(journey.startAt).format('LT')}</p>\n          <p>{journey.rsvps.length} / 3</p>\n          { journey.rsvps.length < 3 && !currentUserHasRSVP &&\n            <a href={`/${journey.room}`} onClick={this.onJoin} className='btn btn-primary'>Join</a>\n          }\n          { currentUserHasRSVP &&\n            <Link to={`/${journey.room}`} className='btn btn-primary'>Go there now</Link>\n          }\n        </div>\n      </div>\n    )\n  }\n}\n\nclass AutoCreatedJourneysQueue extends Component {\n\n  componentDidMount() {\n    const roomUrl = 'temp-home-location'\n\n    // subscribe to global events\n    fetch(`/api/sessions/${roomUrl}`, {credentials: 'include'})\n      .then(res => res.json())\n      .then(json => {\n        state.session = json;\n        this.sessionHelper = createSession({\n          apiKey: state.openTokKey,\n          sessionId: state.session.sessionId,\n          token: state.session.token,\n          onConnect: () => {\n          }\n        });\n\n        this.sessionHelper.session.on(\"signal:createdNewJourney\", (event) => {\n          state.joinableJourneys.push(JSON.parse(event.data));\n        });\n\n        this.sessionHelper.session.on(\"signal:expiredJourney\", (event) => {\n          const journey = JSON.parse(event.data);\n          const idx = state.joinableJourneys.findIndex(j => j._id === journey._id);\n          state.joinableJourneys = [...state.joinableJourneys.slice(0, idx), ...state.joinableJourneys.slice(idx + 1)];\n        });\n\n        this.sessionHelper.session.on(\"signal:failJourney\", (event) => {\n          const journey = JSON.parse(event.data);\n          const idx = state.joinableJourneys.findIndex(j => j._id === journey._id);\n          state.joinableJourneys = [...state.joinableJourneys.slice(0, idx), ...state.joinableJourneys.slice(idx + 1)];\n        });\n\n        this.sessionHelper.session.on('signal:newRSVP', (event) => {\n          const rsvp = JSON.parse(event.data);\n          const journey = state.joinableJourneys.find(j => j._id == rsvp.journey._id);\n          const idx = state.joinableJourneys.findIndex(j => j._id === journey._id);\n          if (journey.rsvps.findIndex(rsvp => rsvp._id === rsvp._id) === -1) {\n            journey.rsvps.push(rsvp);\n          }\n          state.joinableJourneys = [...state.joinableJourneys.slice(0, idx), journey, ...state.joinableJourneys.slice(idx + 1)];\n        });\n\n      });\n\n\n    // fetch currently active journeys\n    fetch('/api/active_journeys')\n      .then(res => res.json())\n      .then(json => {\n        state.joinableJourneys = json;\n      });\n  }\n\n  render() {\n    return (\n      <div className='joinable-journeys'>\n        {state.joinableJourneys.map(journey => <JoinableJourneyCard key={journey._id} journey={journey} audioTag={this.audioTag}/>)}\n      </div>\n    )\n  }\n}\n\nclass App extends Component {\n  render() {\n    return (\n      <div>\n        <Header />\n        <Switch>\n          <Route exact path=\"/login\" component={withRouter(Login)} />\n          <Route exact path=\"/join\" component={view(AutoCreatedJourneysQueue)} />\n          <Route exact path=\"/\" component={Home} />\n          <Route exact path=\"/:room\" component={Room} />\n        </Switch>\n      </div>\n    )\n  }\n}\n\nexport default withRouter(view(App));\n\n\n\n// WEBPACK FOOTER //\n// ../client/src/app.js","import React from 'react';\nimport { view } from 'react-easy-state';\nimport state from '../state';\n\nimport logo from 'file-loader!isomorphic-loader!../../res/images/CuriousLive-logo.png';\n\nconst Header = () => (\n  <div className=\"header\" style={{display: 'flex', alignItems: 'center'}}>\n    <h1 className='logo'><img src={logo}/></h1>\n    {state.session && !state.session.startAt &&\n      <h2 style={{color: 'white', fontSize: '16px'}}>{state.session.name}</h2>\n    }\n    {false && state.loggedIn && state.user &&\n      <div>\n        <span className='mr-2 text-secondary'>logged in as {state.user.name}</span>\n        <a href='/api/logout'>Logout</a>\n      </div>\n    }\n  </div>\n);\n\nexport default view(Header);\n\n\n\n// WEBPACK FOOTER //\n// ../client/src/components/header.js","module.exports = __webpack_public_path__ + \"f8a62333255a9846821aec2c092c395e.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/file-loader!../node_modules/isomorphic-loader!../client/res/images/CuriousLive-logo.png\n// module id = 88\n// module chunks = 0","import React, { Component } from 'react';\nimport UserList from './user_list'\nimport GeneratorForm from './generator_form'\nimport EventMessage from './event_message'\nimport JourneySpaceForm from './journey_space_form'\nimport state from '../state'\n\nvar { OTSession, OTPublisher, OTStreams, OTSubscriber, createSession } = {};\n\nif (__CLIENT__) {\n  var { OTSession, OTPublisher, OTStreams, OTSubscriber, createSession } = require('opentok-react');\n  const OT = require('@opentok/client');\n}\n\nexport default class Home extends Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      streams: [],\n      publisherId: '',\n      session: null,\n      totalConnectionsCreated: 0,\n      connectedUsers: []\n    }\n    this.publisher = {};\n  }\n\n  componentDidMount() {\n    const roomUrl = 'temp-home-location'\n\n    fetch(`/api/sessions/${roomUrl}`)\n      .then(res => res.json())\n      .then(json => {\n        state.session = json;\n        this.sessionHelper = createSession({\n          apiKey: state.openTokKey,\n          sessionId: state.session.sessionId,\n          token: state.session.token,\n          onConnect: () => {\n            setTimeout(this.refreshSession, 1000);\n            fetch(`/api/sessions/${roomUrl}/joined`, {\n              body: JSON.stringify({id: this.sessionHelper.session.connection.id}),\n              credentials: 'same-origin', // include, same-origin, *omit\n              headers: {\n                'user-agent': 'Mozilla/4.0 MDN Example',\n                'content-type': 'application/json'\n              },\n              method: 'POST', // *GET, POST, PUT, DELETE, etc.\n              mode: 'cors', // no-cors, cors, *same-origin\n              redirect: 'follow', // manual, *follow, error\n              referrer: 'no-referrer', // *client, no-referrer\n            });\n          },\n          onStreamsUpdated: streams => {\n            this.setState({ streams });\n          }\n        });\n        window.sh = this.sessionHelper;\n        this.sessionHelper.session.on(\"connectionDestroyed\", (event) => {\n          const data = {\n            sessionId: this.sessionHelper.session.sessionId,\n            connection: {\n              id: event.connection.id\n            },\n            event: 'connectionDestroyed',\n\n          }\n\n          const updatedConnectionCount = this.state.totalConnectionsCreated - 1\n          this.setState({totalConnectionsCreated: updatedConnectionCount})\n\n          let newData = [...this.state.connectedUsers]\n          let index = newData.map(d => d.connectionId).indexOf(event.connection.id)\n          newData.splice(index, 1)\n          this.setState({connectedUsers: newData})\n        });\n\n\n\n        this.sessionHelper.session.on(\"connectionCreated\", (event) => {\n          const updatedConnectionCount = this.state.totalConnectionsCreated + 1\n          this.setState({totalConnectionsCreated: updatedConnectionCount})\n\n          const data = {\n            sessionId: this.sessionHelper.session.sessionId,\n            connection: {\n              id: event.connection.id\n            },\n            event: 'connectionCreated',\n          }\n\n          let tries = 10;\n          const fetchRetry = () => {\n            fetch(`/api/sessions/${roomUrl}/${event.connection.id}`).then(res => res.json()).then(json => {\n              if (!json && tries-- > 0) {\n                setTimeout(fetchRetry, 500);\n              } else {\n                this.setState({\n                  connectedUsers: [...this.state.connectedUsers, json]\n                });\n              }\n            });\n          }\n          fetchRetry();\n        });\n\n\n\n        this.sessionHelper.session.on(\"signal\", (event) => {\n          if (event.type === 'signal:displayJourneyRequest') {\n            this.setState({\n              displayMessageVisible: true,\n              displayMessageText: \"George has created a session 'Daily Jetsons Meditation'.\", //TEMP hard coded\n              sessionUrl: '/another-jetsons-url'\n            });\n          }\n        });\n\n        this.setState({\n          session: this.sessionHelper.session\n        });\n      });\n\n\n    fetch('/api/journeys')\n      .then(res => res.json())\n      .then(json => {\n        state.journeys = json;\n      });\n\n  }\n\n  render() {\n    return (\n      <div className=\"home container\">\n        <div className=\"row\">\n          <UserList userCount={this.state.totalConnectionsCreated} connections={this.state.connectedUsers} />\n          <div className=\"col-sm\">\n            <JourneySpaceForm />\n            <EventMessage journeys={state.journeys} />\n          </div>\n        </div>\n      </div>\n      )\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ../client/src/components/home.js","import React, {Component} from 'react'\n\nexport default class UserList extends Component {\n  constructor(props) {\n    super(props);\n  }\n\n  render() {\n    return (\n      <div className=\"col-sm\">\n        <h4>Current Users ({this.props.userCount})</h4>\n        <ul>\n          {this.props.connections.map(function(connection){\n            return <li key={connection.user.name}>{connection.user.name}</li>;\n          })}\n        </ul>\n      </div>\n    )\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ../client/src/components/user_list.js","import React, {Component} from 'react'\nimport state from '../state';\n\nexport default class GeneratorForm extends Component {\n\n  constructor(props){\n    super(props)\n    this.state = {\n      sessionLinkName: '',\n      sessionLinkUrl: '',\n      activeJourneys: []\n    }\n\n    this.handleNameChange = this.handleNameChange.bind(this)\n    this.urlFriendlyName = this.urlFriendlyName.bind(this)\n    this.createSessionLink = this.createSessionLink.bind(this)\n\n  }\n\n  createSessionLink() {\n    this.setState({sessionLinkUrl: this.urlFriendlyName(this.state.sessionLinkName) })\n    fetch('/api/sessions/test/temp-home-location')\n\n    fetch('/api/active_journeys')\n    .then(res => res.json())\n    .then(json => {\n      state.activeJourneys = json\n    });\n  }\n\n  sendNotifications() {\n\n  }\n\n  handleNameChange(event) {\n    this.setState({sessionLinkName: event.target.value})\n  }\n\n  urlFriendlyName(name){\n    return name.replace(/\\s+/g, '-').toLowerCase()\n  }\n\n\n  render() {\n      return(\n        <div>Hello</div>\n      )\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ../client/src/components/generator_form.js","import React from 'react'\n\nconst EventMessage = (props) => {\n  return (\n    <div className=\"col-sm\">\n      {props.journeys.map((journey, index) => (\n        <p key={index}\n           style={{ backgroundColor: '#fc9', padding: '7px'}}>\n           A journey space has been created.\n           <br/>\n           <a href={\"/\" + journey.room} target=\"_blank\">Join</a>\n           &nbsp;&nbsp;\n           <a href=\"#\">Share</a></p>\n      ))}\n    </div>\n  );\n}\n\nexport default EventMessage\n\n\n\n// WEBPACK FOOTER //\n// ../client/src/components/event_message.js","import React, {Component} from 'react'\nimport JourneyDetailEntry from './journey_detail_entry'\n\nexport default class JourneySpaceForm extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      visible: false\n    }\n\n    this.toggleVisibility = this.toggleVisibility.bind(this)\n  }\n\n  toggleVisibility() {\n    this.setState({visible: !this.state.visible})\n  }\n\n  render() {\n      return (\n        <div className=\"col-sm\">\n          <div className=\"container\" style={{ border: '1px solid #e6e6e6', padding:'10px'}}>\n            <form>\n              <button type=\"button\" className=\"btn btn-outline-primary btn-block\" onClick={this.toggleVisibility}>\n                <i className=\"fa fa-plus\"></i>&nbsp;&nbsp;Create a new Journey Space\n              </button>\n              <JourneyDetailEntry detailVisibility={this.state.visible} />\n            </form>\n          </div>\n        </div>\n      )\n  }\n\n\n}\n\n\n// WEBPACK FOOTER //\n// ../client/src/components/journey_space_form.js","import React, {Component} from 'react'\nimport SessionInfo from './session_info'\n\nexport default class JourneyDetailEntry extends Component {\n\n    constructor(props){\n    super(props)\n    this.state = {\n      visible: false,\n      sessionVisible: false,\n      sessionLinkName: '',\n      sessionLinkUrl: '',\n      activeJourneys: []\n    }\n\n    this.handleNameChange = this.handleNameChange.bind(this)\n    this.urlFriendlyName = this.urlFriendlyName.bind(this)\n    this.createSessionLink = this.createSessionLink.bind(this)\n\n  }\n\n  createSessionLink() {\n    this.setState({sessionLinkUrl: this.urlFriendlyName(this.state.sessionLinkName) })\n    fetch('/api/sessions/test/temp-home-location')\n\n    fetch('/api/active_journeys')\n    .then(res => res.json())\n    .then(json => {\n      state.activeJourneys = json\n      this.setState({sessionVisible: true})\n    });\n  }\n\n  handleNameChange(event) {\n    this.setState({sessionLinkName: event.target.value})\n  }\n\n  urlFriendlyName(name){\n    return name.replace(/\\s+/g, '-').toLowerCase()\n  }\n\n\n  componentWillReceiveProps(nextProps) {\n    this.setState({ visible: nextProps.detailVisibility});\n  }\n\n\n  render() {\n    if(this.state.visible === true) {\n    return (\n      <div>\n        <h3>Enter Journey Details</h3>\n        <p>\n          Give your room a name:<br/>\n          <input type=\"text\" id=\"session_link\" onChange={this.handleNameChange} />\n        </p>\n        <p>\n          <input type=\"button\" className=\"btn btn-primary\" value=\"Create a journey space\" onClick={this.createSessionLink} />\n        </p>\n        <SessionInfo sessionVisibility={this.state.sessionVisible} sessionLink={this.state.sessionLinkUrl} />\n      </div>\n    )\n    } else {\n      return (\n        <div></div>\n      )\n    }\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ../client/src/components/journey_detail_entry.js","import React, {Component} from 'react'\n\nexport default class SessionInfo extends Component {\n\n  constructor(props){\n    super(props)\n    this.state = {\n      visible: false,\n      sessionLinkUrl: ''\n    }\n\n    this.jumpToSession = this.jumpToSession.bind(this)\n  }\n\n  componentWillReceiveProps(nextProps) {\n    this.setState({ sessionLinkUrl: nextProps.sessionLink });\n    this.setState({ visible: nextProps.sessionVisibility });\n  }\n\n  jumpToSession() {\n    window.open(this.state.sessionLinkUrl, \"_blank\")\n  }\n\n  // TODO: npm install --save react@^16.2.0 react-dom@^16.2.0 for getDerivedstateFromProps\n\n  render() {\n    if(this.state.visible === true) {\n      return(\n        <div>\n          <strong>You created journey space!</strong>\n          <p><span style={{ fontWeight: 'bold', backgroundColor: '#ccc', padding: '7px' }}>www.wacuri.com/{this.state.sessionLinkUrl}</span>&nbsp;<input className=\"btn btn-primary\" type=\"button\" value=\"Jump to the session\" onClick={this.jumpToSession} /></p>\n        </div>\n      )\n\n    } else {\n      return (\n        <div></div>\n      )\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ../client/src/components/session_info.js","import EventEmitter from 'events';\nimport React, {Component} from 'react';\nimport { view } from 'react-easy-state'\nimport { Link } from 'react-router-dom';\nimport Cookie from 'js-cookie';\nimport SwipeableViews from 'react-swipeable-views';\nimport SignaturePad from './signature_pad';\nimport state from '../state';\nimport PropTypes from 'prop-types';\nimport uuid from 'uuid';\nimport {initLayoutContainer} from 'opentok-layout-js';\nimport './share';\n\nrequire('es6-promise').polyfill();\nrequire('isomorphic-fetch');\n\nvar { OTSession, OTPublisher, OTStreams, OTSubscriber, createSession } = {};\n\nif (__CLIENT__) {\n\tvar { OTSession, OTPublisher, OTStreams, OTSubscriber, createSession } = require('opentok-react');\n\tconst OT = require('@opentok/client');\n\twindow.state = state;\n}\n\nclass AbstractTimerEmitter extends EventEmitter {\n  _displayTime(millisec: number) {\n    if (millisec < 0) { return '0:00'; }\n    const normalizeTime = (time: string): string => (time.length === 1) ? time.padStart(2, '0') : time;\n\n    let seconds: string = (millisec / 1000).toFixed(0);\n    let minutes: string = Math.floor(parseInt(seconds) / 60).toString();\n    let hours: string = '';\n\n    if (parseInt(minutes) > 59) {\n     hours = normalizeTime(Math.floor(parseInt(minutes) / 60).toString());\n     minutes = normalizeTime((parseInt(minutes) - (parseInt(hours) * 60)).toString());\n    }\n    seconds = normalizeTime(Math.floor(parseInt(seconds) % 60).toString());\n\n    if (hours !== '') {\n      return `${hours}:${minutes}:${seconds}`;\n    }\n    return `${minutes}:${seconds}`;\n  }\n}  \n\nclass SecondsTimerEmitter extends AbstractTimerEmitter {\n  constructor(createdAt, startAt) {\n    super();\n    this.start = createdAt.getTime();\n    this.total = startAt.getTime() - this.start;\n    this.passed = new Date().getTime() - this.start;\n    this.interval = setInterval(() => {\n      this.passed = new Date().getTime() - this.start;\n      if (this.passed >= this.total) {\n        clearInterval(this.interval);\n      }\n      this.emit('tick', this.passed);\n    }, 100);\n  }\n\n  clear() {\n    clearInterval(this.interval);\n  }\n\n  displayTime() {\n    return this._displayTime(this.total - this.passed);\n  }\n  \n}\n\nclass AudioPlayTickEmitter extends AbstractTimerEmitter {\n  constructor(audioElement) {\n    super();\n    this.currentTime = (audioElement.currentTime || 0) * 1000;\n    this.total = audioElement.duration * 1000;\n    if (audioElement.readyState === 4) {\n      audioElement.addEventListener('timeupdate', this.onTimeUpdate);\n      this.emit('tick', audioElement.currentTime * 1000);\n    }\n\n    audioElement.addEventListener('loadedmetadata', (e) => {\n      audioElement.addEventListener('timeupdate', this.onTimeUpdate);\n      this.emit('tick', audioElement.currentTime * 1000);\n    });\n  }\n\n\n  onTimeUpdate = (e) => {\n    this.currentTime = e.target.currentTime * 1000;\n    this.emit('tick', this.currentTime);\n  }\n\n  clear() {\n    \n  }\n\n  displayTime() {\n    return this._displayTime(this.total - this.currentTime);\n  }\n}\n\nconst FlagControl = ({currentUserHasFlaggedJourney, onFlag, children}) => {\n  return (\n    <button \n      className='btn btn-flag-session'\n      disabled={currentUserHasFlaggedJourney}\n      onClick={onFlag}>\n      {children}  \n    </button>\n  )\n}\nclass Waiting extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      open: true\n    }\n  }\n\n  componentDidUpdate() {\n    if (this.canvas) {\n      var signaturePad = new SignaturePad(this.canvas, {\n        backgroundColor: 'rgb(255, 255, 255)',\n        penColor: '#666',\n        minWidth: 1,\n        maxWidth: 10,\n      });\n\n      var _this = this;\n      function fadeOut() {\n        var ctx = _this.canvas.getContext('2d');\n        ctx.fillStyle = \"rgba(0,0,0,0.01)\";\n        ctx.fillRect(0, 0, _this.canvas.width, _this.canvas.height);\n        setTimeout(fadeOut,100);\n      }\n\n      var ctx = _this.canvas.getContext('2d');\n      ctx.fillStyle = \"rgba(42,42,42,1)\";\n      ctx.fillRect(0, 0, _this.canvas.width, _this.canvas.height);\n      \n      fadeOut();\n    }\n  }\n\n  onToggle = (e) => {\n    this.setState({\n      open: !this.state.open\n    });\n  }\n\n  render() {\n    return (\n      <div style={{overflow: 'hidden', position: 'relative'}}>\n        {!this.state.open &&\n          <div>\n            <p>Chill out, draw something:</p>\n            <div className='wrapper'>\n              <canvas className='signature-pad' ref={el => this.canvas = el} width={400} height={400}/>\n            </div>\n          </div>\n        }\n        <div className='waiting' style={{transform: `translateY(${this.state.open ? '0' : '94%'})`, position: `${this.state.open ? 'relative' : 'absolute'}`}}>\n          <a className='text-right mr-3' style={{display: 'block', color: 'white'}} href='#' onClick={this.onToggle}>{this.state.open ? 'Close X' : 'Open ^'}</a>\n          <div style={{WebkitOverflowScrolling: 'touch', overflowY: 'scroll'}}>\n            <iframe height='100%' width='100%' style={{width: '100%', height: '400px', border: 'none'}} src='https://docs.google.com/viewer?url=http://wacuri.herokuapp.com/CuriousLive4-Stage%20Orientation.pdf&embedded=true'/>\n          </div>\n        </div>\n      </div>\n    )\n  }\n}\n\nclass JourneyStateProgressBar extends Component {\n\n  constructor(props) {\n    super(props);\n    props.timer.on('tick', (current) => {\n      this.setState({\n        timerValue: current\n      });\n    });\n    this.state = {\n      timerValue: 0,\n      total: props.timer.total,\n    }\n  }\n\n  componentWillReceiveProps(newProps) {\n    newProps.timer.on('tick', (current) => {\n      this.setState({\n        timerValue: current\n      });\n    });\n  }\n\n  componentWillUnmount() {\n    this.props.timer.clear();\n  }\n\n  formatState(state: number) {\n    switch(this.props.journey.state) {\n      case 'joined':\n      case 'created':\n        return 'Waiting';\n      case 'started':\n      case 'paused':\n        return 'The Journey';\n      case 'ended':\n        return 'The Sharing';\n      case 'failed':\n        return 'No one joined';\n      default:\n        return 'Waiting';\n    }\n  }\n\n  render() {\n    return (\n      <div className='journeyspace-progress pl-3 pr-3'>\n        <small>Current Section</small>\n        <progress max={this.props.timer.total} value={this.state.timerValue} style={{width: '100%'}}></progress>\n        <div style={{display: 'flex'}}>\n          <p>{this.formatState(this.props.journey.state)}</p>\n          <p style={{marginLeft: 'auto'}}>-{this.props.timer.displayTime()}</p>\n        </div>\n      </div>\n    )\n  }\n}\n\nclass JourneyTimeline extends Component {\n\n  componentWillReceiveProps(newProps) {\n    newProps.timer.on('tick', (current) => {\n      this.setState({\n        timerValue: current\n      });\n    });\n  }\n\n  get stepIndex() {\n    switch(this.props.journey.state) {\n      case 'joined':\n      case 'created':\n        return 0;\n      case 'started':\n      case 'paused':\n        return 1;\n      default:\n        return 2;\n    }\n  }\n\n  get positionForCaret() {\n    if (!this.container) { return 0; }\n    const idx = this.stepIndex;\n    const items = this.container.querySelectorAll('li');\n    return Array(idx + 1).fill(0).reduce((memo, i, j) => {\n      if (j == 0) {\n        return 0;\n      } else {\n        return memo + items[j - 0].offsetHeight;\n      }\n    }, 0);\n  }\n  \n  get heightForActive() {\n    if (!this.container) { return 0; }\n    const idx = this.stepIndex;\n    const items = this.container.querySelectorAll('li');\n    return items[idx].offsetHeight;\n  }\n\n  render() {\n    const {journey} = this.props;\n    return (\n      <div ref={el => {this.container = el}} className={`journey-timeline step-${this.stepIndex.toString()}`}>\n        <ul>\n          <li className={journey.state === 'joined' ? 'active' : ''}>\n            <h4>Prepare</h4>\n            <div style={{display: 'flex'}}>\n              <p>Breathe and center yourself</p>\n              {journey.state === 'joined' &&\n                <p className='timer' style={{marginLeft: '10px'}}>{this.props.timer.displayTime()}</p>\n              }\n            </div>\n          </li>\n          <li className={journey.state === 'started' ? 'active' : ''} style={{position: 'relative'}}>\n            <h4>Journey</h4>\n            <div style={{display: 'flex'}}>\n              <p>Listen and imagine</p>\n              {(journey.state === 'started' || journey.state === 'paused') &&\n                <p className='timer' style={{marginLeft: '10px'}}>{this.props.timer.displayTime()}</p>\n              }\n              {(journey.state === 'started' || journey.state === 'paused') &&\n                <div style={{position: 'absolute', bottom: '-12px', left: '10px', right: '10px'}}>\n                  <progress max={this.props.timer.total} value={this.props.timer.currentTime} style={{width: '100%'}}></progress>\n                </div>\n              }\n            </div>\n          </li>\n          <li>\n            <h4>Sharing</h4>\n            <p>Feelings and thoughts</p>\n          </li>\n        </ul>\n        <div className='arrow' style={{height: `${this.heightForActive}px`, width: `${this.heightForActive}px`, transform: `translateY(${this.positionForCaret}px)`}}>\n          <svg xmlns=\"http://www.w3.org/2000/svg\" version=\"1.1\" class=\"svg-triangle\" viewBox=\"0 0 100 100\" preserveAspectRatio=\"none\" shapeRendering=\"geometricPrecision\">\n            <path d=\"M 70 50 100 5 100 100 Z\"/>\n          </svg>\n        </div>\n      </div>\n    )\n  }\n}\n\nclass SkipButton extends Component {\n\n  skipToNext = (e) => {\n    e.preventDefault();\n    fetch(`/api/journeys/${this.props.journey.room}/skip`, {\n      cache: 'no-cache', // *default, no-cache, reload, force-cache, only-if-cached\n      credentials: 'same-origin', // include, same-origin, *omit\n      headers: {\n        'content-type': 'application/json'\n      },\n      method: 'POST', // *GET, POST, PUT, DELETE, etc.\n      mode: 'cors', // no-cors, cors, *same-origin\n      redirect: 'follow', // manual, *follow, error\n      referrer: 'no-referrer', // *client, no-referrer\n    });\n  }\n\n  render() {\n    return (\n      this.props.journey.state != 'completed' ? <button style={this.props.style || {}} className='btn btn-secondary' onClick={this.skipToNext}><i className='fa fa-forward'></i></button> : <span/>\n    )\n  }\n}\n\nclass VideoButton extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      publishing: true\n    }\n  }\n\n  toggle = (e) => {\n    e.preventDefault();\n    const {publisher} = this.props;\n    if (publisher && publisher.state && publisher.state.publisher) {\n      publisher.state.publisher.publishVideo(!this.state.publishing);\n      this.setState({\n        publishing: !this.state.publishing\n      });\n    }\n  }\n\n  render() {\n    return (\n      <button style={this.props.style || {}} onClick={this.toggle} className={`btn btn-${this.state.publishing ? 'primary' : 'secondary'}`}><i className=\"fa fa-video-camera\"></i></button>\n    )\n  }\n}\n\nclass AudioButton extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      publishing: true\n    }\n  }\n\n  toggle = (e) => {\n    e.preventDefault();\n    const {publisher} = this.props;\n    if (publisher && publisher.state && publisher.state.publisher) {\n      publisher.state.publisher.publishAudio(!this.state.publishing);\n      this.setState({\n        publishing: !this.state.publishing\n      });\n    }\n  }\n  \n\n  render() {\n    return (\n      <button style={this.props.style || {}} onClick={this.toggle} className={`btn btn-${this.state.publishing ? 'primary' : 'secondary'}`}><i className=\"fa fa-microphone\"></i></button>\n    )\n  }\n}\n\nclass PlayButton extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      paused: (props.player && props.player.paused) || true\n    }\n    props.player.addEventListener('play', () => {\n      this.setState({\n        paused: false\n      });\n    });\n\n    props.player.addEventListener('pause', () => {\n      this.setState({\n        paused: true\n      });\n    });\n  }\n\n  toggle = (e) => {\n    e.preventDefault();\n    setTimeout(() => {\n      if (state.audioTag.paused) {\n        fetch(`/api/sessions/${this.props.journey.room}/start`, {\n          cache: 'no-cache',\n          credentials: 'same-origin',\n          headers: {\n            'content-type': 'application/json'\n          },\n          method: 'POST',\n          mode: 'cors',\n        });\n      } else {\n        fetch(`/api/sessions/${this.props.journey.room}/pause`, {\n          cache: 'no-cache',\n          credentials: 'same-origin',\n          headers: {\n            'content-type': 'application/json'\n          },\n          method: 'POST',\n          mode: 'cors',\n        });\n      }\n    }, 20);\n  }\n\n  render() {\n    return (\n      <button style={this.props.style || {}} onClick={this.toggle} className={`btn btn-secondary`}>\n        <i className={`fa fa-${state.audioTag.paused ? 'play' : 'pause'}`}></i>\n      </button>\n    )\n  }\n}\n\nclass LeaveRoomButton extends Component {\n\n  onLeave = (e) => {\n    e.preventDefault();\n    if (!state.audioTag.paused) {\n      state.audioTag.pause();\n    }\n    this.props.history.push('/join');\n  }\n\n  render() {\n    return (\n      <button onClick={this.onLeave} className='btn btn-secondary'>Leave</button>\n    )\n  }\n}\n\nclass JourneyStartsIn extends Component {\n\n  constructor(props) {\n    super(props);\n    props.timer.on('tick', (current) => {\n      this.setState({\n        timerValue: current\n      });\n    });\n  }\n\n  componentWillReceiveProps(newProps) {\n    newProps.timer.on('tick', (current) => {\n      this.setState({\n        timerValue: current\n      });\n    });\n  }\n\n  componentWillUnmount() {\n    this.props.timer.clear();\n  }\n\n  render() {\n    const {journey} = this.props;\n    return (\n      <p className='journey-starts-in' style={{padding: '10px 10px 10px', display: 'flex', borderBottom: '1px solid rgb(88, 88, 88)'}}>\n        <span className='label'>Journey starts in:</span>\n        <span className='time' style={{marginLeft: 'auto'}}>{this.props.timer.displayTime()}</span>\n      </p>\n    )\n  }\n}\n\nclass SharePrompt extends Component {\n\n  render() {\n    return (\n      <div className='journeyspace-sharePrompt' style={{textAlign: 'center'}}>\n        <p style={{fontFamily: 'Playfair Display, serif', fontSize: '25px', lineHeight: 0.8}}>If you would like to invite a friend you can make this a permanent JourneySpace:</p>\n        <button className='btn btn-secondary' onClick={this.props.onInvite}>Invite Friends</button>\n      </div>\n    )\n  }\n}\n\nclass InviteModal extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      journeySpaceName: '',\n      error: false\n    }\n  }\n\n  onChange = (e) => {\n    this.setState({\n      journeySpaceName: e.target.value,\n      error: this.state.error && e.target.value != ''\n    });\n  }\n\n  onCopy = (e) => {\n    e.preventDefault();\n    if (this.state.journeySpaceName === '') {\n      this.setState({\n        error: 'please enter a name'\n      });\n    } else {\n      this.setState({\n        error: false\n      });\n      const name = this.state.journeySpaceName;\n      const urlFriendlyName = name.replace(/\\s+/g, '-').toLowerCase();\n      const url = `${window.location.protocol}//${window.location.host}/${urlFriendlyName}`;\n      const success = this._copy(url);\n      if (success) {\n        this.props.onComplete(url, name);\n      } else {\n        this.setState({\n          error: 'failed to copy url'\n        });\n      }\n    }\n  }\n\n  _copy(url) {\n    // A <span> contains the text to copy\n    const span = document.createElement('span');\n    span.textContent = url;\n    span.style.whiteSpace = 'pre'; // Preserve consecutive spaces and newlines\n\n    // Paint the span outside the viewport\n    span.style.position = 'absolute';\n    span.style.left = '-9999px';\n    span.style.top = '-9999px';\n\n    const win = window;\n    const selection = win.getSelection();\n    win.document.body.appendChild(span);\n\n    const range = win.document.createRange();\n    selection.removeAllRanges();\n    range.selectNode(span);\n    selection.addRange(range);\n\n    let success = false;\n    try {\n        success = win.document.execCommand('copy');\n    } catch (err) {}\n\n    selection.removeAllRanges();\n    span.remove();\n\n    return success;\n  }\n\n  render() {\n    return (\n      <div style={{width: '100%', height: '100%', position: 'absolute', top: 0, left: 0, right: 0, bottom: 0, backgroundColor: 'rgba(89, 153, 222, 0.9)'}} className='journeyspace-invite'>\n        <a href='#' onClick={this.props.onClose} style={{position: 'absolute', right: '20px', top: '20px'}}>\n          <i className='fa fa-times' style={{fontSize: '22px', color: 'white'}}/>\n        </a>\n        <div style={{textAlign: 'center', position: 'fixed', top: '50%', left: '50%', transform: 'translate(-50%, -50%)', padding: '0 20px', minWidth: '90%'}}>\n          <p style={{fontSize: '26px', lineHeight: 0.8, fontFamily: 'Playfair Display, serif', color: 'white'}}>Share your new permanent CuriousLive Space with Friends</p>\n          <input type='text' value={this.state.journeySpaceName} onChange={this.onChange} placeholder='Name Your Space'/>\n          {this.state.error && <p className='text-danger'>{this.state.error}</p>}\n          <p style={{margin: '10px 0 10px 0'}}>Share Using</p>\n          <ul style={{listStyle: 'none', margin: 0, padding: 0}}>\n            <li onClick={this.onCopy} style={{width: '90px', height: '90px', margin: '0 auto', cursor: 'pointer'}}>\n              <i className='fa fa-link' style={{display: 'flex', background: 'white', height: '70px', flexDirection: 'row', alignItems: 'center', justifyContent: 'center', fontSize: '38px'}}/>\n              <p>Copy Link</p>\n            </li>\n          </ul>\n        </div>\n      </div>\n    )\n  }\n}\n\nclass Intro extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      views: [\n        <div className='intro-screen'>\n          <h3>1. Welcome to CuriousLive&hellip; A five-minute guided journey &ndash; plus sharing &ndash; with others.</h3>\n          <p>\n            You are now in the JourneySpace and the\n            journey will begin shortly when the timer\n            above elapses and you hear the chime.\n          </p>\n          <p>\n            If more spots are available for this journey,\n            we invite you to invite a friend to two… use\n            the INVITE FRIENDS button.\n          </p>\n          <p>\n            Then we’ll mute your microphones and for\n            five minutes and you’ll hear your Journey\n            Guide taking you on the journey.\n          </p>\n          <p>\n            The goal is relaxation and joy, so settle in\n            by breathing slowly and deeply and adjust\n            your posture to be comfortable.\n          </p>\n        </div>,\n\n        <div className='intro-screen'>\n          <h3>2. Next comes the Journey&hellip;</h3>\n          <p>\n            The CuriousLive&trade; experience is\n            intentionally short so busy people can find\n            the time to do it regularly. That's when you\n            get the real benefits.\n          </p>\n          <p>\n            CuriousLive Journeys are captured Live\n            and Unplugged, never scripted. Your\n            Journey Guide will help you relax into the\n            JourneySpace and go deep into the Journey.\n          </p>\n          <p>\n            Your microphone will be automatically\n            muted.\n            <br/>\n            Some people like to leave their cameras on\n            during the journey to increase the feeling\n            of a shared experience. It is up to you.\n          </p>\n        </div>,\n\n        <div className='intro-screen'>\n          <h3>3. After the Journey comes the Sharing and Connecting.</h3>\n          <p>\n            Now you’ll have the opportunity to briefly\n            share with others your insights and\n            experience. Each person takes 1 or 2\n            minutes.\n          </p>\n          <p>\n            When you’re ready, click on the “Share”\n            button to start your Share. Go deep. Drop\n            in to your insights and intuitions and o!er\n            the others something special about your\n            experience.\n          </p>\n          <p>\n            And when others are sharing, please listen\n            deeply, and in turn they will listen more\n            deeply to you.\n          </p>\n        </div>,\n\n        <div className='intro-screen'>\n          <h3>4. How was your experience? We Love Feedback from Our Community.</h3>\n          <p>\n            We welcome your feedback about the\n            process and the Wacuri Method even\n            after the group experience. Please take\n            a moment to rate your experience and\n            give us your valuable feedback.\n          </p>\n        </div>\n      \n      ],\n      index: 0\n    }\n  }\n\n  goTo = (index) => {\n    this.setState({\n      index: index\n    });\n  }\n\n  onChangeIndex = (index, last, {reason}) => {\n    this.setState({\n      index: index\n    });\n  }\n\n  onSkip = (e) => {\n    e.preventDefault();\n    this.props.onClose();\n  }\n\n  componentDidMount() {\n    Cookie.set('saw intro', true, {expires: 365});\n  }\n\n  render() {\n    return (\n      <div className='intro' style={{minHeight: 'calc(100vh - 46px)', position: 'relative', display: 'flex', flexDirection: 'column', backgroundColor: 'rgb(81, 148, 220)', padding: '20px'}}>\n        {state.session &&\n          <div>\n            <div style={{display: 'flex', alignItems: 'baseline'}}>\n              <h2 style={{margin: 0}}>{state.session.name}</h2>\n              <div style={{marginLeft: 'auto', display: 'flex'}}>\n                <JourneyStartsIn journey={this.props.journey} timer={this.props.timer}/>\n              </div>\n            </div>\n            \n            <div style={{textAlign: 'center'}}>\n              <img style={{height: '150px'}} src={state.session.image}/>\n            </div>\n          </div>\n        }\n        \n        <SwipeableViews onChangeIndex={this.onChangeIndex} index={this.state.index} enableMouseEvents ref={swipeable => this.swipeable = swipeable}>\n          {this.state.views}\n        </SwipeableViews>\n        <ul className='dots' style={{alignSelf: 'center', listStyle: 'none', padding: 0, margin: 'auto 0 0 0', display: 'flex'}}>\n          {this.state.views.map((view, i) => (\n            <li style={{marginRight: '10px', cursor: 'pointer'}} onClick={() => this.goTo(i)} className={this.state.index === i ? 'active' : ''}><span className='dot'></span></li>\n          ))}\n        </ul>\n        <a href='#' className='intro-skip' onClick={this.onSkip}>{this.state.index === this.state.views.length - 1 ? 'Begin Journey!' : 'skip'}</a>\n      </div>\n    )\n      \n  }\n\n}\n\nclass JourneySpace extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      streams: [],\n      publisherId: '',\n      session: null,\n      playerState: 'waiting',\n      playerProgress: 0,\n      playerProgressMS: 0,\n      journeyDuration: 0,\n      currentlyActivePublisher: null,\n      showShareModal: false,\n      showIntro: true,\n    }\n    this.publisher = {};\n    this.audioTag = {};\n  }\n\n\tcomponentDidMount() {\n    state.audioTag.addEventListener('ended', (event) => {\n      if (!/sharing\\.mp3/.test(state.audioTag.src)) {\n        if (this.publisher && this.publisher.state && this.publisher.state.publisher) {\n          this.publisher.state.publisher.publishAudio(true);\n        }\n        this.setState({\n          playerState: 'ended'\n        });\n\n        fetch(`/api/journeys/${this.props.match.params.room}/completed`, {\n          cache: 'no-cache', // *default, no-cache, reload, force-cache, only-if-cached\n          credentials: 'same-origin', // include, same-origin, *omit\n          headers: {\n            'content-type': 'application/json'\n          },\n          method: 'POST', // *GET, POST, PUT, DELETE, etc.\n          mode: 'cors', // no-cors, cors, *same-origin\n          redirect: 'follow', // manual, *follow, error\n          referrer: 'no-referrer', // *client, no-referrer\n        });\n\n        state.audioTag.pause();\n        state.audioTag.currentTime = 0;\n        state.audioTag.src = '/sharing.mp3';\n        state.audioTag.play();\n      } else {\n        // sharing audio ended\n        if (this.publisher && this.publisher.state && this.publisher.state.publisher) {\n          this.publisher.state.publisher.publishAudio(true);\n        }\n      }\n    });\n\n\t\tfetch(`/api/sessions/${this.props.match.params.room}${window.location.search}`, {credentials: 'include'})\n\t\t\t.then(res => res.json())\n\t\t\t.then(json => {\n\t\t\t\tstate.session = json;\n\n        state.audioTag.src = state.session.journey;\n        state.audioTag.currentTime = 0;\n\n        this.sessionHelper = createSession({\n          apiKey: state.openTokKey,\n          sessionId: state.session.sessionId,\n          token: state.session.token,\n          onConnect: () => {\n            console.log('assigned connection to publisher', this.sessionHelper.session.connection);\n            setTimeout(this.refreshSession, 1000);\n          },\n          onStreamsUpdated: streams => {\n            console.log('Current subscriber streams:', streams);\n            this.setState({ streams });\n            if (!this.state.currentlyActivePublisher) {\n              this.setState({\n                currentlyActivePublisher: streams[0]\n              });\n            }\n          }\n        });\n        this.sessionHelper.session.on(\"connectionDestroyed\", (event) => {\n          const data = {\n            sessionId: this.sessionHelper.session.sessionId,\n            connection: {\n              id: event.connection.id\n            },\n            event: 'connectionDestroyed',\n          }\n          this.refreshSession();\n        });\n        this.sessionHelper.session.on(\"connectionCreated\", (event) => {\n          console.log('CREATED', event);\n          const data = {\n            sessionId: this.sessionHelper.session.sessionId,\n            connection: {\n              id: event.connection.id\n            },\n            event: 'connectionCreated',\n          }\n          this.refreshSession();\n        });\n        this.sessionHelper.session.on('signal', (event) => {\n          console.log(\"Signal sent from connection \", event);\n          this.refreshSession();\n        });\n\n        this.sessionHelper.session.on(\"signal:startJourney\", (event) => {\n          if (this.publisher && this.publisher.state && this.publisher.state.publisher) {\n            this.publisher.state.publisher.publishAudio(false);\n          }\n          const playPromise = state.audioTag.play();\n          if (playPromise !== undefined) {\n            playPromise\n            .then(() => {\n              console.log('audio promise resolve');\n            })\n            // Safety first!\n            .catch(e => {\n              console.error(e);\n            });\n          }\n          this.setState({\n            playerState: 'playing'\n          });\n        });\n\n        this.sessionHelper.session.on(\"signal:pauseJourney\", (event) => {\n          if (this.publisher && this.publisher.state && this.publisher.state.publisher) {\n            this.publisher.state.publisher.publishAudio(true);\n          }\n          state.audioTag.pause();\n          this.setState({\n            playerState: 'paused'\n          });\n        });\n\n        this.sessionHelper.session.on(\"signal:journeyUpdated\", (event) => {\n          const journey = JSON.parse(event.data);\n          state.session = journey;\n\n          if (state.session.state != 'completed') {\n            // if we are in completed state, then audio may be playing the sharing prompt\n            state.audioTag.src = state.session.journey;\n            state.audioTag.currentTime = 0;\n          }\n\n          if (state.session.state === 'started') {\n\n            if (this.publisher && this.publisher.state && this.publisher.state.publisher) {\n              this.publisher.state.publisher.publishAudio(false);\n            }\n            state.audioTag.play();\n            this.setState({\n              playerState: 'playing'\n            });\n          } else {\n            state.audioTag.pause();\n            this.setState({\n              playerState: 'paused'\n            });\n          }\n\n          if (state.session.state === 'completed') {\n            state.audioTag.src = '/sharing.mp3';\n            state.audioTag.play();\n          }\n        });\n        \n\n        this.sessionHelper.session.on(\"signal:fail\", (event) => {\n          state.session.state = 'failed';\n        });\n\n\n        this.setState({\n          session: this.sessionHelper.session\n        });\n\n        const onAudioCanPlay = (event) => { \n          if (state.session.state === 'started') {\n            state.audioTag.play();\n            if (!isNaN(state.session.currentTime)) {\n              state.audioTag.currentTime = state.session.currentTime;\n            }\n          }\n          state.audioTag.removeEventListener('canplaythrough', onAudioCanPlay);\n        }\n\n        state.audioTag.addEventListener('canplaythrough', onAudioCanPlay, false);\n        state.audioTag.load();\n\t\t\t});\n    fetch('/api/journeys')\n      .then(res => res.json())\n      .then(json => {\n        state.journeys = json;\n      });\n\t}\n\n  componentWillUnmount() {\n    if (this.sessionHelper) {\n      this.sessionHelper.disconnect();\n    }\n  }\n\n  refreshSession = () => {\n\t\tfetch(`/api/sessions/${this.props.match.params.room}`, {credentials: 'include'})\n\t\t\t.then(res => res.json())\n\t\t\t.then(json => {\n\t\t\t\tstate.session = json;\n      });\n  }\n\n  get timeRemaining() {\n    const seconds = this.state.journeyDuration - this.state.playerProgressMS;\n    const minutes = Math.floor(seconds / 60);\n    const remainingSeconds = (seconds % 60).toFixed(0);\n    return minutes + \":\" + (remainingSeconds < 10 ? '0' : '') + remainingSeconds;\n  }\n\n  get isHostUser() {\n    const currentParticipant = this.state.session && this.state.session.connection && state.session && state.session.participants.find(participant => participant.connectionId === this.state.session.connection.id);\n    return currentParticipant && state.session.participants.indexOf(currentParticipant) === 0\n  }\n\n  get journeyStateTimer() {\n    switch(state.session.state) {\n      case 'started':\n      case 'paused':\n        return new AudioPlayTickEmitter(state.audioTag);\n      default:\n        if (!this.secondsEmitter) {\n          this.secondsEmitter = new SecondsTimerEmitter(new Date(state.session.createdAt), new Date(state.session.startAt));\n        }\n        return this.secondsEmitter;\n    }\n  }\n\n  onInitPublisher = () => {\n    console.log('initialized publisher');\n  }\n\n  onConfirmReady = (e) => {\n    fetch(`/api/sessions/${this.props.match.params.room}/connections/${this.sessionHelper.session.connection.id}/ready`);\n  }\n\n  onChangeJourney = (e) => {\n    fetch(`/api/sessions/${this.props.match.params.room}/journey`, {\n      body: JSON.stringify({journey: e.target.value}), // must match 'Content-Type' header\n      cache: 'no-cache', // *default, no-cache, reload, force-cache, only-if-cached\n      credentials: 'same-origin', // include, same-origin, *omit\n      headers: {\n        'content-type': 'application/json'\n      },\n      method: 'PUT', // *GET, POST, PUT, DELETE, etc.\n      mode: 'cors', // no-cors, cors, *same-origin\n      redirect: 'follow', // manual, *follow, error\n      referrer: 'no-referrer', // *client, no-referrer\n    });\n  }\n\n  onStartSession = (e) => {\n    fetch(`/api/sessions/${this.props.match.params.room}/start`, {\n      cache: 'no-cache',\n      credentials: 'same-origin',\n      headers: {\n        'content-type': 'application/json'\n      },\n      method: 'POST',\n      mode: 'cors',\n    });\n  }\n\n  onLoadedMetadata = (e) => {\n    this.setState({\n      journeyDuration: e.target.duration\n    });\n    state.audioTag.removeEventListener('timeupdate', this.onTimeUpdate);\n    state.audioTag.addEventListener('timeupdate', this.onTimeUpdate);\n  }\n\n  onTimeUpdate = (e) => {\n    this.setState({\n      playerProgress: (e.target.currentTime / e.target.duration) * 100,\n      playerProgressMS: e.target.currentTime,\n    });\n    if (this.isHostUser) {\n      fetch(`/api/journeys/${this.props.match.params.room}/progress`, {\n        body: JSON.stringify({currentTime: e.target.currentTime}),\n        cache: 'no-cache',\n        credentials: 'same-origin',\n        headers: {\n          'content-type': 'application/json'\n        },\n        method: 'PUT',\n        mode: 'cors',\n      });\n    }\n  }\n\n  onFlag = (e) => {\n    e.preventDefault();\n    fetch(`/api/sessions/${this.props.match.params.room}/flag`, {\n      cache: 'no-cache',\n      body: JSON.stringify({connectionId: this.state.session.connection.id}),\n      credentials: 'same-origin',\n      headers: {\n        'content-type': 'application/json'\n      },\n      method: 'POST',\n      mode: 'cors',\n    })\n      .then(res => res.json())\n      .then(json => state.session = json);\n  }\n\n  onShare = (e) => {\n    navigator.share({\n      title: 'Take a Journey With Me!',\n      text: `Join me on ${state.session.name}`,\n      url: `${window.location.protocol}//${window.location.host}/${state.session.room}`,\n    });\n  }\n\n  onInvite = (e) => {\n    e.preventDefault();\n    this.setState({\n      showShareModal: true\n    });\n  }\n\n  onCloseShareModal = (e) => {\n    e.preventDefault();\n    this.setState({\n      showShareModal: false\n    });\n  }\n\n  onCompleteShare = (url, name) => {\n    this.setState({\n      showShareModal: false\n    });\n    window.location = url + `?journey=${state.session.name}&name=${name}`;\n  }\n\n\trender() {\n    const currentParticipant = this.state.session && this.state.session.connection && state.session && state.session.participants.find(participant => participant.connectionId === this.state.session.connection.id);\n    let currentUserHasFlaggedJourney = state.session && state.session.flags.map(flag => flag.user).indexOf(state.sessionId) > -1;\n\t\treturn (\n\t\t\t<div className='journeyspace' style={{position: 'relative'}}>\n\n          <div className='journeyspace-content'>\n            {this.state.session &&\n              <div className='row no-gutters'>\n                <div className='col-5 col-lg-3'>\n                  <ul className='journeyspace-streams' style={{margin: 0}}>\n                    <li>\n                      <img style={{width: '100%'}} src={state.session.image}/>\n                      <h2 style={{flex: 5}} className='journeyspace-title'>{state.session.name}</h2>\n\n                    </li>\n                    <li className='journeyspace-stream journeyspace-me'>\n                        <OTPublisher \n                          properties={{width: '100%', height: '100%'}}\n                          session={this.sessionHelper.session}\n                          onInit={this.onInitPublisher}\n                          ref={publisher => {this.publisher = publisher}}\n                        />\n                    </li>\n\n                    {this.state.streams.map(stream => {\n                      const participant = state.session.participants.find(participant => participant.connectionId === stream.connection.id);\n                      return (\n                        <li className={`journeyspace-stream ${this.state.currentlyActivePublisher ? 'journeyspace-active-stream' : ''}`}>\n                            <OTSubscriber\n                              key={stream.id}\n                              session={this.sessionHelper.session}\n                              stream={stream}\n                              properties={{\n                                width: '100%',\n                                height: '100%',\n                              }}\n                            />\n                        </li>\n                      );\n                    })}\n                    \n                    {Array(2 - this.state.streams.length).fill({}).map(empty => (\n                      <li className='video-placeholder'>\n                        <div>\n                          <i className='fa fa-user'></i>\n                          <p>waiting...</p>\n                        </div>\n                      </li>\n                    ))}\n                  </ul>\n                </div>\n                <div className='col-7 col-lg-9' style={{backgroundColor: 'white'}}>\n                  \n                  {state.session.state === 'joined' && <JourneyStartsIn journey={state.session} timer={this.journeyStateTimer}/> }\n\n                  {!state.session.startAt && (state.session.state === 'created' || state.session.state === 'joined' || state.session.state === 'completed') &&\n                    <div style={{padding: '10px'}}>\n                      <select style={{width: '100%'}} onChange={this.onChangeJourney} value={state.session && state.session.journey}>\n                        {state.journeys.map(journey => (\n                          <option value={journey.filePath}>{journey.name}</option>\n                        ))}\n                      </select>\n                    </div>\n                  }\n                  \n                  <div style={{display: 'flex', padding: '10px 10px 0'}}>\n                    {(!state.session.startAt || ['started', 'paused'].indexOf(state.session.state) > -1) &&\n                      <PlayButton journey={state.session} player={state.audioTag}/>\n                    }\n                    { false &&\n                      <SkipButton style={{marginLeft: 'auto'}} journey={state.session}/>\n                    }\n                  </div>\n                  <div style={{display: 'flex', padding: '10px 10px 0 10px'}}>\n                    <VideoButton publisher={this.publisher}/>\n                    <AudioButton style={{marginLeft: '10px'}} publisher={this.publisher}/>\n                  </div>\n                  <div style={{padding: '10px'}}>\n                    <LeaveRoomButton history={this.props.history}/>\n                  </div>\n                  <JourneyTimeline journey={state.session} timer={this.journeyStateTimer}/>\n\n                  <div className='journeyspace-meta pr-3 pl-3 pt-3'>\n                    {state.session.startAt && ['joined', 'created'].indexOf(state.session.state) > -1 && <SharePrompt onInvite={this.onInvite}/>}\n                  </div>\n                  \n                  {state.session.state === 'failed' &&\n                      <p className='p-3'>Nobody else has joined this Journey Space. \n                        You can either <a href='#' onClick={this.onStartSession}>hit play</a> and take the Journey by\n                        yourself of return to the <Link to='/join'>JourneyBoard</Link> to find another Journey Space\n                      </p>\n                  }\n\n                </div>\n              </div>\n            }\n          \n          </div>\n          <div className='journeyspace-footer' style={{display: 'flex'}}>\n            <div style={{flex: 1}}>\n              <FlagControl currentUserHasFlaggedJourney={currentUserHasFlaggedJourney} onFlag={this.onFlag}>\n                {currentUserHasFlaggedJourney ? \"Reported\" : \"Report\"}\n              </FlagControl>\n            </div>\n            <div style={{marginLeft: 'auto', marginRight: '10px', alignSelf: 'center'}}>\n            </div>\n          </div>\n          {this.state.showShareModal &&\n            <InviteModal journey={this.state.session} onComplete={this.onCompleteShare} onClose={this.onCloseShareModal}/>\n          }\n\t\t\t</div>\n\t\t)\n\t}\n}\n\nclass IntroWrapper extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      showIntro: !Cookie.get('saw intro')\n    }\n  }\n\n  componentDidMount() {\n\t\tfetch(`/api/sessions/${this.props.match.params.room}${window.location.search}`, {credentials: 'include'})\n\t\t\t.then(res => res.json())\n\t\t\t.then(json => {\n\t\t\t\tstate.session = json;\n      });\n  }\n\n  onClose = () => {\n    this.setState({\n      showIntro: false\n    });\n  }\n\n  render() {\n    if (state.session) {\n      if (this.state.showIntro) {\n        return <Intro onClose={this.onClose} journey={state.session} timer={new SecondsTimerEmitter(new Date(state.session.createdAt), new Date(state.session.startAt))}/>\n      } else {\n        return <JourneySpace {...this.props}/>\n      }\n    } else {\n      return <p>Loading...</p>\n    }\n  }\n}\n\nexport default view(IntroWrapper);\n\n\n\n// WEBPACK FOOTER //\n// ../client/src/components/Room.js","module.exports = require(\"js-cookie\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"js-cookie\"\n// module id = 97\n// module chunks = 0","module.exports = require(\"react-swipeable-views\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"react-swipeable-views\"\n// module id = 98\n// module chunks = 0","/*!\n * Signature Pad v3.0.0-beta.2 | https://github.com/szimek/signature_pad\n * (c) 2018 Szymon Nowak | Released under the MIT license\n */\n\n(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n  typeof define === 'function' && define.amd ? define(factory) :\n  (global.SignaturePad = factory());\n}(this, (function () { 'use strict';\n\n  var Point = (function () {\n      function Point(x, y, time) {\n          this.x = x;\n          this.y = y;\n          this.time = time || Date.now();\n      }\n      Point.prototype.distanceTo = function (start) {\n          return Math.sqrt(Math.pow(this.x - start.x, 2) + Math.pow(this.y - start.y, 2));\n      };\n      Point.prototype.equals = function (other) {\n          return this.x === other.x && this.y === other.y && this.time === other.time;\n      };\n      Point.prototype.velocityFrom = function (start) {\n          return (this.time !== start.time) ? this.distanceTo(start) / (this.time - start.time) : 0;\n      };\n      return Point;\n  }());\n\n  var Bezier = (function () {\n      function Bezier(startPoint, control2, control1, endPoint, startWidth, endWidth) {\n          this.startPoint = startPoint;\n          this.control2 = control2;\n          this.control1 = control1;\n          this.endPoint = endPoint;\n          this.startWidth = startWidth;\n          this.endWidth = endWidth;\n      }\n      Bezier.fromPoints = function (points, widths) {\n          var c2 = this.calculateControlPoints(points[0], points[1], points[2]).c2;\n          var c3 = this.calculateControlPoints(points[1], points[2], points[3]).c1;\n          return new Bezier(points[1], c2, c3, points[2], widths.start, widths.end);\n      };\n      Bezier.calculateControlPoints = function (s1, s2, s3) {\n          var dx1 = s1.x - s2.x;\n          var dy1 = s1.y - s2.y;\n          var dx2 = s2.x - s3.x;\n          var dy2 = s2.y - s3.y;\n          var m1 = { x: (s1.x + s2.x) / 2.0, y: (s1.y + s2.y) / 2.0 };\n          var m2 = { x: (s2.x + s3.x) / 2.0, y: (s2.y + s3.y) / 2.0 };\n          var l1 = Math.sqrt((dx1 * dx1) + (dy1 * dy1));\n          var l2 = Math.sqrt((dx2 * dx2) + (dy2 * dy2));\n          var dxm = (m1.x - m2.x);\n          var dym = (m1.y - m2.y);\n          var k = l2 / (l1 + l2);\n          var cm = { x: m2.x + (dxm * k), y: m2.y + (dym * k) };\n          var tx = s2.x - cm.x;\n          var ty = s2.y - cm.y;\n          return {\n              c1: new Point(m1.x + tx, m1.y + ty),\n              c2: new Point(m2.x + tx, m2.y + ty)\n          };\n      };\n      Bezier.prototype.length = function () {\n          var steps = 10;\n          var length = 0;\n          var px;\n          var py;\n          for (var i = 0; i <= steps; i += 1) {\n              var t = i / steps;\n              var cx = this.point(t, this.startPoint.x, this.control1.x, this.control2.x, this.endPoint.x);\n              var cy = this.point(t, this.startPoint.y, this.control1.y, this.control2.y, this.endPoint.y);\n              if (i > 0) {\n                  var xdiff = cx - px;\n                  var ydiff = cy - py;\n                  length += Math.sqrt((xdiff * xdiff) + (ydiff * ydiff));\n              }\n              px = cx;\n              py = cy;\n          }\n          return length;\n      };\n      Bezier.prototype.point = function (t, start, c1, c2, end) {\n          return (start * (1.0 - t) * (1.0 - t) * (1.0 - t))\n              + (3.0 * c1 * (1.0 - t) * (1.0 - t) * t)\n              + (3.0 * c2 * (1.0 - t) * t * t)\n              + (end * t * t * t);\n      };\n      return Bezier;\n  }());\n\n  function throttle(fn, wait) {\n      if (wait === void 0) { wait = 250; }\n      var previous = 0;\n      var timeout = null;\n      var result;\n      var storedContext;\n      var storedArgs;\n      var later = function () {\n          previous = Date.now();\n          timeout = null;\n          result = fn.apply(storedContext, storedArgs);\n          if (!timeout) {\n              storedContext = null;\n              storedArgs = [];\n          }\n      };\n      return function () {\n          var args = [];\n          for (var _i = 0; _i < arguments.length; _i++) {\n              args[_i] = arguments[_i];\n          }\n          var now = Date.now();\n          var remaining = wait - (now - previous);\n          storedContext = this;\n          storedArgs = args;\n          if (remaining <= 0 || remaining > wait) {\n              if (timeout) {\n                  clearTimeout(timeout);\n                  timeout = null;\n              }\n              previous = now;\n              result = fn.apply(storedContext, storedArgs);\n              if (!timeout) {\n                  storedContext = null;\n                  storedArgs = [];\n              }\n          }\n          else if (!timeout) {\n              timeout = setTimeout(later, remaining);\n          }\n          return result;\n      };\n  }\n\n  var SignaturePad = (function () {\n      function SignaturePad(canvas, options) {\n          if (options === void 0) { options = {}; }\n          var _this = this;\n          this.canvas = canvas;\n          this.options = options;\n          this._handleMouseDown = function (event) {\n              if (event.which === 1) {\n                  _this._mouseButtonDown = true;\n                  _this._strokeBegin(event);\n              }\n          };\n          this._handleMouseMove = function (event) {\n              if (_this._mouseButtonDown) {\n                  _this._strokeMoveUpdate(event);\n              }\n          };\n          this._handleMouseUp = function (event) {\n              if (event.which === 1 && _this._mouseButtonDown) {\n                  _this._mouseButtonDown = false;\n                  _this._strokeEnd(event);\n              }\n          };\n          this._handleTouchStart = function (event) {\n              event.preventDefault();\n              if (event.targetTouches.length === 1) {\n                  var touch = event.changedTouches[0];\n                  _this._strokeBegin(touch);\n              }\n          };\n          this._handleTouchMove = function (event) {\n              event.preventDefault();\n              var touch = event.targetTouches[0];\n              _this._strokeMoveUpdate(touch);\n          };\n          this._handleTouchEnd = function (event) {\n              var wasCanvasTouched = event.target === _this.canvas;\n              if (wasCanvasTouched) {\n                  event.preventDefault();\n                  var touch = event.changedTouches[0];\n                  _this._strokeEnd(touch);\n              }\n          };\n          this.velocityFilterWeight = options.velocityFilterWeight || 0.7;\n          this.minWidth = options.minWidth || 0.5;\n          this.maxWidth = options.maxWidth || 2.5;\n          this.throttle = (\"throttle\" in options ? options.throttle : 16);\n          this.minDistance = (\"minDistance\" in options ? options.minDistance : 5);\n          if (this.throttle) {\n              this._strokeMoveUpdate = throttle(SignaturePad.prototype._strokeUpdate, this.throttle);\n          }\n          else {\n              this._strokeMoveUpdate = SignaturePad.prototype._strokeUpdate;\n          }\n          this.dotSize = options.dotSize || function () {\n              return (this.minWidth + this.maxWidth) / 2;\n          };\n          this.penColor = options.penColor || \"black\";\n          this.backgroundColor = options.backgroundColor || \"rgba(0,0,0,0)\";\n          this.onBegin = options.onBegin;\n          this.onEnd = options.onEnd;\n          this._ctx = canvas.getContext(\"2d\");\n          this.clear();\n          this.on();\n      }\n      SignaturePad.prototype.clear = function () {\n          var ctx = this._ctx;\n          var canvas = this.canvas;\n          ctx.fillStyle = this.backgroundColor;\n          ctx.clearRect(0, 0, canvas.width, canvas.height);\n          ctx.fillRect(0, 0, canvas.width, canvas.height);\n          this._data = [];\n          this._reset();\n          this._isEmpty = true;\n      };\n      SignaturePad.prototype.fromDataURL = function (dataUrl, options, callback) {\n          var _this = this;\n          if (options === void 0) { options = {}; }\n          var image = new Image();\n          var ratio = options.ratio || window.devicePixelRatio || 1;\n          var width = options.width || (this.canvas.width / ratio);\n          var height = options.height || (this.canvas.height / ratio);\n          this._reset();\n          image.onload = function () {\n              _this._ctx.drawImage(image, 0, 0, width, height);\n              if (callback) {\n                  callback();\n              }\n          };\n          image.onerror = function (error) {\n              if (callback) {\n                  callback(error);\n              }\n          };\n          image.src = dataUrl;\n          this._isEmpty = false;\n      };\n      SignaturePad.prototype.toDataURL = function (type, encoderOptions) {\n          if (type === void 0) { type = \"image/png\"; }\n          switch (type) {\n              case \"image/svg+xml\":\n                  return this._toSVG();\n              default:\n                  return this.canvas.toDataURL(type, encoderOptions);\n          }\n      };\n      SignaturePad.prototype.on = function () {\n          this._handleMouseEvents();\n          if (\"ontouchstart\" in window) {\n              this._handleTouchEvents();\n          }\n      };\n      SignaturePad.prototype.off = function () {\n          this.canvas.style.msTouchAction = \"auto\";\n          this.canvas.style.touchAction = \"auto\";\n          this.canvas.removeEventListener(\"mousedown\", this._handleMouseDown);\n          this.canvas.removeEventListener(\"mousemove\", this._handleMouseMove);\n          document.removeEventListener(\"mouseup\", this._handleMouseUp);\n          this.canvas.removeEventListener(\"touchstart\", this._handleTouchStart);\n          this.canvas.removeEventListener(\"touchmove\", this._handleTouchMove);\n          this.canvas.removeEventListener(\"touchend\", this._handleTouchEnd);\n      };\n      SignaturePad.prototype.isEmpty = function () {\n          return this._isEmpty;\n      };\n      SignaturePad.prototype.fromData = function (pointGroups) {\n          var _this = this;\n          this.clear();\n          this._fromData(pointGroups, function (_a) {\n              var color = _a.color, curve = _a.curve;\n              return _this._drawCurve({ color: color, curve: curve });\n          }, function (_a) {\n              var color = _a.color, point = _a.point;\n              return _this._drawDot({ color: color, point: point });\n          });\n          this._data = pointGroups;\n      };\n      SignaturePad.prototype.toData = function () {\n          return this._data;\n      };\n      SignaturePad.prototype._strokeBegin = function (event) {\n          var newPointGroup = {\n              color: this.penColor,\n              points: []\n          };\n          this._data.push(newPointGroup);\n          this._reset();\n          this._strokeUpdate(event);\n          if (typeof this.onBegin === \"function\") {\n              this.onBegin(event);\n          }\n      };\n      SignaturePad.prototype._strokeUpdate = function (event) {\n          var x = event.clientX;\n          var y = event.clientY;\n          var point = this._createPoint(x, y);\n          var lastPointGroup = this._data[this._data.length - 1];\n          var lastPoints = lastPointGroup.points;\n          var lastPoint = lastPoints.length > 0 && lastPoints[lastPoints.length - 1];\n          var isLastPointTooClose = lastPoint ? point.distanceTo(lastPoint) <= this.minDistance : false;\n          var color = lastPointGroup.color;\n          if (!lastPoint || !(lastPoint && isLastPointTooClose)) {\n              var curve = this._addPoint(point);\n              if (!lastPoint) {\n                  this._drawDot({ color: color, point: point });\n              }\n              else if (curve) {\n                  this._drawCurve({ color: color, curve: curve });\n              }\n              lastPoints.push({\n                  time: point.time,\n                  x: point.x,\n                  y: point.y\n              });\n          }\n      };\n      SignaturePad.prototype._strokeEnd = function (event) {\n          this._strokeUpdate(event);\n          if (typeof this.onEnd === \"function\") {\n              this.onEnd(event);\n          }\n      };\n      SignaturePad.prototype._handleMouseEvents = function () {\n          this._mouseButtonDown = false;\n          this.canvas.addEventListener(\"mousedown\", this._handleMouseDown);\n          this.canvas.addEventListener(\"mousemove\", this._handleMouseMove);\n          document.addEventListener(\"mouseup\", this._handleMouseUp);\n      };\n      SignaturePad.prototype._handleTouchEvents = function () {\n          this.canvas.style.msTouchAction = \"none\";\n          this.canvas.style.touchAction = \"none\";\n          this.canvas.addEventListener(\"touchstart\", this._handleTouchStart);\n          this.canvas.addEventListener(\"touchmove\", this._handleTouchMove);\n          this.canvas.addEventListener(\"touchend\", this._handleTouchEnd);\n      };\n      SignaturePad.prototype._reset = function () {\n          this._points = [];\n          this._lastVelocity = 0;\n          this._lastWidth = (this.minWidth + this.maxWidth) / 2;\n          this._ctx.fillStyle = this.penColor;\n      };\n      SignaturePad.prototype._createPoint = function (x, y) {\n          var rect = this.canvas.getBoundingClientRect();\n          return new Point(x - rect.left, y - rect.top, new Date().getTime());\n      };\n      SignaturePad.prototype._addPoint = function (point) {\n          var _points = this._points;\n          _points.push(point);\n          if (_points.length > 2) {\n              if (_points.length === 3) {\n                  _points.unshift(_points[0]);\n              }\n              var widths = this._calculateCurveWidths(_points[1], _points[2]);\n              var curve = Bezier.fromPoints(_points, widths);\n              _points.shift();\n              return curve;\n          }\n          return null;\n      };\n      SignaturePad.prototype._calculateCurveWidths = function (startPoint, endPoint) {\n          var velocity = (this.velocityFilterWeight * endPoint.velocityFrom(startPoint))\n              + ((1 - this.velocityFilterWeight) * this._lastVelocity);\n          var newWidth = this._strokeWidth(velocity);\n          var widths = {\n              end: newWidth,\n              start: this._lastWidth\n          };\n          this._lastVelocity = velocity;\n          this._lastWidth = newWidth;\n          return widths;\n      };\n      SignaturePad.prototype._strokeWidth = function (velocity) {\n          return Math.max(this.maxWidth / (velocity + 1), this.minWidth);\n      };\n      SignaturePad.prototype._drawCurveSegment = function (x, y, width) {\n          var ctx = this._ctx;\n          ctx.moveTo(x, y);\n          ctx.arc(x, y, width, 0, 2 * Math.PI, false);\n          this._isEmpty = false;\n      };\n      SignaturePad.prototype._drawCurve = function (_a) {\n          var color = _a.color, curve = _a.curve;\n          var ctx = this._ctx;\n          var widthDelta = curve.endWidth - curve.startWidth;\n          var drawSteps = Math.floor(curve.length()) * 2;\n          ctx.beginPath();\n          ctx.fillStyle = color;\n          for (var i = 0; i < drawSteps; i += 1) {\n              var t = i / drawSteps;\n              var tt = t * t;\n              var ttt = tt * t;\n              var u = 1 - t;\n              var uu = u * u;\n              var uuu = uu * u;\n              var x = uuu * curve.startPoint.x;\n              x += 3 * uu * t * curve.control1.x;\n              x += 3 * u * tt * curve.control2.x;\n              x += ttt * curve.endPoint.x;\n              var y = uuu * curve.startPoint.y;\n              y += 3 * uu * t * curve.control1.y;\n              y += 3 * u * tt * curve.control2.y;\n              y += ttt * curve.endPoint.y;\n              var width = curve.startWidth + (ttt * widthDelta);\n              this._drawCurveSegment(x, y, width);\n          }\n          ctx.closePath();\n          ctx.fill();\n      };\n      SignaturePad.prototype._drawDot = function (_a) {\n          var color = _a.color, point = _a.point;\n          var ctx = this._ctx;\n          var width = typeof this.dotSize === \"function\" ? this.dotSize() : this.dotSize;\n          ctx.beginPath();\n          this._drawCurveSegment(point.x, point.y, width);\n          ctx.closePath();\n          ctx.fillStyle = color;\n          ctx.fill();\n      };\n      SignaturePad.prototype._fromData = function (pointGroups, drawCurve, drawDot) {\n          for (var _i = 0, pointGroups_1 = pointGroups; _i < pointGroups_1.length; _i++) {\n              var group = pointGroups_1[_i];\n              var color = group.color, points = group.points;\n              if (points.length > 1) {\n                  for (var j = 0; j < points.length; j += 1) {\n                      var basicPoint = points[j];\n                      var point = new Point(basicPoint.x, basicPoint.y, basicPoint.time);\n                      this.penColor = color;\n                      if (j === 0) {\n                          this._reset();\n                      }\n                      var curve = this._addPoint(point);\n                      if (curve) {\n                          drawCurve({ color: color, curve: curve });\n                      }\n                  }\n              }\n              else {\n                  this._reset();\n                  drawDot({\n                      color: color,\n                      point: points[0]\n                  });\n              }\n          }\n      };\n      SignaturePad.prototype._toSVG = function () {\n          var _this = this;\n          var pointGroups = this._data;\n          var ratio = Math.max(window.devicePixelRatio || 1, 1);\n          var minX = 0;\n          var minY = 0;\n          var maxX = this.canvas.width / ratio;\n          var maxY = this.canvas.height / ratio;\n          var svg = document.createElementNS(\"http://www.w3.org/2000/svg\", \"svg\");\n          svg.setAttribute(\"width\", this.canvas.width.toString());\n          svg.setAttribute(\"height\", this.canvas.height.toString());\n          this._fromData(pointGroups, function (_a) {\n              var color = _a.color, curve = _a.curve;\n              var path = document.createElement(\"path\");\n              if (!isNaN(curve.control1.x) &&\n                  !isNaN(curve.control1.y) &&\n                  !isNaN(curve.control2.x) &&\n                  !isNaN(curve.control2.y)) {\n                  var attr = \"M \" + curve.startPoint.x.toFixed(3) + \",\" + curve.startPoint.y.toFixed(3) + \" \"\n                      + (\"C \" + curve.control1.x.toFixed(3) + \",\" + curve.control1.y.toFixed(3) + \" \")\n                      + (curve.control2.x.toFixed(3) + \",\" + curve.control2.y.toFixed(3) + \" \")\n                      + (curve.endPoint.x.toFixed(3) + \",\" + curve.endPoint.y.toFixed(3));\n                  path.setAttribute(\"d\", attr);\n                  path.setAttribute(\"stroke-width\", (curve.endWidth * 2.25).toFixed(3));\n                  path.setAttribute(\"stroke\", color);\n                  path.setAttribute(\"fill\", \"none\");\n                  path.setAttribute(\"stroke-linecap\", \"round\");\n                  svg.appendChild(path);\n              }\n          }, function (_a) {\n              var color = _a.color, point = _a.point;\n              var circle = document.createElement(\"circle\");\n              var dotSize = typeof _this.dotSize === \"function\" ? _this.dotSize() : _this.dotSize;\n              circle.setAttribute(\"r\", dotSize.toString());\n              circle.setAttribute(\"cx\", point.x.toString());\n              circle.setAttribute(\"cy\", point.y.toString());\n              circle.setAttribute(\"fill\", color);\n              svg.appendChild(circle);\n          });\n          var prefix = \"data:image/svg+xml;base64,\";\n          var header = \"<svg\"\n              + \" xmlns=\\\"http://www.w3.org/2000/svg\\\"\"\n              + \" xmlns:xlink=\\\"http://www.w3.org/1999/xlink\\\"\"\n              + (\" viewBox=\\\"\" + minX + \" \" + minY + \" \" + maxX + \" \" + maxY + \"\\\"\")\n              + (\" width=\\\"\" + maxX + \"\\\"\")\n              + (\" height=\\\"\" + maxY + \"\\\"\")\n              + \">\";\n          var body = svg.innerHTML;\n          if (body === undefined) {\n              var dummy = document.createElement(\"dummy\");\n              var nodes = svg.childNodes;\n              dummy.innerHTML = \"\";\n              for (var i = 0; i < nodes.length; i += 1) {\n                  dummy.appendChild(nodes[i].cloneNode(true));\n              }\n              body = dummy.innerHTML;\n          }\n          var footer = \"</svg>\";\n          var data = header + body + footer;\n          return prefix + btoa(data);\n      };\n      return SignaturePad;\n  }());\n\n  return SignaturePad;\n\n})));\n\n\n\n// WEBPACK FOOTER //\n// ../client/src/components/signature_pad.js","module.exports = require(\"uuid\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"uuid\"\n// module id = 100\n// module chunks = 0","module.exports = require(\"opentok-layout-js\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"opentok-layout-js\"\n// module id = 101\n// module chunks = 0","if (__CLIENT__) {\n  navigator.share = navigator.share || (function(){\n      if (navigator.share) {\n          return navigator.share;\n      }\n\n    let android = navigator.userAgent.match(/Android/i);\n      let ios = navigator.userAgent.match(/iPhone|iPad|iPod/i);\n    let isDesktop = !(ios || android); // on those two support \"mobile deep links\", so HTTP based fallback for all others.\n\n    // sms on ios 'sms:;body='+payload, on Android 'sms:?body='+payload\n    let shareUrls = {\n        whatsapp: payload => (isDesktop ? 'https://api.whatsapp.com/send?text=' : 'whatsapp://send?text=') + payload,\n        telegram: payload => (isDesktop ? 'https://telegram.me/share/msg?url='+location.host+'&text=' : 'tg://msg?text=') + payload,\n        facebook: (payload, fbid, url) => `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(url)}`,\n        email:    (payload, title) => 'mailto:?subject='+title+'&body='+payload,\n      sms:      payload => 'sms:/&body='+payload\n    };\n\n    class WebShareUI{\n      /*async*/\n      _init(){\n        if(this._initialized) return Promise.resolve();\n        this._initialized = true;\n\n        const template = `\n        <div class=\"web-share\" style=\"display: none\">\n          <div class=\"web-share-container web-share-grid\">\n              <div class=\"web-share-title\">SHARE VIA</div>\n            <a target='_blank' class=\"web-share-item web-share-facebook\">\n                  <div class=\"fa fa-facebook-official fa-3x\"></div>\n                  <div class=\"web-share-item-desc\">Facebook</div>\n              </a>\n              <a class=\"web-share-item web-share-email\">\n              <div class=\"fa fa-envelope fa-3x\"></div>\n              <div class=\"web-share-item-desc\">Email</div>\n            </a>\n              <a class=\"web-share-item web-share-sms\">\n              <div class=\"fa fa-commenting fa-3x\"></div>\n              <div class=\"web-share-item-desc\">SMS</div>\n            </a>\n            <a class=\"web-share-item web-share-copy\">\n                  <div class=\"fa fa-clone fa-3x\"></div>\n                  <div class=\"web-share-item-desc\">Copy</div>\n              </a>\n          </div>\n          <div class=\"web-share-container web-share-cancel\">Cancel</div>\n        </div>\n        `;\n\n        const el = document.createElement('div');\n        el.innerHTML = template;\n\n        this.$root     = el.querySelector('.web-share');\n        this.$whatsapp = el.querySelector('.web-share-whatsapp');\n        this.$facebook = el.querySelector('.web-share-facebook');\n        this.$telegram = el.querySelector('.web-share-telegram');\n        this.$email    = el.querySelector('.web-share-email');\n        this.$sms      = el.querySelector('.web-share-sms');\n        this.$copy     = el.querySelector('.web-share-copy');\n        this.$copy.onclick = () => this._copy();\n        this.$root.onclick = () => this._hide();\n        this.$root.classList.toggle('desktop', isDesktop);\n\n        document.body.appendChild(el);\n      }\n\n      _setPayload(payloadObj){\n        let payload = payloadObj.text + ' ' + payloadObj.url;\n        let title = payloadObj.title;\n        let facebookId = payloadObj.facebookId || '158651941570418';\n          this.url = payloadObj.url;\n        payload = encodeURIComponent(payload);\n        title = encodeURIComponent(title);\n        this.$whatsapp && (this.$whatsapp.href = shareUrls.whatsapp(payload));\n        this.$facebook.href = shareUrls.facebook(payload, facebookId, payloadObj.url);\n        this.$telegram && (this.$telegram.href = shareUrls.telegram(payload));\n        this.$email.href = shareUrls.email(payload, title);\n        this.$sms.href = shareUrls.sms(payload);\n      }\n\n      _copy(){\n              // A <span> contains the text to copy\n              const span = document.createElement('span');\n              span.textContent = this.url;\n              span.style.whiteSpace = 'pre'; // Preserve consecutive spaces and newlines\n\n              // Paint the span outside the viewport\n              span.style.position = 'absolute';\n              span.style.left = '-9999px';\n              span.style.top = '-9999px';\n\n              const win = window;\n              const selection = win.getSelection();\n              win.document.body.appendChild(span);\n\n              const range = win.document.createRange();\n              selection.removeAllRanges();\n              range.selectNode(span);\n              selection.addRange(range);\n\n              let success = false;\n              try {\n                  success = win.document.execCommand('copy');\n              } catch (err) {}\n\n              selection.removeAllRanges();\n              span.remove();\n\n              return success;\n      }\n\n      /*async*/\n      show(payloadObj){\n        this._init()\n        clearTimeout(this._hideTimer);\n        this._setPayload(payloadObj);\n        this.$root.style.display = 'flex';\n        this.$root.offsetWidth; // style update\n        this.$root.style.background = 'rgba(0,0,0,.4)';\n        document.querySelectorAll('.web-share-container').forEach(el => {\n            el.style.transform = 'translateY(0)';\n            el.style.opacity = 1;\n        });\n      }\n\n      _hide(){\n              this.$root.style.background = null;\n              document.querySelectorAll('.web-share-container').forEach(el => {\n                  el.style.transform = null;\n                  el.style.opacity = null;\n              });\n              this._hideTimer = setTimeout(() => this.$root.style.display = null, 400);\n      }\n    }\n\n    const shareUi = new WebShareUI();\n\n    /* async */\n    return data => shareUi.show(data);\n\n  }());\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ../client/src/components/share.js","module.exports = require(\"es6-promise\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"es6-promise\"\n// module id = 103\n// module chunks = 0","import React, {Component} from 'react'\n\nclass CountdownMessage extends Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      currentCount: 10,\n      total: '',\n      days: '',\n      hours: '',\n      minutes: '',\n      seconds: ''\n    }\n\n    this.countdown = this.countdown.bind(this);\n  }\n\n  componentDidMount() {\n    this.intervalId = setInterval(this.countdown, 1000);\n  }\n\n  componentWillUnmount() {\n    clearInterval(this.intervalId);\n  }\n\n  countdown() {\n    var deadline = Date.parse(this.props.endTime);\n    var now = Date.parse(new Date());\n    var timeRemaining = deadline - now\n\n    var seconds = Math.floor( (timeRemaining/1000) % 60 );\n    var minutes = Math.floor( (timeRemaining/1000/60) % 60 );\n    var hours = Math.floor( (timeRemaining/(1000*60*60)) % 24 );\n    var days = Math.floor( timeRemaining/(1000*60*60*24) );\n\n    this.setState({total: timeRemaining, minutes: minutes, seconds: seconds})\n\n  }\n\n\n  render() {\n    var totalTimeInMinutes = this.state.total/1000/60\n    if(totalTimeInMinutes > 0 && totalTimeInMinutes < 5) {\n      var message = `Starting in: ${this.state.minutes > 0 ? this.state.minutes + \"min\" : \"\"} ${this.state.seconds}sec`\n    } else {\n      var message = \"Started\"\n    }\n\n    if (totalTimeInMinutes < 5) {\n      return (\n        <div id='countdown-time' className='btn btn-info' ref='countdown_ref'>\n          {message}\n        </div>\n      );\n    } else {\n      return (\n        <div></div>\n        )\n    }\n  }\n}\n\nexport default CountdownMessage;\n\n\n\n// WEBPACK FOOTER //\n// ../client/src/components/countdown_message.js","module.exports = require(\"agenda\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"agenda\"\n// module id = 105\n// module chunks = 0","module.exports = require(\"agendash\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"agendash\"\n// module id = 106\n// module chunks = 0","module.exports = require(\"express-session\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"express-session\"\n// module id = 107\n// module chunks = 0","module.exports = require(\"connect-mongo\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"connect-mongo\"\n// module id = 108\n// module chunks = 0"],"sourceRoot":""}