{"version":3,"sources":["webpack:///webpack/bootstrap 40b616ed6737d3f24d6f","webpack:///external \"react\"","webpack:///../client/src/state.js","webpack:///external \"react-easy-state\"","webpack:///external \"express\"","webpack:///external \"mongoose\"","webpack:///external \"dotenv\"","webpack:///external \"path\"","webpack:///external \"isomorphic-fetch\"","webpack:///external \"react-router\"","webpack:///external \"prop-types\"","webpack:///external \"opentok-react\"","webpack:///external \"@opentok/client\"","webpack:///external \"babel-polyfill/lib/index\"","webpack:///./index.js","webpack:///./routes/index.js","webpack:///external \"body-parser\"","webpack:///./routes/api.js","webpack:///external \"fs\"","webpack:///external \"opentok\"","webpack:///./models/tok_session.js","webpack:///external \"another-mongoose-statemachine\"","webpack:///./models/tok_session_participant.js","webpack:///./routes/ssr.js","webpack:///external \"react-dom/server\"","webpack:///external \"redux\"","webpack:///external \"react-redux\"","webpack:///../client/src/app.js","webpack:///external \"react-router-dom\"","webpack:///../client/src/components/header.js","webpack:///../client/src/components/home.js","webpack:///../client/src/components/user_list.js","webpack:///../client/src/components/generator_form.js","webpack:///../client/src/components/session_info.js","webpack:///../client/src/components/event_message.js","webpack:///../client/src/components/Room.js","webpack:///external \"uuid\"","webpack:///external \"opentok-layout-js\"","webpack:///external \"es6-promise\"","webpack:///external \"express-session\"","webpack:///external \"connect-mongo\""],"names":["session","journeys","loggedIn","user","location","global","__INITIAL_STATE__","dotenv","require","config","__CLIENT__","__SERVER__","routes","exports","app","use","secret","saveUninitialized","resave","store","url","process","env","MONGODB_URI","MONGO_URL","cookie","expires","Date","set","join","__dirname","json","static","listen","PORT","console","log","connect","promisify","fn","promisified","params","Promise","resolve","reject","concat","err","args","length","opentok","OPENTOK_KEY","OPENTOK_SECRET","router","Router","generateToken","sessionId","tokenOptions","role","token","get","req","res","room","findOne","lean","exec","existingSession","find","present","participants","createSession","newSession","save","toJSON","signal","type","data","sendStatus","connection","connectionId","participant","ready","count","allReady","readdirAsync","readdir","extname","file","journeyFiles","filter","map","put","journey","body","post","start","flags","push","event","id","participantExists","name","destroy","clearCookie","redirect","fetch","headers","method","mode","JSON","stringify","then","response","FlagSchema","String","reason","TokSessionSchema","index","default","plugin","states","created","started","completed","transitions","from","to","end","TokSession","model","TokSessionParticipantSchema","Types","ObjectId","ref","Boolean","TokSessionParticipant","context","originalUrl","html","renderToString","writeHead","Location","status","render","NODE_ENV","script","openTokKey","RequireLoginRoute","Component","component","rest","renderProps","pathname","Login","props","login","e","preventDefault","state","credentials","history","field","setState","target","value","padding","width","onChange","propTypes","match","object","isRequired","App","Header","OTSession","OTPublisher","OTStreams","OTSubscriber","OT","window","Home","streams","publisherId","totalConnectionsCreated","connectedUsers","publisher","roomUrl","sessionHelper","apiKey","onConnect","setTimeout","refreshSession","onStreamsUpdated","sh","on","updatedConnectionCount","newData","indexOf","splice","displayMessageVisible","displayMessageText","sessionUrl","UserList","nextProps","userCount","userIds","float","paddingRight","GeneratorForm","sessionLinkName","sessionLinkUrl","handleNameChange","bind","urlFriendlyName","createSessionLink","replace","toLowerCase","SessionInfo","jumpToSession","sessionLink","open","fontWeight","backgroundColor","EventMessage","message","undefined","polyfill","Room","onInitPublisher","onConfirmReady","onChangeJourney","cache","referrer","onStartSession","onLoadedMetadata","journeyDuration","duration","audioTag","removeEventListener","onTimeUpdate","addEventListener","playerProgress","currentTime","playerProgressMS","onFlag","playerState","publishAudio","play","disconnect","currentParticipant","currentUserHasFlaggedJourney","flag","display","position","top","right","split","flex","timeRemaining","container","gridTemplateColumns","gridGap","marginRight","stream","fontSize","bottom","seconds","minutes","Math","floor","remainingSeconds","toFixed"],"mappings":"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","file":"./server.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 12);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 40b616ed6737d3f24d6f","module.exports = require(\"react\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"react\"\n// module id = 0\n// module chunks = 0","import { store } from 'react-easy-state'\n\nexport default store({\n  session: null,\n  journeys: [],\n  loggedIn: false,\n  user: null,\n  location: '/',\n  ...(global.__INITIAL_STATE__ || {})\n});\n\n\n\n// WEBPACK FOOTER //\n// ../client/src/state.js","module.exports = require(\"react-easy-state\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"react-easy-state\"\n// module id = 2\n// module chunks = 0","module.exports = require(\"express\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"express\"\n// module id = 3\n// module chunks = 0","module.exports = require(\"mongoose\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"mongoose\"\n// module id = 4\n// module chunks = 0","module.exports = require(\"dotenv\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"dotenv\"\n// module id = 5\n// module chunks = 0","module.exports = require(\"path\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"path\"\n// module id = 6\n// module chunks = 0","module.exports = require(\"isomorphic-fetch\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"isomorphic-fetch\"\n// module id = 7\n// module chunks = 0","module.exports = require(\"react-router\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"react-router\"\n// module id = 8\n// module chunks = 0","module.exports = require(\"prop-types\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"prop-types\"\n// module id = 9\n// module chunks = 0","module.exports = require(\"opentok-react\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"opentok-react\"\n// module id = 10\n// module chunks = 0","module.exports = require(\"@opentok/client\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"@opentok/client\"\n// module id = 11\n// module chunks = 0","module.exports = require(\"babel-polyfill/lib/index\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"babel-polyfill/lib/index\"\n// module id = 13\n// module chunks = 0","const dotenv = require('dotenv');\n\ndotenv.config();\nglobal.__CLIENT__ = false;\nglobal.__SERVER__ = true;\n\nconst routes = require('./routes');\n\nexports = routes;\n\n\n\n// WEBPACK FOOTER //\n// ./index.js","import path from 'path';\nimport express from 'express';\nimport bodyParser from 'body-parser';\nimport api from './api';\nimport ssr from './ssr';\n\nimport session from 'express-session';\nimport createMongoStore from 'connect-mongo';\n\nconst app = express();\n\napp.use(session({\n    secret: 'qVaNxeu5VVEAtkyFJ/62EKcp7Lw=',\n    saveUninitialized: false, // don't create session until something stored\n\t  resave: false, //don't save session if unmodified\n    store: new (createMongoStore(session))({url: process.env.MONGODB_URI || process.env.MONGO_URL}),\n    cookie: {expires: new Date(253402300000000)}\n}));\n\napp.set('view engine', 'ejs');\napp.set('views', path.join(__dirname, '../views'));\napp.use(bodyParser.json());\n\napp.use(express.static(path.join(__dirname, '..', 'public')));\n\napp.use('/api', api);\napp.use('/*', ssr);\n\napp.listen(process.env.PORT || 5000, () => {\n  console.log('Hello World listening on port 5000!');\n});\n\n\n\n// WEBPACK FOOTER //\n// ./routes/index.js","module.exports = require(\"body-parser\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"body-parser\"\n// module id = 16\n// module chunks = 0","import fs from 'fs';\nimport path from 'path';\nimport express from 'express';\nimport OpenTok from 'opentok';\nimport mongoose from 'mongoose';\nimport TokSession from '../models/tok_session';\nimport TokSessionParticipant from '../models/tok_session_participant';\nimport dotenv from 'dotenv';\nrequire('isomorphic-fetch');\n\ndotenv.config();\n\nmongoose.connect(process.env.MONGODB_URI || process.env.MONGO_URL);\n\nfunction promisify(fn) {\n  /**\n   * @param {...Any} params The params to pass into *fn*\n   * @return {Promise<Any|Any[]>}\n   */\n  return function promisified(...params) {\n    return new Promise((resolve, reject) => fn(...params.concat([(err, ...args) => err ? reject(err) : resolve( args.length < 2 ? args[0] : args )])))\n  }\n}\n\nconst opentok = new OpenTok(process.env.OPENTOK_KEY, process.env.OPENTOK_SECRET);\nconst router = express.Router();\n\nfunction generateToken(sessionId) {\n\tlet tokenOptions = {};\n\ttokenOptions.role = \"publisher\";\n\t// Generate a token.\n\tconst token = opentok.generateToken(sessionId, tokenOptions);\n  console.log('return token', token);\n\treturn token;\n}\n\n// TODO: switch to POST, just using GET for easier testing\nrouter.get('/sessions/:room', async (req, res) => {\n\tconst {room} = req.params;\n\tconst existingSession = await TokSession.findOne({room}).lean().exec();\n\tif (existingSession) {\n    const participants = await TokSessionParticipant.find({session: existingSession, present: true}).lean().exec();\n    existingSession.participants = participants;\n\t\tres.json({\n\t\t\t...existingSession,\n\t\t\ttoken: generateToken(existingSession.sessionId),\n\t\t});\n\t} else {\n\t\topentok.createSession(async (err, session) => {\n\t\t  if (err) throw err;\n\t\t\t// save the sessionId\n\t\t\tconst newSession = new TokSession({room, sessionId: session.sessionId});\n\t\t\tawait newSession.save();\n\t\t\tres.json({\n\t\t\t\t...newSession.toJSON(),\n\t\t\t\ttoken: generateToken(session.sessionId),\n\t\t\t});\n\t\t});\n\t}\n});\n\n// TEMP: Use get for convenience. hardcode temp-home-location for the room\n// Trigger a general announcement to everyone\nrouter.get('/sessions/test/temp-home-location', async (req, res) => {\n  // const {room, connection} = req.params;\n  const existingSession = await TokSession.findOne({room:'temp-home-location'}).exec();\n  if (existingSession) {\n  console.log(\"**** SENDING SIGNAL\")\n  signal(existingSession.sessionId, {type: 'displayJourneyRequest', data: 'Rob has started a session. Join him (link)'});\n  return res.sendStatus(200);\n  }\n  res.sendStatus(200);\n});\n\nrouter.get('/sessions/:room/connections/:connection/ready', async (req, res) => {\n  const {room, connection} = req.params;\n  const existingSession = await TokSession.findOne({room}).exec();\n\tif (existingSession) {\n    const participant = await TokSessionParticipant.findOne({session: existingSession, connectionId: connection});\n    participant.ready = true;\n    await participant.save();\n    signal(existingSession.sessionId, {type: 'ready', data: 'foo'});\n    const allReady = (await TokSessionParticipant.count({session: existingSession, ready: false, present: true})) === 0;\n    if (allReady) {\n      // signal(existingSession.sessionId, {type: 'startJourney', data: 'foo'});\n    }\n    return res.sendStatus(200);\n  }\n  res.sendStatus(200);\n});\n\nrouter.get('/journeys', async (req, res) => {\n  const readdirAsync = promisify(fs.readdir)\n  const journeyFiles = (await readdirAsync(path.join(__dirname, '..', 'public/journeys'))).filter(file => {\n    return path.extname(file) === '.mp3';\n  }).map(file => {\n    return `/journeys/${file}`\n  });\n  res.json(journeyFiles);\n});\n\nrouter.put('/sessions/:room/journey', async (req, res) => {\n  console.log('UPDATE JOURNEY');\n  const {journey} = req.body;\n  const {room} = req.params;\n  const existingSession = await TokSession.findOne({room}).exec();\n\tif (existingSession) {\n    existingSession.journey = journey;\n    await existingSession.save();\n    signal(existingSession.sessionId, {type: 'updatedJourney', data: journey});\n  }\n  res.sendStatus(200);\n});\n\n// TODO: this should really verify that the user hitting this endpoint is authorized to do so (e.g. that they are the journey's host)\nrouter.post('/sessions/:room/start', async (req, res) => {\n  const {room} = req.params;\n  const existingSession = await TokSession.findOne({room}).exec();\n\tif (existingSession) {\n    await existingSession.start();\n    signal(existingSession.sessionId, {type: 'startJourney', data: ''});\n  }\n});\n\nrouter.post('/sessions/:room/flag', async (req, res) => {\n  const {room} = req.params;\n  const {connectionId} = req.body;\n  const existingSession = await TokSession.findOne({room}).exec();\n\tif (existingSession) {\n    existingSession.flags.push({user: connectionId});\n    await existingSession.save();\n    const participants = await TokSessionParticipant.find({session: existingSession, present: true}).lean().exec();\n    return res.json({...existingSession.toJSON(), participants});\n  }\n  res.sendStatus(404);\n});\n\nrouter.post('/event', async (req, res) => {\n  console.log('GOT EVENT', req.body);\n  res.sendStatus(200);\n  const {sessionId, connection} = req.body;\n  const session = await TokSession.findOne({sessionId}).exec();\n\n  console.log(\"*******\" + req.body)\n\n  switch(req.body.event) {\n    case 'connectionCreated':\n      if (session) {\n        const participantExists = (await TokSessionParticipant.count({session, connectionId: connection.id})) > 0;\n        if (!participantExists) {\n          const participant = new TokSessionParticipant({session, connectionId: connection.id});\n          await participant.save();\n        }\n      }\n      break;\n    case 'connectionDestroyed':\n      if (session) {\n        const participant= await TokSessionParticipant.findOne({session, connectionId: connection.id});\n        if (participant) {\n          participant.present = false;\n          await participant.save();\n        }\n      }\n      break\n  }\n});\n\nrouter.post('/login', (req, res) => {\n  req.session.loggedIn = true;\n  req.session.user = {\n    name: req.body.name\n  };\n  res.json({loggedIn: true, user: {name: req.body.name}});\n});\n\nrouter.get('/logout', (req, res) => {\n  req.session.destroy(() => {\n      res\n        .clearCookie('connect.sid')\n        .redirect('/login')\n    });\n});\n\nfunction signal(sessionId, data) {\n  fetch(`https://api.opentok.com/v2/project/${process.env.OPENTOK_KEY}/session/${sessionId}/signal`, {\n    headers: {\n      'X-TB-PARTNER-AUTH': `${process.env.OPENTOK_KEY}:${process.env.OPENTOK_SECRET}`\n    },\n    method: 'POST',\n    mode: 'cors',\n    body: JSON.stringify(data)\n  }).then(response => console.log(response));\n}\n\nexport default router;\n\n\n\n\n// WEBPACK FOOTER //\n// ./routes/api.js","module.exports = require(\"fs\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"fs\"\n// module id = 18\n// module chunks = 0","module.exports = require(\"opentok\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"opentok\"\n// module id = 19\n// module chunks = 0","import mongoose, {Schema} from 'mongoose';\nimport statemachine from 'another-mongoose-statemachine';\n\nconst FlagSchema = new Schema({\n  user: {type: String},\n  reason: {type: String},\n});\n\nconst TokSessionSchema = new Schema({\n  room: {type: String, index: true},\n  sessionId: {type: String, index: true},\n  journey: {type: String, default: '/journeys/Journey to A Spiderweb+Music.mp3'},\n  flags: {type: [FlagSchema], default: []},\n});\n\nTokSessionSchema.plugin(statemachine, {\n  states: {\n    created: {default: true},\n    started: {},\n    completed: {}\n  },\n  transitions: {\n    start: { from: 'created', to: 'started' },\n    end: { from: '*', to: 'completed' },\n  }\n});\n\nconst TokSession = mongoose.model('TokSession', TokSessionSchema);\n\nexport default TokSession;\n\n\n\n\n// WEBPACK FOOTER //\n// ./models/tok_session.js","module.exports = require(\"another-mongoose-statemachine\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"another-mongoose-statemachine\"\n// module id = 21\n// module chunks = 0","import mongoose, {Schema} from 'mongoose';\n\nconst TokSessionParticipantSchema = new Schema({\n  \"connectionId\": {type: String, index: true},\n  \"session\": {type: Schema.Types.ObjectId, ref: 'TokSession'},\n  \"ready\": {type: Boolean, default: false},\n  \"present\": {type: Boolean, default: true},\n});\n\nconst TokSessionParticipant = mongoose.model('TokSessionParticipant', TokSessionParticipantSchema);\n\nexport default TokSessionParticipant;\n\n\n\n\n// WEBPACK FOOTER //\n// ./models/tok_session_participant.js","import express from 'express';\nimport React from 'react';\nimport ReactDOMServer from 'react-dom/server';\nimport { createStore } from 'redux';\nimport { Provider } from 'react-redux';\nimport { StaticRouter } from 'react-router';\nimport App from '../../client/src/app';\nimport state from '../../client/src/state';\nconsole.log(process.env);\n\nconst router = express.Router();\n\nrouter.get('/', (req, res) => {\n  const context = {};\n\n  state.loggedIn = req.session.loggedIn;\n  state.user = req.session.user;\n  console.log('GOT SESSION', req.session, req.originalUrl);\n\n  const html = ReactDOMServer.renderToString(\n    <StaticRouter\n      location={req.originalUrl}\n      context={context}\n    >\n      <App />\n    </StaticRouter>\n  );\n\n  console.log('GOT HTML', html, context.url);\n  if (context.url) {\n    console.log('REDIRECT');\n    if (req.originalUrl != '/favicon.ico') {\n      res.writeHead(301, {\n        Location: context.url,\n      });\n    }\n    res.end();\n  } else {\n    res.status(200).render(process.env.NODE_ENV === 'production' ? 'index.ejs' : 'index.dev.ejs', {\n      html,\n      script: JSON.stringify({openTokKey: process.env.OPENTOK_KEY, loggedIn: req.session.loggedIn, user: req.session.user}),\n    });\n  }\n});\n\n\nexport default router;\n\n\n\n// WEBPACK FOOTER //\n// ./routes/ssr.js","module.exports = require(\"react-dom/server\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"react-dom/server\"\n// module id = 24\n// module chunks = 0","module.exports = require(\"redux\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"redux\"\n// module id = 25\n// module chunks = 0","module.exports = require(\"react-redux\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"react-redux\"\n// module id = 26\n// module chunks = 0","import React, {Component} from 'react';\nimport { Route, Redirect, Switch } from 'react-router-dom';\nimport { withRouter } from 'react-router';\nimport { view } from 'react-easy-state';\nimport PropTypes from 'prop-types';\nimport Header from './components/header';\nimport Home from './components/home';\nimport Room from './components/Room';\nimport state from './state';\n\nconst RequireLoginRoute = ({component: Component, ...rest}) => {\n  return (\n    <Route {...rest} render={renderProps => {\n        return (\n          state.loggedIn ?\n            <Component {...renderProps} />\n          : <Redirect to={ {\n                pathname: '/login'\n            }} />\n        )\n    }}/>\n  )\n};\n\nclass Login extends Component {\n  static propTypes = {\n    match: PropTypes.object.isRequired,\n    location: PropTypes.object.isRequired,\n    history: PropTypes.object.isRequired\n  }\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      name: ''\n    }\n  }\n  \n  onChange(field) {\n    return (e) => {\n      this.setState({\n        [field]: e.target.value\n      });\n    }\n  }\n\n  login = (e) => {\n    e.preventDefault();\n    fetch(`/api/login`, {\n      body: JSON.stringify({name: this.state.name}), // must match 'Content-Type' header\n      method: 'POST', // *GET, POST, PUT, DELETE, etc.\n      credentials: 'same-origin',\n      headers: {\n        'content-type': 'application/json'\n      }\n    })\n    .then(response => response.json())\n    .then(json => {\n      state.loggedIn = json.loggedIn;\n      state.user = json.user;\n      this.props.history.push('/');\n    });\n  }\n\n  render() {\n    return (\n      <div style={{padding: '20px', width: '50%'}}>\n        <form onSubmit={this.login}>\n          <div className=\"form-group\">\n            <label htmlFor=\"name\">Name</label>\n            <input type=\"text\" onChange={this.onChange('name')} value={this.state.name} className=\"form-control\" id=\"name\" aria-describedby=\"nameHelp\" placeholder=\"Enter name\"/>\n          </div>\n          <button type=\"submit\" className=\"btn btn-primary\">Submit</button>\n        </form>\n      </div>\n    )\n  }\n}\n\nclass App extends Component {\n  render() {\n    return (\n      <div>\n        <Header />\n        <Switch>\n          <Route exact path=\"/login\" component={withRouter(Login)} />\n          <RequireLoginRoute exact path=\"/\" component={Home} />\n          <RequireLoginRoute exact path=\"/:room\" component={Room} />\n        </Switch>\n      </div>\n    )\n  }\n}\n\nexport default withRouter(view(App));\n\n\n\n// WEBPACK FOOTER //\n// ../client/src/app.js","module.exports = require(\"react-router-dom\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"react-router-dom\"\n// module id = 28\n// module chunks = 0","import React from 'react';\nimport { view } from 'react-easy-state';\nimport state from '../state';\n\nconst Header = () => (\n  <div className=\"header pl-4\">\n    <h1>Get started with Wacuri!</h1>\n    {state.loggedIn && state.user &&\n      <div>\n        <span className='mr-2 text-secondary'>logged in as {state.user.name}</span>\n        <a href='/api/logout'>Logout</a>\n      </div>\n    }\n  </div>\n);\n\nexport default view(Header);\n\n\n\n// WEBPACK FOOTER //\n// ../client/src/components/header.js","import React, { Component } from 'react';\nimport UserList from './user_list'\nimport GeneratorForm from './generator_form'\nimport EventMessage from './event_message'\nimport state from '../state'\n\n\nvar { OTSession, OTPublisher, OTStreams, OTSubscriber, createSession } = {};\n\nif (__CLIENT__) {\n  var { OTSession, OTPublisher, OTStreams, OTSubscriber, createSession } = require('opentok-react');\n  const OT = require('@opentok/client');\n  window.state = state;\n}\n\n\nexport default class Home extends Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      streams: [],\n      publisherId: '',\n      session: null,\n      totalConnectionsCreated: 0,\n      connectedUsers: []\n    }\n    this.publisher = {};\n  }\n\n\n  componentDidMount() {\n    const roomUrl = 'temp-home-location'\n\n    fetch(`/api/sessions/${roomUrl}`)\n      .then(res => res.json())\n      .then(json => {\n        state.session = json;\n        this.sessionHelper = createSession({\n          apiKey: state.openTokKey,\n          sessionId: state.session.sessionId,\n          token: state.session.token,\n          onConnect: () => {\n            console.log('assigned connection to publisher', this.sessionHelper.session.connection);\n            setTimeout(this.refreshSession, 1000);\n          },\n          onStreamsUpdated: streams => {\n            console.log('Current subscriber streams:', streams);\n            this.setState({ streams });\n          }\n        });\n        window.sh = this.sessionHelper;\n        this.sessionHelper.session.on(\"connectionDestroyed\", (event) => {\n          console.log('DESTROYED', event);\n          const data = {\n            sessionId: this.sessionHelper.session.sessionId,\n            connection: {\n              id: event.connection.id\n            },\n            event: 'connectionDestroyed',\n\n          }\n\n          const updatedConnectionCount = this.state.totalConnectionsCreated - 1\n          this.setState({totalConnectionsCreated: updatedConnectionCount})\n\n          let newData = [...this.state.connectedUsers]\n          let index = newData.indexOf(event.connection.id)\n          newData.splice(index, 1)\n          this.setState({connectedUsers: newData})\n\n          console.log('data is', data);\n          // fetch(`/api/event`, {\n          //   body: JSON.stringify(data), // must match 'Content-Type' header\n          //   cache: 'no-cache', // *default, no-cache, reload, force-cache, only-if-cached\n          //   credentials: 'same-origin', // include, same-origin, *omit\n          //   headers: {\n          //     'user-agent': 'Mozilla/4.0 MDN Example',\n          //     'content-type': 'application/json'\n          //   },\n          //   method: 'POST', // *GET, POST, PUT, DELETE, etc.\n          //   mode: 'cors', // no-cors, cors, *same-origin\n          //   redirect: 'follow', // manual, *follow, error\n          //   referrer: 'no-referrer', // *client, no-referrer\n          // });\n          // this.refreshSession();\n        });\n\n\n\n        this.sessionHelper.session.on(\"connectionCreated\", (event) => {\n          console.log('CREATED', event);\n          const updatedConnectionCount = this.state.totalConnectionsCreated + 1\n          this.setState({totalConnectionsCreated: updatedConnectionCount})\n          console.log('**** Total connections: ' + this.state.totalConnectionsCreated)\n          const data = {\n            sessionId: this.sessionHelper.session.sessionId,\n            connection: {\n              id: event.connection.id\n            },\n            event: 'connectionCreated',\n          }\n\n          this.setState({ connectedUsers: [...this.state.connectedUsers, event.connection.id] })\n          console.log('data is', data);\n          // fetch(`/api/event`, {\n          //   body: JSON.stringify(data), // must match 'Content-Type' header\n          //   cache: 'no-cache', // *default, no-cache, reload, force-cache, only-if-cached\n          //   credentials: 'same-origin', // include, same-origin, *omit\n          //   headers: {\n          //     'user-agent': 'Mozilla/4.0 MDN Example',\n          //     'content-type': 'application/json'\n          //   },\n          //   method: 'POST', // *GET, POST, PUT, DELETE, etc.\n          //   mode: 'cors', // no-cors, cors, *same-origin\n          //   redirect: 'follow', // manual, *follow, error\n          //   referrer: 'no-referrer', // *client, no-referrer\n          // });\n          // this.refreshSession();\n        });\n\n\n\n        this.sessionHelper.session.on(\"signal\", (event) => {\n          console.log(\"Signal sent from connection \", event);\n          console.log(\"Signal type\", event.type);\n          // this.refreshSession(); // FIXME Error: home.js:110 Uncaught TypeError: _this2.refreshSession is not a function\n\n          if (event.type === 'signal:displayJourneyRequest') {\n            console.log(\"**** CAPTURED the journey request !! \")\n            this.setState({\n              displayMessageVisible: true,\n              displayMessageText: \"George has created a session 'Daily Jetsons Meditation'.\", //TEMP hard coded\n              sessionUrl: '/another-jetsons-url'\n            });\n          }\n        });\n\n        this.setState({\n          session: this.sessionHelper.session\n        });\n      });\n\n\n    fetch('/api/journeys')\n      .then(res => res.json())\n      .then(json => {\n        state.journeys = json;\n      });\n\n  }\n\n\n\n\n\n  render() {\n    return (\n      <div className=\"home\">\n        <UserList userCount={this.state.totalConnectionsCreated} userIds={this.state.connectedUsers} />\n        <EventMessage message={this.state.displayMessageText} sessionUrl={this.state.sessionUrl} />\n        <GeneratorForm />\n      </div>\n      )\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ../client/src/components/home.js","import React, {Component} from 'react'\n\nexport default class UserList extends Component {\n  constructor(props) {\n    super(props);\n  }\n\n  componentWillReceiveProps(nextProps) {\n    this.setState({ userCount: nextProps.totalConnectionsCreated });\n    this.setState({ userIds: nextProps.connectedUsers });\n  }\n\n\n  render() {\n    return (\n      <div style={{float:'right', paddingRight:'50px'}}>\n        <h4>Current Users ({this.props.userCount})</h4>\n        <ul>\n          {this.props.userIds.map(function(name){\n            return <li key={name}>{name}</li>;\n          })}\n        </ul>\n      </div>\n    )\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ../client/src/components/user_list.js","import React, {Component} from 'react'\nimport SessionInfo from './session_info'\n\nexport default class GeneratorForm extends Component {\n\n  constructor(props){\n    super(props)\n    this.state = {\n      sessionLinkName: '',\n      sessionLinkUrl: ''\n    }\n\n    this.handleNameChange = this.handleNameChange.bind(this)\n    this.urlFriendlyName = this.urlFriendlyName.bind(this)\n    this.createSessionLink = this.createSessionLink.bind(this)\n  }\n\n  createSessionLink() {\n    this.setState({sessionLinkUrl: this.urlFriendlyName(this.state.sessionLinkName) })\n    fetch('/api/sessions/test/temp-home-location')\n  }\n\n  sendNotifications() {\n\n  }\n\n  handleNameChange(event) {\n    this.setState({sessionLinkName: event.target.value})\n  }\n\n  urlFriendlyName(name){\n    return name.replace(/\\s+/g, '-').toLowerCase()\n  }\n\n\n  render() {\n      return(\n        <div>\n          <form>\n            <h3>Enter Session Details</h3>\n            <p>\n              Give your room a name:<br/>\n              <input type=\"text\" id=\"session_link\" onChange={this.handleNameChange} /> &nbsp; or <a href='#'>Generate a name</a>\n            </p>\n            <p>\n              Description (optional):<br/>\n              <textarea id=\"session_description\" rows=\"2\" cols=\"25\"></textarea>\n            </p>\n            <p>\n              <input type=\"button\" value=\"Create a session\" onClick={this.createSessionLink} />\n\n            </p>\n          </form>\n          <SessionInfo sessionLink={this.state.sessionLinkUrl} />\n        </div>\n      )\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ../client/src/components/generator_form.js","import React, {Component} from 'react'\n\nexport default class SessionInfo extends Component {\n\n  constructor(props){\n    super(props)\n    this.state = {\n      sessionLinkName: 'Reasonable Default',\n      sessionLinkUrl: 'reasonable-default'\n    }\n\n    this.jumpToSession = this.jumpToSession.bind(this)\n  }\n\n  componentWillReceiveProps(nextProps) {\n    this.setState({ sessionLinkUrl: nextProps.sessionLink });\n  }\n\n  jumpToSession() {\n    window.open(this.state.sessionLinkUrl, \"_blank\")\n  }\n\n  // TODO: npm install --save react@^16.2.0 react-dom@^16.2.0 for getDerivedstateFromProps\n\n  render() {\n      return(\n        <div>\n          <h3>Session Created</h3>\n          <p><span style={{ fontWeight: 'bold', backgroundColor: '#ccc', padding: '7px' }}>www.wacuri.com/{this.state.sessionLinkUrl}</span> <a href=\"#\">Copy link to share</a></p>\n\n            <p><input type=\"button\" value=\"Jump to the session\" onClick={this.jumpToSession} /></p>\n\n        </div>\n      )\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ../client/src/components/session_info.js","import React, {Component} from 'react'\n\nexport default class EventMessage extends Component {\n  constructor(props) {\n    super(props);\n  }\n\n  render() {\n    return (\n      <div style={{ backgroundColor: '#fc9' }}>\n        {this.props.message} {this.props.message === undefined ? \"\" : (<a href={this.props.sessionUrl} target='_blank'>Join Now</a>)}\n      </div>\n    )\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ../client/src/components/event_message.js","import React, {Component} from 'react';\nimport { view } from 'react-easy-state'\nimport state from '../state';\nimport PropTypes from 'prop-types';\nimport uuid from 'uuid';\nimport {initLayoutContainer} from 'opentok-layout-js';\nrequire('es6-promise').polyfill();\nrequire('isomorphic-fetch');\n\nvar { OTSession, OTPublisher, OTStreams, OTSubscriber, createSession } = {};\n\nif (__CLIENT__) {\n\tvar { OTSession, OTPublisher, OTStreams, OTSubscriber, createSession } = require('opentok-react');\n\tconst OT = require('@opentok/client');\n\twindow.state = state;\n}\n\nclass Room extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      streams: [],\n      publisherId: '',\n      session: null,\n      playerState: 'waiting',\n      playerProgress: 0,\n      playerProgressMS: 0,\n      journeyDuration: 0,\n    }\n    this.publisher = {};\n    this.audioTag = {};\n  }\n\n\tcomponentDidMount() {\n    this.audioTag.addEventListener('ended', (event) => {\n      this.publisher.state.publisher.publishAudio(true);\n      this.setState({\n        playerState: 'ended'\n      });\n    });\n\n\t\tfetch(`/api/sessions/${this.props.match.params.room}`)\n\t\t\t.then(res => res.json())\n\t\t\t.then(json => {\n\t\t\t\tstate.session = json;\n        this.sessionHelper = createSession({\n          apiKey: state.openTokKey,\n          sessionId: state.session.sessionId,\n          token: state.session.token,\n          onConnect: () => {\n            console.log('assigned connection to publisher', this.sessionHelper.session.connection);\n            setTimeout(this.refreshSession, 1000);\n          },\n          onStreamsUpdated: streams => {\n            console.log('Current subscriber streams:', streams);\n            this.setState({ streams });\n          }\n        });\n        this.sessionHelper.session.on(\"connectionDestroyed\", (event) => {\n          console.log('DESTROYED', event);\n          const data = {\n            sessionId: this.sessionHelper.session.sessionId,\n            connection: {\n              id: event.connection.id\n            },\n            event: 'connectionDestroyed',\n          }\n          this.refreshSession();\n        });\n        this.sessionHelper.session.on(\"connectionCreated\", (event) => {\n          console.log('CREATED', event);\n          const data = {\n            sessionId: this.sessionHelper.session.sessionId,\n            connection: {\n              id: event.connection.id\n            },\n            event: 'connectionCreated',\n          }\n          this.refreshSession();\n        });\n        this.sessionHelper.session.on(\"signal\", (event) => {\n          console.log(\"Signal sent from connection \", event);\n          this.refreshSession();\n          if (event.type === 'signal:startJourney') {\n            this.publisher.state.publisher.publishAudio(false);\n            this.audioTag.play();\n            this.setState({\n              playerState: 'playing'\n            });\n          }\n        });\n        this.setState({\n          session: this.sessionHelper.session\n        });\n\t\t\t});\n    fetch('/api/journeys')\n      .then(res => res.json())\n      .then(json => {\n        state.journeys = json;\n      });\n\t}\n\n  componentWillUnmount() {\n    if (this.sessionHelper) {\n      this.sessionHelper.disconnect();\n    }\n  }\n\n  refreshSession = () => {\n\t\tfetch(`/api/sessions/${this.props.match.params.room}`)\n\t\t\t.then(res => res.json())\n\t\t\t.then(json => {\n\t\t\t\tstate.session = json;\n      });\n  }\n\n  get timeRemaining() {\n    const seconds = this.state.journeyDuration - this.state.playerProgressMS;\n    const minutes = Math.floor(seconds / 60);\n    const remainingSeconds = (seconds % 60).toFixed(0);\n    return minutes + \":\" + (remainingSeconds < 10 ? '0' : '') + remainingSeconds;\n  }\n\n  onInitPublisher = () => {\n    console.log('initialized publisher');\n  }\n\n  onConfirmReady = (e) => {\n    fetch(`/api/sessions/${this.props.match.params.room}/connections/${this.sessionHelper.session.connection.id}/ready`);\n  }\n\n  onChangeJourney = (e) => {\n    console.log('CHANGE', e.target.value);\n    fetch(`/api/sessions/${this.props.match.params.room}/journey`, {\n      body: JSON.stringify({journey: e.target.value}), // must match 'Content-Type' header\n      cache: 'no-cache', // *default, no-cache, reload, force-cache, only-if-cached\n      credentials: 'same-origin', // include, same-origin, *omit\n      headers: {\n        'user-agent': 'Mozilla/4.0 MDN Example',\n        'content-type': 'application/json'\n      },\n      method: 'PUT', // *GET, POST, PUT, DELETE, etc.\n      mode: 'cors', // no-cors, cors, *same-origin\n      redirect: 'follow', // manual, *follow, error\n      referrer: 'no-referrer', // *client, no-referrer\n    });\n  }\n\n  onStartSession = (e) => {\n    fetch(`/api/sessions/${this.props.match.params.room}/start`, {\n      cache: 'no-cache',\n      credentials: 'same-origin',\n      headers: {\n        'user-agent': 'Mozilla/4.0 MDN Example',\n        'content-type': 'application/json'\n      },\n      method: 'POST',\n      mode: 'cors',\n    });\n  }\n\n  onLoadedMetadata = (e) => {\n    this.setState({\n      journeyDuration: e.target.duration\n    });\n    this.audioTag.removeEventListener('timeupdate', this.onTimeUpdate);\n    this.audioTag.addEventListener('timeupdate', this.onTimeUpdate);\n  }\n\n  onTimeUpdate = (e) => {\n    this.setState({\n      playerProgress: (e.target.currentTime / e.target.duration) * 100,\n      playerProgressMS: e.target.currentTime,\n    });\n  }\n\n  onFlag = (e) => {\n    e.preventDefault();\n    fetch(`/api/sessions/${this.props.match.params.room}/flag`, {\n      cache: 'no-cache',\n      body: JSON.stringify({connectionId: this.state.session.connection.id}),\n      credentials: 'same-origin',\n      headers: {\n        'user-agent': 'Mozilla/4.0 MDN Example',\n        'content-type': 'application/json'\n      },\n      method: 'POST',\n      mode: 'cors',\n    })\n      .then(res => res.json())\n      .then(json => state.session = json);\n  }\n\n\trender() {\n    const currentParticipant = this.state.session && state.session && state.session.participants.find(participant => participant.connectionId === this.state.session.connection.id);\n    let currentUserHasFlaggedJourney = false;\n    if (currentParticipant) {\n      currentUserHasFlaggedJourney = state.session.flags.map(flag => flag.user).indexOf(currentParticipant.connectionId) > -1;\n    }\n\t\treturn (\n\t\t\t<div className='journey-container'>\n\t\t\t\t<p style={{display: 'none'}}>{JSON.stringify(state.session, null, 2)}</p>\n        <audio style={{display: 'none'}} onLoadedMetadata={this.onLoadedMetadata} key={state.session && state.session.journey} controls=\"true\" ref={audioTag => { this.audioTag = audioTag }}>\n         <source src={state.session && state.session.journey} type=\"audio/mpeg\"/>\n        </audio>\n\t\t\t\t{this.state.session &&\n          <div style={{position: 'relative'}}>\n            <button style={{position: 'absolute', top: 0, right: 0}} className='btn btn-danger btn-flag-session' disabled={currentUserHasFlaggedJourney} onClick={this.onFlag}>{currentUserHasFlaggedJourney ? \"You've flagged this journey\" : \"Flag this journey\"}</button>\n            <div className='row'>\n              <div className='col-6'>\n                <h2>{state.session.journey.split('/')[state.session.journey.split('/').length - 1]}</h2>\n                { currentParticipant && state.session.participants.indexOf(currentParticipant) === 0 &&\n                  <div>\n                    <select className='mb-3' onChange={this.onChangeJourney} value={state.session && state.session.journey}>\n                      {state.journeys.map(journey => (\n                        <option value={journey}>{journey.split('/')[journey.split('/').length -1]}</option>\n                      ))}\n                    </select>\n                    { state.session.state === 'created' &&\n                      <div className='mb-2'>\n                        <button onClick={this.onStartSession} className='btn btn-primary'>Start session <i className=\"fa fa-play\" ariaHidden=\"true\"></i></button>\n                      </div>\n                    }\n                  </div>\n                }\n              </div>\n            </div>\n            <div className='row'>\n              <div className='col-3'>\n                <progress max=\"100\" value={this.state.playerProgress} style={{width: '100%'}}></progress>\n                <p style={{display: 'flex'}}><strong style={{flex: 1}}>Time remaining:</strong><span>{this.timeRemaining}</span></p>\n              </div>\n            </div>\n            <div className='row'>\n              <div className='tok-container col' ref={container => this.container = container }>\n                {this.state.streams.length == 0 &&\n                  <p>Waiting for others to join this journey...</p>\n                }\n                <div className='row no-gutters' style={{display: 'grid', gridTemplateColumns: 'repeat(3, 1fr)', gridGap: '10px', marginRight: '350px'}}>\n                  {this.state.streams.map(stream => {\n                    const participant = state.session.participants.find(participant => participant.connectionId === stream.connection.id);\n                    return (\n                      <div className={`subscriber`}>\n                        <p style={{fontSize: '14px'}} className={participant && participant.ready ? 'text-success' : 'text-warning'}>{participant && participant.ready ? 'Ready to start!' : 'Not ready yet'}</p>\n                        <OTSubscriber\n                          key={stream.id}\n                          session={this.sessionHelper.session}\n                          stream={stream}\n                        />\n                      </div>\n                    );\n                  })}\n                </div>\n                <div style={{position: 'fixed', bottom: 0, right: 0}}>\n                  <OTPublisher session={this.sessionHelper.session} onInit={this.onInitPublisher} ref={publisher => {this.publisher = publisher}}/>\n                  {currentParticipant && currentParticipant.ready &&\n                    <p>You are ready!</p>\n                  }\n                  {(!currentParticipant || !currentParticipant.ready) &&\n                    <a className='btn btn-primary' href='#' onClick={this.onConfirmReady}>Ready?</a>\n                  }\n                </div>\n              </div>\n            </div>\n          </div>\n\t\t\t\t}\n\t\t\t</div>\n\t\t)\n\t}\n}\n\nexport default view(Room);\n\n\n\n// WEBPACK FOOTER //\n// ../client/src/components/Room.js","module.exports = require(\"uuid\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"uuid\"\n// module id = 36\n// module chunks = 0","module.exports = require(\"opentok-layout-js\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"opentok-layout-js\"\n// module id = 37\n// module chunks = 0","module.exports = require(\"es6-promise\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"es6-promise\"\n// module id = 38\n// module chunks = 0","module.exports = require(\"express-session\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"express-session\"\n// module id = 39\n// module chunks = 0","module.exports = require(\"connect-mongo\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"connect-mongo\"\n// module id = 40\n// module chunks = 0"],"sourceRoot":""}