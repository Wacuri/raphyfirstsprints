{"version":3,"sources":["webpack:///webpack/bootstrap 9e82fc0f97d2b28a1061","webpack:///external \"debug\"","webpack:///external \"react\"","webpack:///../client/src/state.js","webpack:///external \"mongoose\"","webpack:///external \"react-easy-state\"","webpack:///../node_modules/Agenda/lib/utils/index.js","webpack:///external \"path\"","webpack:///external \"express\"","webpack:///external \"moment\"","webpack:///external \"opentok-react\"","webpack:///external \"@opentok/client\"","webpack:///external \"human-interval\"","webpack:///external \"dotenv\"","webpack:///external \"fs\"","webpack:///external \"opentok\"","webpack:///./models/journey_space.js","webpack:///external \"isomorphic-fetch\"","webpack:///external \"react-router\"","webpack:///external \"prop-types\"","webpack:///../node_modules/Agenda/lib/job/index.js","webpack:///external \"date.js\"","webpack:///../node_modules/Agenda/lib/utils/create-job.js","webpack:///external \"babel-polyfill/lib/index\"","webpack:///./index.js","webpack:///./routes/index.js","webpack:///external \"body-parser\"","webpack:///./routes/api.js","webpack:///external \"another-mongoose-statemachine\"","webpack:///./models/journey_participant.js","webpack:///./routes/ssr.js","webpack:///external \"react-dom/server\"","webpack:///external \"redux\"","webpack:///external \"react-redux\"","webpack:///../client/src/app.js","webpack:///external \"react-router-dom\"","webpack:///../client/src/components/header.js","webpack:///../client/src/components/home.js","webpack:///../client/src/components/user_list.js","webpack:///../client/src/components/generator_form.js","webpack:///../client/src/components/event_message.js","webpack:///../client/src/components/journey_space_form.js","webpack:///../client/src/components/journey_detail_entry.js","webpack:///../client/src/components/session_info.js","webpack:///../client/src/components/Room.js","webpack:///external \"uuid\"","webpack:///external \"opentok-layout-js\"","webpack:///external \"es6-promise\"","webpack:///external \"agenda\"","webpack:///external \"agendash\"","webpack:///external \"express-session\"","webpack:///external \"connect-mongo\"","webpack:///./jobs/index.js","webpack:///../node_modules/Agenda/index.js","webpack:///../node_modules/Agenda/lib/agenda/index.js","webpack:///external \"events\"","webpack:///../node_modules/Agenda/lib/agenda/mongo.js","webpack:///../node_modules/Agenda/lib/agenda/database.js","webpack:///external \"mongodb\"","webpack:///../node_modules/Agenda/lib/agenda/db-init.js","webpack:///../node_modules/Agenda/lib/agenda/name.js","webpack:///../node_modules/Agenda/lib/agenda/process-every.js","webpack:///../node_modules/Agenda/lib/agenda/max-concurrency.js","webpack:///../node_modules/Agenda/lib/agenda/default-concurrency.js","webpack:///../node_modules/Agenda/lib/agenda/locklimit.js","webpack:///../node_modules/Agenda/lib/agenda/default-lock-limit.js","webpack:///../node_modules/Agenda/lib/agenda/default-lock-lifetime.js","webpack:///../node_modules/Agenda/lib/agenda/sort.js","webpack:///../node_modules/Agenda/lib/agenda/create.js","webpack:///../node_modules/Agenda/lib/job/to-json.js","webpack:///../node_modules/Agenda/lib/job/compute-next-run-at.js","webpack:///external \"cron\"","webpack:///external \"moment-timezone\"","webpack:///../node_modules/Agenda/lib/job/repeat-every.js","webpack:///../node_modules/Agenda/lib/job/repeat-at.js","webpack:///../node_modules/Agenda/lib/job/disable.js","webpack:///../node_modules/Agenda/lib/job/enable.js","webpack:///../node_modules/Agenda/lib/job/unique.js","webpack:///../node_modules/Agenda/lib/job/schedule.js","webpack:///../node_modules/Agenda/lib/job/priority.js","webpack:///../node_modules/Agenda/lib/job/fail.js","webpack:///../node_modules/Agenda/lib/job/run.js","webpack:///../node_modules/Agenda/lib/job/is-running.js","webpack:///../node_modules/Agenda/lib/job/save.js","webpack:///../node_modules/Agenda/lib/job/remove.js","webpack:///../node_modules/Agenda/lib/job/touch.js","webpack:///../node_modules/Agenda/lib/agenda/jobs.js","webpack:///../node_modules/Agenda/lib/utils/process-jobs.js","webpack:///../node_modules/Agenda/lib/agenda/purge.js","webpack:///../node_modules/Agenda/lib/agenda/define.js","webpack:///../node_modules/Agenda/lib/agenda/every.js","webpack:///../node_modules/Agenda/lib/agenda/schedule.js","webpack:///../node_modules/Agenda/lib/agenda/now.js","webpack:///../node_modules/Agenda/lib/agenda/cancel.js","webpack:///../node_modules/Agenda/lib/agenda/save-job.js","webpack:///../node_modules/Agenda/lib/agenda/start.js","webpack:///../node_modules/Agenda/lib/agenda/stop.js","webpack:///../node_modules/Agenda/lib/agenda/find-and-lock-next-job.js","webpack:///external \"lodash\"","webpack:///./models/journey_content.js"],"names":["session","journeys","joinableJourneys","loggedIn","user","location","global","__INITIAL_STATE__","FlagSchema","type","String","reason","JourneySpaceSchema","room","index","name","image","sessionId","journey","default","startAt","Date","add","toDate","flags","timestamps","plugin","states","created","started","completed","expired","transitions","start","from","to","end","expire","JourneySpace","model","dotenv","require","config","__CLIENT__","__SERVER__","routes","exports","app","agenda","db","address","process","env","MONGODB_URI","MONGO_URL","use","secret","saveUninitialized","resave","store","url","cookie","expires","set","join","__dirname","json","static","listen","PORT","console","log","connect","promisify","fn","promisified","params","Promise","resolve","reject","concat","err","args","length","opentok","OPENTOK_KEY","OPENTOK_SECRET","router","Router","generateToken","tokenOptions","role","token","get","req","res","findOne","exec","existingSession","createSession","save","find","present","lean","participants","response","toJSON","newSession","post","connectionId","body","id","connections","count","participantExists","participant","sendStatus","state","$gte","$ne","sort","messageData","userName","description","signal","data","JSON","stringify","connection","ready","allReady","readdirAsync","readdir","extname","file","journeyFiles","filter","map","put","push","event","destroy","clearCookie","redirect","fetch","headers","method","mode","then","JourneyParticipantSchema","Types","ObjectId","ref","Boolean","JourneyParticipant","context","originalUrl","html","renderToString","writeHead","Location","status","render","NODE_ENV","script","openTokKey","OTSession","OTPublisher","OTStreams","OTSubscriber","OT","RequireLoginRoute","Component","component","rest","renderProps","pathname","Login","props","login","e","preventDefault","credentials","history","field","setState","target","value","padding","width","onChange","propTypes","match","object","isRequired","JoinableJourneyCard","format","AutoCreatedJourneysQueue","roomUrl","sessionHelper","apiKey","onConnect","on","parse","idx","findIndex","j","_id","slice","App","Header","Home","streams","publisherId","totalConnectionsCreated","connectedUsers","publisher","setTimeout","refreshSession","referrer","onStreamsUpdated","window","sh","updatedConnectionCount","newData","d","indexOf","splice","tries","fetchRetry","displayMessageVisible","displayMessageText","sessionUrl","UserList","userCount","GeneratorForm","sessionLinkName","sessionLinkUrl","activeJourneys","handleNameChange","bind","urlFriendlyName","createSessionLink","replace","toLowerCase","EventMessage","backgroundColor","JourneySpaceForm","visible","toggleVisibility","border","JourneyDetailEntry","sessionVisible","nextProps","detailVisibility","SessionInfo","jumpToSession","sessionLink","sessionVisibility","open","fontWeight","polyfill","Room","onInitPublisher","onConfirmReady","onChangeJourney","cache","onStartSession","onLoadedMetadata","journeyDuration","duration","audioTag","removeEventListener","onTimeUpdate","addEventListener","playerProgress","currentTime","playerProgressMS","onFlag","playerState","publishAudio","play","disconnect","currentParticipant","currentUserHasFlaggedJourney","flag","display","position","top","right","split","flex","timeRemaining","container","gridTemplateColumns","gridGap","marginRight","stream","fontSize","bottom","seconds","minutes","Math","floor","remainingSeconds","toFixed","define","job","done","collection","aggregate","$sample","size","toArray","randomJourney","journeySpace","filePath","getTime","globalSpace","$lt","subtract","expiredJourneys","every","JourneyContentSchema","JourneyContent"],"mappings":"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AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;;;;;;ACzCA,oC;;;;;;;ACAA;AACA;;AAEA;AACA;AACA,WAAW,MAAM;AACjB,WAAW,EAAE;AACb,WAAW,OAAO;AAClB,WAAW,SAAS;AACpB,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,SAAS;AACpB,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,GAAG;AACH;;;;;;;;ACjDA;AACA;;AAEA;AACA;AACA,WAAW,OAAO;AAClB,aAAa,QAAQ;AACrB;AACA;AACA;AACA;AACA;AACA;;;;;;;;ACZA;AACA;AACA;;AAEA;AACA;AACA,WAAW,OAAO;AAClB,aAAa,QAAQ;AACrB;AACA;AACA;AACA;AACA;AACA;;;;;;;;ACbA;AACA;;AAEA;AACA;AACA,WAAW,OAAO;AAClB,aAAa,QAAQ;AACrB;AACA;AACA;AACA;AACA;AACA;;;;;;;;ACZA;AACA;;AAEA;AACA;AACA,WAAW,OAAO;AAClB,aAAa,QAAQ;AACrB;AACA;AACA;AACA;AACA;AACA;;;;;;;;ACZA;AACA;;AAEA;AACA;AACA;AACA,WAAW,OAAO;AAClB,aAAa,QAAQ;AACrB;AACA;AACA;AACA;AACA;AACA;;;;;;;;ACbA;AACA;;AAEA;AACA;AACA,WAAW,OAAO;AAClB,aAAa,QAAQ;AACrB;AACA;AACA;AACA;AACA;AACA;;;;;;;;ACZA;AACA;;AAEA;AACA;AACA;AACA,WAAW,OAAO;AAClB,aAAa,QAAQ;AACrB;AACA;AACA;AACA;AACA;AACA;;;;;;;;ACbA;AACA;;AAEA;AACA;AACA,eAAe;AACf,WAAW,OAAO;AAClB,aAAa,QAAQ;AACrB;AACA;AACA;AACA;AACA;AACA;;;;;;;;ACbA;AACA;AACA;;AAEA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB;AACA,aAAa,WAAW;AACxB;AACA;AACA;AACA;AACA,uBAAuB,mDAAmD;AAC1E;AACA;;;;;;;;AChBA;;AAEA;AACA;AACA,aAAa,OAAO;AACpB;AACA;AACA;AACA;AACA;;AAEA;AACA,UAAU;AACV;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;;;;;;;;ACzBA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,aAAa,QAAQ;AACrB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,OAAO;AACP,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;;;;;;AC3FA,iC;;;;;;ACAA,4C;;;;;;;ACAA;;AAEA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,aAAa,QAAQ;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;ACbA;;AAEA;AACA;AACA,WAAW,OAAO;AAClB,aAAa,QAAQ;AACrB;AACA;AACA;AACA;AACA;;;;;;;;ACVA;;AAEA;AACA;AACA,aAAa,QAAQ;AACrB;AACA;AACA;AACA;AACA;;;;;;;;ACTA;;AAEA;AACA;AACA,aAAa,QAAQ;AACrB;AACA;AACA;AACA;AACA;;;;;;;;ACTA;;AAEA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,aAAa,QAAQ;AACrB;AACA;AACA;AACA;AACA;AACA;;;;;;;;ACZA;AACA;;AAEA;AACA;AACA,WAAW,OAAO;AAClB,aAAa,QAAQ;AACrB;AACA;AACA;AACA;AACA;;;;;;;;ACXA;;AAEA;AACA;AACA,WAAW,cAAc;AACzB,aAAa,OAAO;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW,OAAO;AAClB,aAAa,QAAQ;AACrB;AACA;AACA;AACA;AACA;;;;;;;;AC7BA;AACA;;AAEA;AACA;AACA,WAAW,aAAa;AACxB,aAAa,QAAQ;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;ACnBA;AACA;;AAEA;AACA;AACA,WAAW,SAAS;AACpB,aAAa;AACb;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,wCAAwC;AACxC;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,KAAK;AACL,GAAG;AACH;;;;;;;;ACpEA;;AAEA;AACA;AACA;AACA;AACA;AACA,aAAa,QAAQ;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;ACpBA;;AAEA;AACA;AACA,WAAW,SAAS;AACpB,aAAa,QAAQ;AACrB;AACA;AACA;AACA;AACA;;;;;;;;ACVA;;AAEA;AACA;AACA,WAAW,SAAS;AACpB,aAAa;AACb;AACA;AACA,sBAAsB,oBAAoB;AAC1C;;;;;;;;ACTA;;AAEA;AACA;AACA,WAAW,SAAS;AACpB,aAAa;AACb;AACA;AACA;AACA;AACA;;;;;;;;ACVA;AACA;;AAEA;;AAEA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,SAAS;AACpB,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;;;;;;;ACpBA;AACA;AACA,iGAAiG;AACjG;AACA;;AAEA;AACA;AACA,WAAW,WAAW;AACtB,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAa,OAAO;AACpB,eAAe,QAAQ;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,aAAa,EAAE;AACf,aAAa,QAAQ;AACrB,eAAe;AACf;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,4BAA4B,iBAAiB;AAC7C;AACA;AACA;AACA;;AAEA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;;AAEA;AACA,oBAAoB,OAAO;AAC3B,qBAAqB;;AAErB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA,aAAa,OAAO;AACpB,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,oCAAoC,UAAU;AAC9C;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,aAAa,MAAM;AACnB,aAAa,WAAW;AACxB,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;;;;;;;AC7UA;AACA;;AAEA;AACA;AACA;AACA,WAAW,SAAS;AACpB,aAAa;AACb;AACA;AACA;AACA;AACA,eAAe,OAAO,OAAO,oBAAoB;AACjD;;;;;;;;ACbA;AACA;;AAEA;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,SAAS;AACpB,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;AC1BA;AACA;;AAEA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,EAAE;AACb,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,SAAS;AACpB,aAAa,EAAE;AACf;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA,aAAa,OAAO;AACpB,aAAa,EAAE;AACf,aAAa,OAAO;AACpB,aAAa,OAAO;AACpB,aAAa,SAAS;AACtB,eAAe,WAAW;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,aAAa,OAAO;AACpB,aAAa,EAAE;AACf,aAAa,OAAO;AACpB,aAAa,OAAO;AACpB,aAAa,SAAS;AACtB,eAAe,EAAE;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,OAAO;AACP,KAAK;AACL;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;;;;;;;ACjFA;AACA;;AAEA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,EAAE;AACb,WAAW,OAAO;AAClB,WAAW,SAAS;AACpB,aAAa,EAAE;AACf;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,aAAa,OAAO;AACpB,aAAa,OAAO;AACpB,aAAa,OAAO;AACpB,aAAa,SAAS;AACtB,eAAe,WAAW;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,aAAa,OAAO;AACpB,aAAa,EAAE;AACf,aAAa,OAAO;AACpB,aAAa,SAAS;AACtB,eAAe,EAAE;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,OAAO;AACP,KAAK;AACL;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;;;;;;;ACzEA;AACA;;AAEA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,SAAS;AACpB,aAAa,WAAW;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;ACpBA;AACA;;AAEA;AACA;AACA,YAAY,OAAO;AACnB,YAAY,SAAS;AACrB;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,GAAG;AACH;;;;;;;;ACtBA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,WAAW,WAAW;AACtB,WAAW,SAAS;AACpB,aAAa;AACb;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,gBAAgB;AAChB;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,gBAAgB;AAChB;;AAEA;AACA;AACA,sDAAsD,oCAAoC;AAC1F,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa,MAAM;AACnB,aAAa,EAAE;AACf;AACA,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;;;;;;;AC9IA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;;;;;;;AClBA;AACA;;AAEA;AACA;AACA,WAAW,SAAS;AACpB,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,SAAS;AACtB;AACA,eAAe;AACf;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,iCAAiC,MAAM,aAAa,GAAG,OAAO,gBAAgB;AAC9E;AACA;AACA;;AAEA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;;;;;;;;AC1CA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,SAAS;AACpB;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA,oBAAoB,uBAAuB;AAC3C,mBAAmB;AACnB,OAAO;AACP;AACA,mBAAmB,eAAe;AAClC,oBAAoB,uBAAuB;AAC3C,mBAAmB;AACnB,OAAO;AACP;AACA,mBAAmB,mBAAmB;AACtC,mBAAmB;AACnB,OAAO;AACP;;AAEA;AACA;AACA,cAAc,OAAO;AACrB;AACA,mCAAmC,OAAO;;AAE1C;AACA;AACA,cAAc;AACd;AACA,8BAA8B;;AAE9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;;;;;;;ACnFA,mC;;;;;;;;;;;;;ACAA;;;;;;AAEA,IAAMkS,uBAAuB,qBAAW;AACtCP,YAAU,EAACnT,MAAMC,MAAP,EAD4B;AAEtCM,SAAO,EAACP,MAAMC,MAAP;AAF+B,CAAX,EAG1B;AACDe,cAAY;AADX,CAH0B,CAA7B;;AAOA,IAAM2S,iBAAiB,mBAAS7R,KAAT,CAAe,gBAAf,EAAiC4R,oBAAjC,CAAvB;;kBAEeC,c","file":"./server.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 22);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 9e82fc0f97d2b28a1061","module.exports = require(\"debug\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"debug\"\n// module id = 0\n// module chunks = 0","module.exports = require(\"react\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"react\"\n// module id = 1\n// module chunks = 0","import { store } from 'react-easy-state'\n\nexport default store({\n  session: null,\n  journeys: [],\n  joinableJourneys: [],\n  loggedIn: false,\n  user: null,\n  location: '/',\n  ...(global.__INITIAL_STATE__ || {})\n});\n\n\n\n// WEBPACK FOOTER //\n// ../client/src/state.js","module.exports = require(\"mongoose\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"mongoose\"\n// module id = 3\n// module chunks = 0","module.exports = require(\"react-easy-state\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"react-easy-state\"\n// module id = 4\n// module chunks = 0","const createJob = require('./create-job');\nconst processJobs = require('./process-jobs');\n\nmodule.exports = {\n  createJob,\n  processJobs\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/lib/utils/index.js\n// module id = 5\n// module chunks = 0","module.exports = require(\"path\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"path\"\n// module id = 6\n// module chunks = 0","module.exports = require(\"express\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"express\"\n// module id = 7\n// module chunks = 0","module.exports = require(\"moment\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"moment\"\n// module id = 8\n// module chunks = 0","module.exports = require(\"opentok-react\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"opentok-react\"\n// module id = 9\n// module chunks = 0","module.exports = require(\"@opentok/client\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"@opentok/client\"\n// module id = 10\n// module chunks = 0","module.exports = require(\"human-interval\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"human-interval\"\n// module id = 11\n// module chunks = 0","module.exports = require(\"dotenv\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"dotenv\"\n// module id = 12\n// module chunks = 0","module.exports = require(\"fs\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"fs\"\n// module id = 13\n// module chunks = 0","module.exports = require(\"opentok\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"opentok\"\n// module id = 14\n// module chunks = 0","import mongoose, {Schema} from 'mongoose';\nimport statemachine from 'another-mongoose-statemachine';\nimport moment from 'moment';\n\nconst FlagSchema = new Schema({\n  user: {type: String},\n  reason: {type: String},\n});\n\nconst JourneySpaceSchema = new Schema({\n  room: {type: String, index: true},\n  name: {type: String, index: true},\n  image: {type: String},\n  sessionId: {type: String, index: true},\n  journey: {type: String, default: '/journeys/Journey to A Spiderweb+Music.mp3'},\n  startAt: {type: Date, default: () => moment().add(10, 'minutes').toDate()},\n  flags: {type: [FlagSchema], default: []},\n}, {\n  timestamps: true\n});\n\nJourneySpaceSchema.plugin(statemachine, {\n  states: {\n    created: {default: true},\n    started: {},\n    completed: {},\n    expired: {},\n  },\n  transitions: {\n    start: { from: 'created', to: 'started' },\n    end: { from: '*', to: 'completed' },\n    expire: { from: '*', to: 'expired' },\n  }\n});\n\nconst JourneySpace = mongoose.model('JourneySpace', JourneySpaceSchema);\n\nexport default JourneySpace;\n\n\n\n\n// WEBPACK FOOTER //\n// ./models/journey_space.js","module.exports = require(\"isomorphic-fetch\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"isomorphic-fetch\"\n// module id = 16\n// module chunks = 0","module.exports = require(\"react-router\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"react-router\"\n// module id = 17\n// module chunks = 0","module.exports = require(\"prop-types\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"prop-types\"\n// module id = 18\n// module chunks = 0","'use strict';\n\n/**\n * Internal method to turn priority into a number\n * @param {String|Number} priority string to parse into number\n * @returns {Number} priority that was parsed\n */\nconst parsePriority = priority => {\n  const priorityMap = {\n    lowest: -20,\n    low: -10,\n    normal: 0,\n    high: 10,\n    highest: 20\n  };\n  if (typeof priority === 'number' || priority instanceof Number) {\n    return priority;\n  }\n  return priorityMap[priority];\n};\n\nclass Job {\n  constructor(args) {\n    args = args || {};\n\n    // Remove special args\n    this.agenda = args.agenda;\n    delete args.agenda;\n\n    // Process args\n    args.priority = parsePriority(args.priority) || 0;\n\n    // Set attrs to args\n    const attrs = {};\n    for (const key in args) {\n      if ({}.hasOwnProperty.call(args, key)) {\n        attrs[key] = args[key];\n      }\n    }\n\n    // Set defaults if undefined\n    // NOTE: What is the difference between 'once' here and 'single' in agenda/index.js?\n    attrs.nextRunAt = attrs.nextRunAt || new Date();\n    attrs.type = attrs.type || 'once';\n    this.attrs = attrs;\n  }\n}\n\nJob.prototype.toJSON = require('./to-json');\nJob.prototype.computeNextRunAt = require('./compute-next-run-at');\nJob.prototype.repeatEvery = require('./repeat-every');\nJob.prototype.repeatAt = require('./repeat-at');\nJob.prototype.disable = require('./disable');\nJob.prototype.enable = require('./enable');\nJob.prototype.unique = require('./unique');\nJob.prototype.schedule = require('./schedule');\nJob.prototype.priority = require('./priority');\nJob.prototype.fail = require('./fail');\nJob.prototype.run = require('./run');\nJob.prototype.isRunning = require('./is-running');\nJob.prototype.save = require('./save');\nJob.prototype.remove = require('./remove');\nJob.prototype.touch = require('./touch');\n\nmodule.exports = Job;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/lib/job/index.js\n// module id = 19\n// module chunks = 0","module.exports = require(\"date.js\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"date.js\"\n// module id = 20\n// module chunks = 0","'use strict';\nconst Job = require('../job');\n\n/**\n * Create Job object from data\n * @param {Object} agenda instance of Agenda\n * @param {Object} jobData job data\n * @returns {module.Job} returns created job\n */\nmodule.exports = (agenda, jobData) => {\n  jobData.agenda = agenda;\n  return new Job(jobData);\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/lib/utils/create-job.js\n// module id = 21\n// module chunks = 0","module.exports = require(\"babel-polyfill/lib/index\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"babel-polyfill/lib/index\"\n// module id = 23\n// module chunks = 0","const dotenv = require('dotenv');\n\ndotenv.config();\nglobal.__CLIENT__ = false;\nglobal.__SERVER__ = true;\n\nconst routes = require('./routes');\nrequire('./jobs');\n\nexports = routes;\n\n\n\n// WEBPACK FOOTER //\n// ./index.js","import path from 'path';\nimport express from 'express';\nimport bodyParser from 'body-parser';\nimport api from './api';\nimport ssr from './ssr';\n\nimport Agenda from 'agenda';\nimport Agendash from 'agendash';\n\nimport session from 'express-session';\nimport createMongoStore from 'connect-mongo';\n\n\nconst app = express();\nconst agenda = new Agenda({db: {address: process.env.MONGODB_URI || process.env.MONGO_URL}});\n\napp.use(session({\n    secret: 'qVaNxeu5VVEAtkyFJ/62EKcp7Lw=',\n    saveUninitialized: false, // don't create session until something stored\n\t  resave: false, //don't save session if unmodified\n    store: new (createMongoStore(session))({url: process.env.MONGODB_URI || process.env.MONGO_URL}),\n    cookie: {expires: new Date(253402300000000)}\n}));\n\napp.use('/jobs', Agendash(agenda));\n\napp.set('view engine', 'ejs');\napp.set('views', path.join(__dirname, '../views'));\napp.use(bodyParser.json());\n\napp.use(express.static(path.join(__dirname, '..', 'public')));\n\napp.use('/api', api);\napp.use('/*', ssr);\n\napp.listen(process.env.PORT || 5000, () => {\n  console.log('Hello World listening on port 5000!');\n});\n\n\n\n// WEBPACK FOOTER //\n// ./routes/index.js","module.exports = require(\"body-parser\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"body-parser\"\n// module id = 26\n// module chunks = 0","import fs from 'fs';\nimport path from 'path';\nimport express from 'express';\nimport OpenTok from 'opentok';\nimport mongoose from 'mongoose';\nimport JourneySpace from '../models/journey_space';\nimport JourneyParticipant from '../models/journey_participant';\nimport dotenv from 'dotenv';\nrequire('isomorphic-fetch');\n\ndotenv.config();\n\nmongoose.connect(process.env.MONGODB_URI || process.env.MONGO_URL);\n\nfunction promisify(fn) {\n  /**\n   * @param {...Any} params The params to pass into *fn*\n   * @return {Promise<Any|Any[]>}\n   */\n  return function promisified(...params) {\n    return new Promise((resolve, reject) => fn(...params.concat([(err, ...args) => err ? reject(err) : resolve( args.length < 2 ? args[0] : args )])))\n  }\n}\n\nconst opentok = new OpenTok(process.env.OPENTOK_KEY, process.env.OPENTOK_SECRET);\nconst router = express.Router();\n\nfunction generateToken(sessionId) {\n\tlet tokenOptions = {};\n\ttokenOptions.role = \"publisher\";\n\t// Generate a token.\n\tconst token = opentok.generateToken(sessionId, tokenOptions);\n  console.log('return token', token);\n\treturn token;\n}\n\n// TODO: switch to POST, just using GET for easier testing\nrouter.get('/sessions/:room', async (req, res) => {\n\tconst {room} = req.params;\n\tconst existingSession = await JourneySpace.findOne({room}).exec();\n\tif (existingSession) {\n    if (!existingSession.sessionId) {\n      const session = await new Promise((resolve, reject) => {\n        opentok.createSession(async (err, session) => {\n          if (err) reject(err);\n          resolve(session);\n        });\n      });\n      existingSession.sessionId = session.sessionId;\n      await existingSession.save();\n    }\n    const participants = await JourneyParticipant.find({session: existingSession, present: true}).lean().exec();\n    const response = existingSession.toJSON();\n    response.participants = participants;\n\t\tres.json({\n\t\t\t...response,\n\t\t\ttoken: generateToken(existingSession.sessionId),\n\t\t});\n\t} else {\n\t\topentok.createSession(async (err, session) => {\n\t\t  if (err) throw err;\n\t\t\t// save the sessionId\n\t\t\tconst newSession = new JourneySpace({room, sessionId: session.sessionId});\n\t\t\tawait newSession.save();\n\t\t\tres.json({\n\t\t\t\t...newSession.toJSON(),\n\t\t\t\ttoken: generateToken(session.sessionId),\n\t\t\t});\n\t\t});\n\t}\n});\n\nrouter.post('/sessions/:room/joined', async (req, res) => {\n\tconst {room} = req.params;\n  const {id: connectionId} = req.body;\n  req.session.connections = req.session.connections || {};\n  req.session.connections[room] = connectionId;\n\tconst existingSession = await JourneySpace.findOne({room}).lean().exec();\n\tif (existingSession) {\n      const participantExists = (await JourneyParticipant.count({session: existingSession, connectionId})) > 0;\n      if (!participantExists) {\n        const participant = new JourneyParticipant({session: existingSession, connectionId: connectionId, user: req.session.user});\n        await participant.save();\n      }\n  }\n  res.sendStatus(200);\n});\n\nrouter.get('/sessions/:room/:connectionId', async (req, res) => {\n  const {room, connectionId} = req.params;\n\tconst existingSession = await JourneySpace.findOne({room}).lean().exec();\n\tif (existingSession) {\n    const participant = await JourneyParticipant.findOne({session: existingSession, connectionId}).exec();\n    res.json(participant);\n    return;\n  }\n  res.sendStatus(500);\n});\n\nrouter.get('/active_journeys', async(req, res) => {\n  const journeys = await JourneySpace.find({state: 'created', startAt: {$gte: new Date()}, room: {$ne: 'temp-home-location'}}).sort({startAt: 1}).exec();\n  res.json(journeys);\n});\n\n// TEMP: Use get for convenience. hardcode temp-home-location for the room\n// Trigger a general announcement to everyone\nrouter.get('/sessions/test/temp-home-location', async (req, res) => {\n  // const {room, connection} = req.params;\n  const existingSession = await JourneySpace.findOne({room:'temp-home-location'}).exec();\n  if (existingSession) {\n  console.log(\"**** SENDING SIGNAL\")\n  let messageData = {\n    userName: \"Bob\",\n    description: \"some text\",\n    url: \"http://www.news.google.com\"\n  }\n\n  signal(existingSession.sessionId, {type: 'displayJourneyRequest', data: JSON.stringify(messageData)});\n  return res.sendStatus(200);\n  }\n  res.sendStatus(200);\n});\n\nrouter.get('/sessions/:room/connections/:connection/ready', async (req, res) => {\n  const {room, connection} = req.params;\n  const existingSession = await JourneySpace.findOne({room}).exec();\n\tif (existingSession) {\n    const participant = await JourneyParticipant.findOne({session: existingSession, connectionId: connection});\n    participant.ready = true;\n    await participant.save();\n    signal(existingSession.sessionId, {type: 'ready', data: 'foo'});\n    const allReady = (await JourneyParticipant.count({session: existingSession, ready: false, present: true})) === 0;\n    if (allReady) {\n      // signal(existingSession.sessionId, {type: 'startJourney', data: 'foo'});\n    }\n    return res.sendStatus(200);\n  }\n  res.sendStatus(200);\n});\n\nrouter.get('/journeys', async (req, res) => {\n  const readdirAsync = promisify(fs.readdir)\n  const journeyFiles = (await readdirAsync(path.join(__dirname, '..', 'public/journeys'))).filter(file => {\n    return path.extname(file) === '.mp3';\n  }).map(file => {\n    return `/journeys/${file}`\n  });\n  res.json(journeyFiles);\n});\n\nrouter.put('/sessions/:room/journey', async (req, res) => {\n  const {journey} = req.body;\n  const {room} = req.params;\n  const existingSession = await JourneySpace.findOne({room}).exec();\n\tif (existingSession) {\n    existingSession.journey = journey;\n    await existingSession.save();\n    signal(existingSession.sessionId, {type: 'updatedJourney', data: journey});\n  }\n  res.sendStatus(200);\n});\n\n// TODO: this should really verify that the user hitting this endpoint is authorized to do so (e.g. that they are the journey's host)\nrouter.post('/sessions/:room/start', async (req, res) => {\n  const {room} = req.params;\n  const existingSession = await JourneySpace.findOne({room}).exec();\n\tif (existingSession) {\n    await existingSession.start();\n    signal(existingSession.sessionId, {type: 'startJourney', data: ''});\n  }\n});\n\nrouter.post('/sessions/:room/flag', async (req, res) => {\n  const {room} = req.params;\n  const {connectionId} = req.body;\n  const existingSession = await JourneySpace.findOne({room}).exec();\n\tif (existingSession) {\n    existingSession.flags.push({user: connectionId});\n    await existingSession.save();\n    const participants = await JourneyParticipant.find({session: existingSession, present: true}).lean().exec();\n    return res.json({...existingSession.toJSON(), participants});\n  }\n  res.sendStatus(404);\n});\n\nrouter.post('/event', async (req, res) => {\n  console.log('GOT EVENT', req.body);\n  res.sendStatus(200);\n  const {sessionId, connection} = req.body;\n  const session = await JourneySpace.findOne({sessionId}).exec();\n\n  console.log(\"*******\" + req.body)\n\n  switch(req.body.event) {\n    case 'connectionCreated':\n      if (session) {\n        const participantExists = (await JourneyParticipant.count({session, connectionId: connection.id})) > 0;\n        if (!participantExists) {\n          const participant = new JourneyParticipant({session, connectionId: connection.id});\n          await participant.save();\n        }\n      }\n      break;\n    case 'connectionDestroyed':\n      if (session) {\n        const participant= await JourneyParticipant.findOne({session, connectionId: connection.id});\n        if (participant) {\n          participant.present = false;\n          await participant.save();\n        }\n      }\n      break\n  }\n});\n\nrouter.post('/login', (req, res) => {\n  req.session.loggedIn = true;\n  req.session.user = {\n    name: req.body.name\n  };\n  res.json({loggedIn: true, user: {name: req.body.name}});\n});\n\nrouter.get('/logout', (req, res) => {\n  req.session.destroy(() => {\n      res\n        .clearCookie('connect.sid')\n        .redirect('/login')\n    });\n});\n\nfunction signal(sessionId, data) {\n  fetch(`https://api.opentok.com/v2/project/${process.env.OPENTOK_KEY}/session/${sessionId}/signal`, {\n    headers: {\n      'X-TB-PARTNER-AUTH': `${process.env.OPENTOK_KEY}:${process.env.OPENTOK_SECRET}`\n    },\n    method: 'POST',\n    mode: 'cors',\n    body: JSON.stringify(data)\n  }).then(response => console.log(response));\n}\n\nexport default router;\n\n\n\n\n// WEBPACK FOOTER //\n// ./routes/api.js","module.exports = require(\"another-mongoose-statemachine\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"another-mongoose-statemachine\"\n// module id = 28\n// module chunks = 0","import mongoose, {Schema} from 'mongoose';\n\nconst JourneyParticipantSchema = new Schema({\n  \"connectionId\": {type: String, index: true},\n  \"session\": {type: Schema.Types.ObjectId, ref: 'JourneySpace'},\n  \"ready\": {type: Boolean, default: false},\n  \"present\": {type: Boolean, default: true},\n  user: new Schema({name: String})\n});\n\nconst JourneyParticipant = mongoose.model('JourneyParticipant', JourneyParticipantSchema);\n\nexport default JourneyParticipant;\n\n\n\n\n// WEBPACK FOOTER //\n// ./models/journey_participant.js","import express from 'express';\nimport React from 'react';\nimport ReactDOMServer from 'react-dom/server';\nimport { createStore } from 'redux';\nimport { Provider } from 'react-redux';\nimport { StaticRouter } from 'react-router';\nimport App from '../../client/src/app';\nimport state from '../../client/src/state';\n\nconst router = express.Router();\n\nrouter.get('/', (req, res) => {\n  const context = {};\n\n  state.loggedIn = req.session.loggedIn;\n  state.user = req.session.user;\n  console.log('GOT SESSION', req.session, req.originalUrl);\n\n  const html = ReactDOMServer.renderToString(\n    <StaticRouter\n      location={req.originalUrl}\n      context={context}\n    >\n      <App />\n    </StaticRouter>\n  );\n\n  console.log('GOT HTML', html, context.url);\n  if (context.url) {\n    console.log('REDIRECT');\n    if (req.originalUrl != '/favicon.ico') {\n      res.writeHead(301, {\n        Location: context.url,\n      });\n    }\n    res.end();\n  } else {\n    res.status(200).render(process.env.NODE_ENV === 'production' ? 'index.ejs' : 'index.dev.ejs', {\n      html,\n      script: JSON.stringify({openTokKey: process.env.OPENTOK_KEY, loggedIn: req.session.loggedIn, user: req.session.user}),\n    });\n  }\n});\n\n\nexport default router;\n\n\n\n// WEBPACK FOOTER //\n// ./routes/ssr.js","module.exports = require(\"react-dom/server\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"react-dom/server\"\n// module id = 31\n// module chunks = 0","module.exports = require(\"redux\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"redux\"\n// module id = 32\n// module chunks = 0","module.exports = require(\"react-redux\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"react-redux\"\n// module id = 33\n// module chunks = 0","import React, {Component} from 'react';\nimport { Route, Redirect, Switch } from 'react-router-dom';\nimport { withRouter } from 'react-router';\nimport { view } from 'react-easy-state';\nimport PropTypes from 'prop-types';\nimport moment from 'moment';\nimport Header from './components/header';\nimport Home from './components/home';\nimport Room from './components/Room';\nimport state from './state';\n\nvar { OTSession, OTPublisher, OTStreams, OTSubscriber, createSession } = {};\n\nif (__CLIENT__) {\n  var { OTSession, OTPublisher, OTStreams, OTSubscriber, createSession } = require('opentok-react');\n  const OT = require('@opentok/client');\n}\n\n\nconst RequireLoginRoute = ({component: Component, ...rest}) => {\n  return (\n    <Route {...rest} render={renderProps => {\n        return (\n          state.loggedIn ?\n            <Component {...renderProps} />\n          : <Redirect to={ {\n                pathname: '/login'\n            }} />\n        )\n    }}/>\n  )\n};\n\nclass Login extends Component {\n  static propTypes = {\n    match: PropTypes.object.isRequired,\n    location: PropTypes.object.isRequired,\n    history: PropTypes.object.isRequired\n  }\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      name: ''\n    }\n  }\n  \n  onChange(field) {\n    return (e) => {\n      this.setState({\n        [field]: e.target.value\n      });\n    }\n  }\n\n  login = (e) => {\n    e.preventDefault();\n    fetch(`/api/login`, {\n      body: JSON.stringify({name: this.state.name}), // must match 'Content-Type' header\n      method: 'POST', // *GET, POST, PUT, DELETE, etc.\n      credentials: 'same-origin',\n      headers: {\n        'content-type': 'application/json'\n      }\n    })\n    .then(response => response.json())\n    .then(json => {\n      state.loggedIn = json.loggedIn;\n      state.user = json.user;\n      this.props.history.push('/');\n    });\n  }\n\n  render() {\n    return (\n      <div style={{padding: '20px', width: '50%'}}>\n        <form onSubmit={this.login}>\n          <div className=\"form-group\">\n            <label htmlFor=\"name\">Name</label>\n            <input type=\"text\" onChange={this.onChange('name')} value={this.state.name} className=\"form-control\" id=\"name\" aria-describedby=\"nameHelp\" placeholder=\"Enter name\"/>\n          </div>\n          <button type=\"submit\" className=\"btn btn-primary\">Submit</button>\n        </form>\n      </div>\n    )\n  }\n}\n\nclass JoinableJourneyCard extends Component {\n  render() {\n    const {journey} = this.props;\n\n    return (\n      <div className='joinable-journey-card'>\n        <div className='image'>\n          <img src={journey.image}/>\n        </div>\n        <div className='content'>\n          <p>{journey.name}</p>\n          <p>Starts at: {moment(journey.startAt).format('LT')}</p>\n          <a href={`/${journey.room}`} className='btn btn-primary'>Join</a>\n        </div>\n      </div>\n    )\n  }\n}\n\nclass AutoCreatedJourneysQueue extends Component {\n  \n  componentDidMount() {\n    const roomUrl = 'temp-home-location'\n\n    // subscribe to global events\n    fetch(`/api/sessions/${roomUrl}`)\n      .then(res => res.json())\n      .then(json => {\n        state.session = json;\n        this.sessionHelper = createSession({\n          apiKey: state.openTokKey,\n          sessionId: state.session.sessionId,\n          token: state.session.token,\n          onConnect: () => {\n          }\n        });\n\n        this.sessionHelper.session.on(\"signal:createdNewJourney\", (event) => {\n          state.joinableJourneys.push(JSON.parse(event.data));\n        });\n\n        this.sessionHelper.session.on(\"signal:expiredJourney\", (event) => {\n          const journey = JSON.parse(event.data);\n          const idx = state.joinableJourneys.findIndex(j => j._id === journey._id);\n          state.joinableJourneys = [...state.joinableJourneys.slice(0, idx), ...state.joinableJourneys.slice(idx + 1)];\n        });\n        \n      });\n\n\n    // fetch currently active journeys\n    fetch('/api/active_journeys')\n      .then(res => res.json())\n      .then(json => {\n        state.joinableJourneys = json;\n      });\n  }\n\n  render() {\n    return (\n      <div className='joinable-journeys'>\n        {state.joinableJourneys.map(journey => <JoinableJourneyCard journey={journey}/>)}\n      </div>\n    )\n  }\n}\n\nclass App extends Component {\n  render() {\n    return (\n      <div>\n        <Header />\n        <Switch>\n          <Route exact path=\"/login\" component={withRouter(Login)} />\n          <Route exact path=\"/join\" component={view(AutoCreatedJourneysQueue)} />\n          <Route exact path=\"/\" component={Home} />\n          <Route exact path=\"/:room\" component={Room} />\n        </Switch>\n      </div>\n    )\n  }\n}\n\nexport default withRouter(view(App));\n\n\n\n// WEBPACK FOOTER //\n// ../client/src/app.js","module.exports = require(\"react-router-dom\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"react-router-dom\"\n// module id = 35\n// module chunks = 0","import React from 'react';\nimport { view } from 'react-easy-state';\nimport state from '../state';\n\nconst Header = () => (\n  <div className=\"header pl-4\">\n    <h1>Get started with Wacuri!</h1>\n    {state.loggedIn && state.user &&\n      <div>\n        <span className='mr-2 text-secondary'>logged in as {state.user.name}</span>\n        <a href='/api/logout'>Logout</a>\n      </div>\n    }\n  </div>\n);\n\nexport default view(Header);\n\n\n\n// WEBPACK FOOTER //\n// ../client/src/components/header.js","import React, { Component } from 'react';\nimport UserList from './user_list'\nimport GeneratorForm from './generator_form'\nimport EventMessage from './event_message'\nimport JourneySpaceForm from './journey_space_form'\nimport state from '../state'\n\n\nvar { OTSession, OTPublisher, OTStreams, OTSubscriber, createSession } = {};\n\nif (__CLIENT__) {\n  var { OTSession, OTPublisher, OTStreams, OTSubscriber, createSession } = require('opentok-react');\n  const OT = require('@opentok/client');\n}\n\nexport default class Home extends Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      streams: [],\n      publisherId: '',\n      session: null,\n      totalConnectionsCreated: 0,\n      connectedUsers: []\n    }\n    this.publisher = {};\n  }\n\n  componentDidMount() {\n    const roomUrl = 'temp-home-location'\n\n    fetch(`/api/sessions/${roomUrl}`)\n      .then(res => res.json())\n      .then(json => {\n        state.session = json;\n        this.sessionHelper = createSession({\n          apiKey: state.openTokKey,\n          sessionId: state.session.sessionId,\n          token: state.session.token,\n          onConnect: () => {\n            setTimeout(this.refreshSession, 1000);\n            fetch(`/api/sessions/${roomUrl}/joined`, {\n              body: JSON.stringify({id: this.sessionHelper.session.connection.id}),\n              credentials: 'same-origin', // include, same-origin, *omit\n              headers: {\n                'user-agent': 'Mozilla/4.0 MDN Example',\n                'content-type': 'application/json'\n              },\n              method: 'POST', // *GET, POST, PUT, DELETE, etc.\n              mode: 'cors', // no-cors, cors, *same-origin\n              redirect: 'follow', // manual, *follow, error\n              referrer: 'no-referrer', // *client, no-referrer\n            });\n          },\n          onStreamsUpdated: streams => {\n            this.setState({ streams });\n          }\n        });\n        window.sh = this.sessionHelper;\n        this.sessionHelper.session.on(\"connectionDestroyed\", (event) => {\n          const data = {\n            sessionId: this.sessionHelper.session.sessionId,\n            connection: {\n              id: event.connection.id\n            },\n            event: 'connectionDestroyed',\n\n          }\n\n          const updatedConnectionCount = this.state.totalConnectionsCreated - 1\n          this.setState({totalConnectionsCreated: updatedConnectionCount})\n\n          let newData = [...this.state.connectedUsers]\n          let index = newData.map(d => d.connectionId).indexOf(event.connection.id)\n          newData.splice(index, 1)\n          this.setState({connectedUsers: newData})\n        });\n\n\n\n        this.sessionHelper.session.on(\"connectionCreated\", (event) => {\n          const updatedConnectionCount = this.state.totalConnectionsCreated + 1\n          this.setState({totalConnectionsCreated: updatedConnectionCount})\n\n          const data = {\n            sessionId: this.sessionHelper.session.sessionId,\n            connection: {\n              id: event.connection.id\n            },\n            event: 'connectionCreated',\n          }\n\n          let tries = 10;\n          const fetchRetry = () => {\n            fetch(`/api/sessions/${roomUrl}/${event.connection.id}`).then(res => res.json()).then(json => {\n              if (!json && tries-- > 0) {\n                setTimeout(fetchRetry, 500);\n              } else {\n                this.setState({\n                  connectedUsers: [...this.state.connectedUsers, json]\n                });\n              }\n            });\n          }\n          fetchRetry();\n        });\n\n\n\n        this.sessionHelper.session.on(\"signal\", (event) => {\n          if (event.type === 'signal:displayJourneyRequest') {\n            this.setState({\n              displayMessageVisible: true,\n              displayMessageText: \"George has created a session 'Daily Jetsons Meditation'.\", //TEMP hard coded\n              sessionUrl: '/another-jetsons-url'\n            });\n          }\n        });\n\n        this.setState({\n          session: this.sessionHelper.session\n        });\n      });\n\n\n    fetch('/api/journeys')\n      .then(res => res.json())\n      .then(json => {\n        state.journeys = json;\n      });\n\n  }\n\n  render() {\n    return (\n      <div className=\"home container\">\n        <div className=\"row\">\n          <UserList userCount={this.state.totalConnectionsCreated} connections={this.state.connectedUsers} />\n          <div className=\"col-sm\">\n            <JourneySpaceForm />\n            <EventMessage journeys={state.journeys} />\n          </div>\n        </div>\n      </div>\n      )\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ../client/src/components/home.js","import React, {Component} from 'react'\n\nexport default class UserList extends Component {\n  constructor(props) {\n    super(props);\n  }\n\n  render() {\n    return (\n      <div className=\"col-sm\">\n        <h4>Current Users ({this.props.userCount})</h4>\n        <ul>\n          {this.props.connections.map(function(connection){\n            return <li key={connection.user.name}>{connection.user.name}</li>;\n          })}\n        </ul>\n      </div>\n    )\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ../client/src/components/user_list.js","import React, {Component} from 'react'\nimport state from '../state';\n\nexport default class GeneratorForm extends Component {\n\n  constructor(props){\n    super(props)\n    this.state = {\n      sessionLinkName: '',\n      sessionLinkUrl: '',\n      activeJourneys: []\n    }\n\n    this.handleNameChange = this.handleNameChange.bind(this)\n    this.urlFriendlyName = this.urlFriendlyName.bind(this)\n    this.createSessionLink = this.createSessionLink.bind(this)\n\n  }\n\n  createSessionLink() {\n    this.setState({sessionLinkUrl: this.urlFriendlyName(this.state.sessionLinkName) })\n    fetch('/api/sessions/test/temp-home-location')\n\n    fetch('/api/active_journeys')\n    .then(res => res.json())\n    .then(json => {\n      state.activeJourneys = json\n    });\n  }\n\n  sendNotifications() {\n\n  }\n\n  handleNameChange(event) {\n    this.setState({sessionLinkName: event.target.value})\n  }\n\n  urlFriendlyName(name){\n    return name.replace(/\\s+/g, '-').toLowerCase()\n  }\n\n\n  render() {\n      return(\n        <div>Hello</div>\n      )\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ../client/src/components/generator_form.js","import React from 'react'\n\nconst EventMessage = (props) => {\n  return (\n    <div className=\"col-sm\">\n      {props.journeys.map((journey, index) => (\n        <p key={index}\n           style={{ backgroundColor: '#fc9', padding: '7px'}}>\n           A journey space has been created.\n           <br/>\n           <a href={\"/\" + journey.room} target=\"_blank\">Join</a>\n           &nbsp;&nbsp;\n           <a href=\"#\">Share</a></p>\n      ))}\n    </div>\n  );\n}\n\nexport default EventMessage\n\n\n\n// WEBPACK FOOTER //\n// ../client/src/components/event_message.js","import React, {Component} from 'react'\nimport JourneyDetailEntry from './journey_detail_entry'\n\nexport default class JourneySpaceForm extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      visible: false\n    }\n\n    this.toggleVisibility = this.toggleVisibility.bind(this)\n  }\n\n  toggleVisibility() {\n    this.setState({visible: !this.state.visible})\n  }\n\n  render() {\n      return (\n        <div className=\"col-sm\">\n          <div className=\"container\" style={{ border: '1px solid #e6e6e6', padding:'10px'}}>\n            <form>\n              <button type=\"button\" className=\"btn btn-outline-primary btn-block\" onClick={this.toggleVisibility}>\n                <i className=\"fa fa-plus\"></i>&nbsp;&nbsp;Create a new Journey Space\n              </button>\n              <JourneyDetailEntry detailVisibility={this.state.visible} />\n            </form>\n          </div>\n        </div>\n      )\n  }\n\n\n}\n\n\n// WEBPACK FOOTER //\n// ../client/src/components/journey_space_form.js","import React, {Component} from 'react'\nimport SessionInfo from './session_info'\n\nexport default class JourneyDetailEntry extends Component {\n\n    constructor(props){\n    super(props)\n    this.state = {\n      visible: false,\n      sessionVisible: false,\n      sessionLinkName: '',\n      sessionLinkUrl: '',\n      activeJourneys: []\n    }\n\n    this.handleNameChange = this.handleNameChange.bind(this)\n    this.urlFriendlyName = this.urlFriendlyName.bind(this)\n    this.createSessionLink = this.createSessionLink.bind(this)\n\n  }\n\n  createSessionLink() {\n    this.setState({sessionLinkUrl: this.urlFriendlyName(this.state.sessionLinkName) })\n    fetch('/api/sessions/test/temp-home-location')\n\n    fetch('/api/active_journeys')\n    .then(res => res.json())\n    .then(json => {\n      state.activeJourneys = json\n      this.setState({sessionVisible: true})\n    });\n  }\n\n  handleNameChange(event) {\n    this.setState({sessionLinkName: event.target.value})\n  }\n\n  urlFriendlyName(name){\n    return name.replace(/\\s+/g, '-').toLowerCase()\n  }\n\n\n  componentWillReceiveProps(nextProps) {\n    this.setState({ visible: nextProps.detailVisibility});\n  }\n\n\n  render() {\n    if(this.state.visible === true) {\n    return (\n      <div>\n        <h3>Enter Journey Details</h3>\n        <p>\n          Give your room a name:<br/>\n          <input type=\"text\" id=\"session_link\" onChange={this.handleNameChange} />\n        </p>\n        <p>\n          <input type=\"button\" className=\"btn btn-primary\" value=\"Create a journey space\" onClick={this.createSessionLink} />\n        </p>\n        <SessionInfo sessionVisibility={this.state.sessionVisible} sessionLink={this.state.sessionLinkUrl} />\n      </div>\n    )\n    } else {\n      return (\n        <div></div>\n      )\n    }\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ../client/src/components/journey_detail_entry.js","import React, {Component} from 'react'\n\nexport default class SessionInfo extends Component {\n\n  constructor(props){\n    super(props)\n    this.state = {\n      visible: false,\n      sessionLinkUrl: ''\n    }\n\n    this.jumpToSession = this.jumpToSession.bind(this)\n  }\n\n  componentWillReceiveProps(nextProps) {\n    this.setState({ sessionLinkUrl: nextProps.sessionLink });\n    this.setState({ visible: nextProps.sessionVisibility });\n  }\n\n  jumpToSession() {\n    window.open(this.state.sessionLinkUrl, \"_blank\")\n  }\n\n  // TODO: npm install --save react@^16.2.0 react-dom@^16.2.0 for getDerivedstateFromProps\n\n  render() {\n    if(this.state.visible === true) {\n      return(\n        <div>\n          <strong>You created journey space!</strong>\n          <p><span style={{ fontWeight: 'bold', backgroundColor: '#ccc', padding: '7px' }}>www.wacuri.com/{this.state.sessionLinkUrl}</span>&nbsp;<input className=\"btn btn-primary\" type=\"button\" value=\"Jump to the session\" onClick={this.jumpToSession} /></p>\n        </div>\n      )\n\n    } else {\n      return (\n        <div></div>\n      )\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ../client/src/components/session_info.js","import React, {Component} from 'react';\nimport { view } from 'react-easy-state'\nimport state from '../state';\nimport PropTypes from 'prop-types';\nimport uuid from 'uuid';\nimport {initLayoutContainer} from 'opentok-layout-js';\nrequire('es6-promise').polyfill();\nrequire('isomorphic-fetch');\n\nvar { OTSession, OTPublisher, OTStreams, OTSubscriber, createSession } = {};\n\nif (__CLIENT__) {\n\tvar { OTSession, OTPublisher, OTStreams, OTSubscriber, createSession } = require('opentok-react');\n\tconst OT = require('@opentok/client');\n\twindow.state = state;\n}\n\nclass Room extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      streams: [],\n      publisherId: '',\n      session: null,\n      playerState: 'waiting',\n      playerProgress: 0,\n      playerProgressMS: 0,\n      journeyDuration: 0,\n    }\n    this.publisher = {};\n    this.audioTag = {};\n  }\n\n\tcomponentDidMount() {\n    this.audioTag.addEventListener('ended', (event) => {\n      this.publisher.state.publisher.publishAudio(true);\n      this.setState({\n        playerState: 'ended'\n      });\n    });\n\n\t\tfetch(`/api/sessions/${this.props.match.params.room}`)\n\t\t\t.then(res => res.json())\n\t\t\t.then(json => {\n\t\t\t\tstate.session = json;\n        this.sessionHelper = createSession({\n          apiKey: state.openTokKey,\n          sessionId: state.session.sessionId,\n          token: state.session.token,\n          onConnect: () => {\n            console.log('assigned connection to publisher', this.sessionHelper.session.connection);\n            setTimeout(this.refreshSession, 1000);\n          },\n          onStreamsUpdated: streams => {\n            console.log('Current subscriber streams:', streams);\n            this.setState({ streams });\n          }\n        });\n        this.sessionHelper.session.on(\"connectionDestroyed\", (event) => {\n          const data = {\n            sessionId: this.sessionHelper.session.sessionId,\n            connection: {\n              id: event.connection.id\n            },\n            event: 'connectionDestroyed',\n          }\n          this.refreshSession();\n        });\n        this.sessionHelper.session.on(\"connectionCreated\", (event) => {\n          console.log('CREATED', event);\n          const data = {\n            sessionId: this.sessionHelper.session.sessionId,\n            connection: {\n              id: event.connection.id\n            },\n            event: 'connectionCreated',\n          }\n          this.refreshSession();\n        });\n        this.sessionHelper.session.on(\"signal\", (event) => {\n          console.log(\"Signal sent from connection \", event);\n          this.refreshSession();\n          if (event.type === 'signal:startJourney') {\n            this.publisher.state.publisher.publishAudio(false);\n            this.audioTag.play();\n            this.setState({\n              playerState: 'playing'\n            });\n          }\n        });\n        this.setState({\n          session: this.sessionHelper.session\n        });\n\t\t\t});\n    fetch('/api/journeys')\n      .then(res => res.json())\n      .then(json => {\n        state.journeys = json;\n      });\n\t}\n\n  componentWillUnmount() {\n    if (this.sessionHelper) {\n      this.sessionHelper.disconnect();\n    }\n  }\n\n  refreshSession = () => {\n\t\tfetch(`/api/sessions/${this.props.match.params.room}`)\n\t\t\t.then(res => res.json())\n\t\t\t.then(json => {\n\t\t\t\tstate.session = json;\n      });\n  }\n\n  get timeRemaining() {\n    const seconds = this.state.journeyDuration - this.state.playerProgressMS;\n    const minutes = Math.floor(seconds / 60);\n    const remainingSeconds = (seconds % 60).toFixed(0);\n    return minutes + \":\" + (remainingSeconds < 10 ? '0' : '') + remainingSeconds;\n  }\n\n  onInitPublisher = () => {\n    console.log('initialized publisher');\n  }\n\n  onConfirmReady = (e) => {\n    fetch(`/api/sessions/${this.props.match.params.room}/connections/${this.sessionHelper.session.connection.id}/ready`);\n  }\n\n  onChangeJourney = (e) => {\n    console.log('CHANGE', e.target.value);\n    fetch(`/api/sessions/${this.props.match.params.room}/journey`, {\n      body: JSON.stringify({journey: e.target.value}), // must match 'Content-Type' header\n      cache: 'no-cache', // *default, no-cache, reload, force-cache, only-if-cached\n      credentials: 'same-origin', // include, same-origin, *omit\n      headers: {\n        'user-agent': 'Mozilla/4.0 MDN Example',\n        'content-type': 'application/json'\n      },\n      method: 'PUT', // *GET, POST, PUT, DELETE, etc.\n      mode: 'cors', // no-cors, cors, *same-origin\n      redirect: 'follow', // manual, *follow, error\n      referrer: 'no-referrer', // *client, no-referrer\n    });\n  }\n\n  onStartSession = (e) => {\n    fetch(`/api/sessions/${this.props.match.params.room}/start`, {\n      cache: 'no-cache',\n      credentials: 'same-origin',\n      headers: {\n        'user-agent': 'Mozilla/4.0 MDN Example',\n        'content-type': 'application/json'\n      },\n      method: 'POST',\n      mode: 'cors',\n    });\n  }\n\n  onLoadedMetadata = (e) => {\n    this.setState({\n      journeyDuration: e.target.duration\n    });\n    this.audioTag.removeEventListener('timeupdate', this.onTimeUpdate);\n    this.audioTag.addEventListener('timeupdate', this.onTimeUpdate);\n  }\n\n  onTimeUpdate = (e) => {\n    this.setState({\n      playerProgress: (e.target.currentTime / e.target.duration) * 100,\n      playerProgressMS: e.target.currentTime,\n    });\n  }\n\n  onFlag = (e) => {\n    e.preventDefault();\n    fetch(`/api/sessions/${this.props.match.params.room}/flag`, {\n      cache: 'no-cache',\n      body: JSON.stringify({connectionId: this.state.session.connection.id}),\n      credentials: 'same-origin',\n      headers: {\n        'user-agent': 'Mozilla/4.0 MDN Example',\n        'content-type': 'application/json'\n      },\n      method: 'POST',\n      mode: 'cors',\n    })\n      .then(res => res.json())\n      .then(json => state.session = json);\n  }\n\n\trender() {\n    const currentParticipant = this.state.session && state.session && state.session.participants.find(participant => participant.connectionId === this.state.session.connection.id);\n    let currentUserHasFlaggedJourney = false;\n    if (currentParticipant) {\n      currentUserHasFlaggedJourney = state.session.flags.map(flag => flag.user).indexOf(currentParticipant.connectionId) > -1;\n    }\n\t\treturn (\n\t\t\t<div className='journey-container'>\n\t\t\t\t<p style={{display: 'none'}}>{JSON.stringify(state.session, null, 2)}</p>\n        <audio style={{display: 'none'}} onLoadedMetadata={this.onLoadedMetadata} key={state.session && state.session.journey} controls=\"true\" ref={audioTag => { this.audioTag = audioTag }}>\n         <source src={state.session && state.session.journey} type=\"audio/mpeg\"/>\n        </audio>\n\t\t\t\t{this.state.session &&\n          <div style={{position: 'relative'}}>\n            <button style={{position: 'absolute', top: 0, right: 0}} className='btn btn-danger btn-flag-session' disabled={currentUserHasFlaggedJourney} onClick={this.onFlag}>{currentUserHasFlaggedJourney ? \"You've flagged this journey\" : \"Flag this journey\"}</button>\n            <div className='row'>\n              <div className='col-6'>\n                <h2>{state.session.journey.split('/')[state.session.journey.split('/').length - 1]}</h2>\n                { currentParticipant && state.session.participants.indexOf(currentParticipant) === 0 &&\n                  <div>\n                    <select className='mb-3' onChange={this.onChangeJourney} value={state.session && state.session.journey}>\n                      {state.journeys.map(journey => (\n                        <option value={journey}>{journey.split('/')[journey.split('/').length -1]}</option>\n                      ))}\n                    </select>\n                    { state.session.state === 'created' &&\n                      <div className='mb-2'>\n                        <button onClick={this.onStartSession} className='btn btn-primary'>Start session <i className=\"fa fa-play\" ariaHidden=\"true\"></i></button>\n                      </div>\n                    }\n                  </div>\n                }\n              </div>\n            </div>\n            <div className='row'>\n              <div className='col-3'>\n                <progress max=\"100\" value={this.state.playerProgress} style={{width: '100%'}}></progress>\n                <p style={{display: 'flex'}}><strong style={{flex: 1}}>Time remaining:</strong><span>{this.timeRemaining}</span></p>\n              </div>\n            </div>\n            <div className='row'>\n              <div className='tok-container col' ref={container => this.container = container }>\n                {this.state.streams.length == 0 &&\n                  <p>Waiting for others to join this journey...</p>\n                }\n                <div className='row no-gutters' style={{display: 'grid', gridTemplateColumns: 'repeat(3, 1fr)', gridGap: '10px', marginRight: '350px'}}>\n                  {this.state.streams.map(stream => {\n                    const participant = state.session.participants.find(participant => participant.connectionId === stream.connection.id);\n                    return (\n                      <div className={`subscriber`}>\n                        <p style={{fontSize: '14px'}} className={participant && participant.ready ? 'text-success' : 'text-warning'}>{participant && participant.ready ? 'Ready to start!' : 'Not ready yet'}</p>\n                        <OTSubscriber\n                          key={stream.id}\n                          session={this.sessionHelper.session}\n                          stream={stream}\n                        />\n                      </div>\n                    );\n                  })}\n                </div>\n                <div style={{position: 'fixed', bottom: 0, right: 0}}>\n                  <OTPublisher session={this.sessionHelper.session} onInit={this.onInitPublisher} ref={publisher => {this.publisher = publisher}}/>\n                  {currentParticipant && currentParticipant.ready &&\n                    <p>You are ready!</p>\n                  }\n                  {(!currentParticipant || !currentParticipant.ready) &&\n                    <a className='btn btn-primary' href='#' onClick={this.onConfirmReady}>Ready?</a>\n                  }\n                </div>\n              </div>\n            </div>\n          </div>\n\t\t\t\t}\n\t\t\t</div>\n\t\t)\n\t}\n}\n\nexport default view(Room);\n\n\n\n// WEBPACK FOOTER //\n// ../client/src/components/Room.js","module.exports = require(\"uuid\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"uuid\"\n// module id = 45\n// module chunks = 0","module.exports = require(\"opentok-layout-js\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"opentok-layout-js\"\n// module id = 46\n// module chunks = 0","module.exports = require(\"es6-promise\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"es6-promise\"\n// module id = 47\n// module chunks = 0","module.exports = require(\"agenda\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"agenda\"\n// module id = 48\n// module chunks = 0","module.exports = require(\"agendash\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"agendash\"\n// module id = 49\n// module chunks = 0","module.exports = require(\"express-session\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"express-session\"\n// module id = 50\n// module chunks = 0","module.exports = require(\"connect-mongo\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"connect-mongo\"\n// module id = 51\n// module chunks = 0","import fs from 'fs';\nimport path from 'path';\nimport Agenda from 'Agenda';\nimport _ from 'lodash';\nimport OpenTok from 'opentok';\nimport moment from 'moment';\nimport mongoose from 'mongoose';\nimport JourneySpace from '../models/journey_space';\nimport JourneyContent from '../models/journey_content';\n\nconst agenda = new Agenda({db: {address: process.env.MONGODB_URI || process.env.MONGO_URL}});\nconst opentok = new OpenTok(process.env.OPENTOK_KEY, process.env.OPENTOK_SECRET);\nconst db = mongoose.connection;\n\nagenda.define('create journey space', async function(job, done) {\n  try {\n    const randomJourney = (await db.collection('journeycontents').aggregate([{$sample: {size: 1}}]).toArray())[0];\n    const journeySpace = new JourneySpace({\n      journey: randomJourney.filePath,\n      name: randomJourney.name,\n      image: randomJourney.image,\n      room: `${randomJourney.name.toLowerCase().replace(/[^a-z]/ig, '-')}-${(new Date()).getTime()}`,\n      startAt: moment().add(10, 'minutes').toDate()\n    });\n    await journeySpace.save();\n    const globalSpace = await JourneySpace.findOne({room: 'temp-home-location'}).exec();\n    if (globalSpace) {\n      opentok.signal(globalSpace.sessionId, null, { 'type': 'createdNewJourney', 'data': JSON.stringify(journeySpace) }, done);\n    } else {\n      done();\n    }\n  } catch(e) {\n    console.log(e);\n    done(e);\n  }\n});\n\nagenda.define('clear expired journeys', async function(job, done) {\n  try {\n    const expiredJourneys = await JourneySpace.find({state: 'created', startAt: {$lt: moment().subtract(1, 'minutes')}}).exec();\n    const globalSpace = await JourneySpace.findOne({room: 'temp-home-location'}).exec();\n    for (let journey of expiredJourneys) {\n      await journey.expire();\n      if (globalSpace) {\n        opentok.signal(globalSpace.sessionId, null, { 'type': 'expiredJourney', 'data': JSON.stringify(journey) }, () => {});\n      }\n    }\n    done();\n  } catch(e) {\n    console.log(e);\n    done(e);\n  }\n});\n\n\nagenda.on('ready', function() {\n  agenda.every('1 minute', 'create journey space');\n  agenda.every('1 minute', 'clear expired journeys');\n\n  agenda.start();\n});\n\n\n\n\n// WEBPACK FOOTER //\n// ./jobs/index.js","const Agenda = require('./lib/agenda');\n\nmodule.exports = Agenda;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/index.js\n// module id = 53\n// module chunks = 0","'use strict';\n/**\n * General Notes:\n * - Refactor remaining deprecated MongoDB Native Driver methods: findAndModify()\n */\n\nconst Emitter = require('events').EventEmitter;\nconst humanInterval = require('human-interval');\n\nclass Agenda extends Emitter {\n  constructor(config, cb) {\n    super();\n\n    if (!(this instanceof Agenda)) {\n      return new Agenda(config);\n    }\n\n    config = config || {};\n\n    this._name = config.name;\n    this._processEvery = humanInterval(config.processEvery) || humanInterval('5 seconds');\n    this._defaultConcurrency = config.defaultConcurrency || 5;\n    this._maxConcurrency = config.maxConcurrency || 20;\n    this._defaultLockLimit = config.defaultLockLimit || 0;\n    this._lockLimit = config.lockLimit || 0;\n    this._definitions = {};\n    this._runningJobs = [];\n    this._lockedJobs = [];\n    this._jobQueue = [];\n    this._defaultLockLifetime = config.defaultLockLifetime || 10 * 60 * 1000; // 10 minute default lockLifetime\n    this._sort = config.sort || {nextRunAt: 1, priority: -1};\n    this._indices = Object.assign({name: 1}, this._sort, {priority: -1, lockedAt: 1, nextRunAt: 1, disabled: 1});\n\n    this._isLockingOnTheFly = false;\n    this._jobsToLock = [];\n    if (config.mongo) {\n      this.mongo(config.mongo, config.db ? config.db.collection : undefined, cb);\n    } else if (config.db) {\n      this.database(config.db.address, config.db.collection, config.db.options, cb);\n    }\n  }\n}\n\nAgenda.prototype.mongo = require('./mongo');\nAgenda.prototype.database = require('./database');\nAgenda.prototype.db_init = require('./db-init'); // eslint-disable-line camelcase\nAgenda.prototype.name = require('./name');\nAgenda.prototype.processEvery = require('./process-every');\nAgenda.prototype.maxConcurrency = require('./max-concurrency');\nAgenda.prototype.defaultConcurrency = require('./default-concurrency');\nAgenda.prototype.lockLimit = require('./locklimit');\nAgenda.prototype.defaultLockLimit = require('./default-lock-limit');\nAgenda.prototype.defaultLockLifetime = require('./default-lock-lifetime');\nAgenda.prototype.sort = require('./sort');\nAgenda.prototype.create = require('./create');\nAgenda.prototype.jobs = require('./jobs');\nAgenda.prototype.purge = require('./purge');\nAgenda.prototype.define = require('./define');\nAgenda.prototype.every = require('./every');\nAgenda.prototype.schedule = require('./schedule');\nAgenda.prototype.now = require('./now');\nAgenda.prototype.cancel = require('./cancel');\nAgenda.prototype.saveJob = require('./save-job');\nAgenda.prototype.start = require('./start');\nAgenda.prototype.stop = require('./stop');\nAgenda.prototype._findAndLockNextJob = require('./find-and-lock-next-job');\n\nmodule.exports = Agenda;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/lib/agenda/index.js\n// module id = 54\n// module chunks = 0","module.exports = require(\"events\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"events\"\n// module id = 55\n// module chunks = 0","'use strict';\n\n/**\n * Build method used to add MongoDB connection details\n * @param {MongoClient} mdb instance of MongoClient to use\n * @param {String} collection name collection we want to use ('agendaJobs')\n * @param {Function} cb called when MongoDB connection fails or passes\n * @returns {exports} instance of Agenda\n */\nmodule.exports = function(mdb, collection, cb) {\n  this._mdb = mdb;\n  this.db_init(collection, cb);\n  return this;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/lib/agenda/mongo.js\n// module id = 56\n// module chunks = 0","'use strict';\nconst MongoClient = require('mongodb').MongoClient;\nconst debug = require('debug')('agenda:database');\n\n/**\n * Connect to the spec'd MongoDB server and database.\n * @param {String} url MongoDB server URI\n * @param {String} collection name of collection to use\n * @param {Object} options options for connecting\n * @param {Function} cb callback of MongoDB connection\n * @returns {exports}\n * NOTE:\n * If `url` includes auth details then `options` must specify: { 'uri_decode_auth': true }. This does Auth on\n * the specified database, not the Admin database. If you are using Auth on the Admin DB and not on the Agenda DB,\n * then you need to authenticate against the Admin DB and then pass the MongoDB instance into the constructor\n * or use Agenda.mongo(). If your app already has a MongoDB connection then use that. ie. specify config.mongo in\n * the constructor or use Agenda.mongo().\n */\nmodule.exports = function(url, collection, options, cb) {\n  const self = this;\n  if (!url.match(/^mongodb:\\/\\/.*/)) {\n    url = 'mongodb://' + url;\n  }\n\n  collection = collection || 'agendaJobs';\n  options = Object.assign({autoReconnect: true, reconnectTries: Number.MAX_SAFE_INTEGER, reconnectInterval: this._processEvery}, options);\n  MongoClient.connect(url, options, (error, db) => {\n    if (error) {\n      debug('error connecting to MongoDB using collection: [%s]', collection);\n      if (cb) {\n        cb(error, null);\n      } else {\n        throw error;\n      }\n      return;\n    }\n    debug('successful connection to MongoDB using collection: [%s]', collection);\n    self._mdb = db;\n    self.db_init(collection, cb);\n  });\n  return this;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/lib/agenda/database.js\n// module id = 57\n// module chunks = 0","module.exports = require(\"mongodb\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"mongodb\"\n// module id = 58\n// module chunks = 0","'use strict';\nconst debug = require('debug')('agenda:db_init');\n\n/**\n * Internal method called in the case where new indices have an error during creation\n * @param {Error} err error returned from index creation from before\n * @param {*} result result passed in from earlier attempt of creating index\n * @param {Agenda} self instance of Agenda\n * @param {Function} cb called when indices fail or pass\n * @returns {undefined}\n */\nconst handleLegacyCreateIndex = (err, result, self, cb) => {\n  if (err && err.message !== 'no such cmd: createIndex') {\n    debug('not attempting legacy index, emitting error');\n    self.emit('error', err);\n  } else {\n    // Looks like a mongo.version < 2.4.x\n    err = null;\n    self._collection.ensureIndex(self._indices, {\n      name: 'findAndLockNextJobIndex'\n    });\n    self.emit('ready');\n  }\n  if (cb) {\n    cb(err, self._collection);\n  }\n};\n\n/**\n * Setup and initialize the collection used to manage Jobs.\n * @param {String} collection name or undefined for default 'agendaJobs'\n * @param {Function} cb called when the db is initialized\n * @returns {undefined}\n */\nmodule.exports = function(collection, cb) {\n  const self = this;\n  debug('init database collection using name [%s]', collection);\n  this._collection = this._mdb.collection(collection || 'agendaJobs');\n  debug('attempting index creation');\n  this._collection.createIndex(this._indices, {\n    name: 'findAndLockNextJobIndex'\n  }, (err, result) => {\n    if (err) {\n      debug('index creation failed, attempting legacy index creation next');\n    } else {\n      debug('index creation success');\n    }\n    handleLegacyCreateIndex(err, result, self, cb);\n  });\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/lib/agenda/db-init.js\n// module id = 59\n// module chunks = 0","'use strict';\nconst debug = require('debug')('agenda:name');\n\n/**\n * Set name of queue\n * @param {String} name name of agenda instance\n * @returns {exports} agenda instance\n */\nmodule.exports = function(name) {\n  debug('Agenda.name(%s)', name);\n  this._name = name;\n  return this;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/lib/agenda/name.js\n// module id = 60\n// module chunks = 0","'use strict';\nconst humanInterval = require('human-interval');\nconst debug = require('debug')('agenda:processEvery');\n\n/**\n * Set the default process interval\n * @param {Number} time time to process\n * @returns {exports} agenda instance\n */\nmodule.exports = function(time) {\n  debug('Agenda.processEvery(%d)', time);\n  this._processEvery = humanInterval(time);\n  return this;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/lib/agenda/process-every.js\n// module id = 61\n// module chunks = 0","'use strict';\nconst debug = require('debug')('agenda:maxConcurrency');\n\n/**\n * Set the concurrency for jobs (globally), type does not matter\n * @param {Number} num max concurrency value\n * @returns {exports} agenda instance\n */\nmodule.exports = function(num) {\n  debug('Agenda.maxConcurrency(%d)', num);\n  this._maxConcurrency = num;\n  return this;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/lib/agenda/max-concurrency.js\n// module id = 62\n// module chunks = 0","'use strict';\nconst debug = require('debug')('agenda:defaultConcurrency');\n\n/**\n * Set the default concurrency for each job\n * @param {Number} num default concurrency\n * @returns {exports} agenda instance\n */\nmodule.exports = function(num) {\n  debug('Agenda.defaultConcurrency(%d)', num);\n  this._defaultConcurrency = num;\n  return this;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/lib/agenda/default-concurrency.js\n// module id = 63\n// module chunks = 0","'use strict';\nconst debug = require('debug')('agenda:locklimit');\n\n/**\n * Set the default amount jobs that are allowed to be locked at one time (GLOBAL)\n * NOTE: Is this different than max concurrency?\n * @param {Number} num Lock limit\n * @returns {exports} agenda instance\n */\nmodule.exports = function(num) {\n  debug('Agenda.lockLimit(%d)', num);\n  this._lockLimit = num;\n  return this;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/lib/agenda/locklimit.js\n// module id = 64\n// module chunks = 0","'use strict';\nconst debug = require('debug')('agenda:defaultLockLimit');\n\n/**\n * Set default lock limit per job type\n * @param {Number} num Lock limit per job\n * @returns {exports} agenda instance\n */\nmodule.exports = function(num) {\n  debug('Agenda.defaultLockLimit(%d)', num);\n  this._defaultLockLimit = num;\n  return this;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/lib/agenda/default-lock-limit.js\n// module id = 65\n// module chunks = 0","'use strict';\nconst debug = require('debug')('agenda:defaultLockLifetime');\n\n/**\n * Set the default lock time (in ms)\n * Default is 10 * 60 * 1000 ms (10 minutes)\n * @param {Number} ms time in ms to set default lock\n * @returns {exports} agenda instance\n */\nmodule.exports = function(ms) {\n  debug('Agenda.defaultLockLifetime(%d)', ms);\n  this._defaultLockLifetime = ms;\n  return this;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/lib/agenda/default-lock-lifetime.js\n// module id = 66\n// module chunks = 0","'use strict';\nconst debug = require('debug')('agenda:sort');\n\n/**\n * Set the sort query for finding next job\n * Default is { nextRunAt: 1, priority: -1 }\n * @param {Object} query sort query object for MongoDB\n * @returns {exports} agenda instance\n */\nmodule.exports = function(query) {\n  debug('Agenda.sort([Object])');\n  this._sort = query;\n  return this;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/lib/agenda/sort.js\n// module id = 67\n// module chunks = 0","'use strict';\nconst debug = require('debug')('agenda:create');\nconst Job = require('../job');\n\n/**\n * Given a name and some data, create a new job\n * @param {String} name name of job\n * @param {Object} data data to set for job\n * @access protected\n * @returns {module.Job} instance of new job\n */\nmodule.exports = function(name, data) {\n  debug('Agenda.create(%s, [Object])', name);\n  const priority = this._definitions[name] ? this._definitions[name].priority : 0;\n  const job = new Job({name, data, type: 'normal', priority, agenda: this});\n  return job;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/lib/agenda/create.js\n// module id = 68\n// module chunks = 0","'use strict';\n\n/**\n * Given a job, turn it into an object we can store in Mongo\n * @returns {Object} json object from Job\n */\nmodule.exports = function() {\n  const self = this;\n  const attrs = self.attrs || {};\n  const result = {};\n\n  for (const prop in attrs) {\n    if ({}.hasOwnProperty.call(attrs, prop)) {\n      result[prop] = attrs[prop];\n    }\n  }\n\n  const dates = ['lastRunAt', 'lastFinishedAt', 'nextRunAt', 'failedAt', 'lockedAt'];\n  dates.forEach(d => {\n    if (result[d]) {\n      result[d] = new Date(result[d]);\n    }\n  });\n\n  return result;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/lib/job/to-json.js\n// module id = 69\n// module chunks = 0","'use strict';\nconst humanInterval = require('human-interval');\nconst CronTime = require('cron').CronTime;\nconst moment = require('moment-timezone');\nconst date = require('date.js');\nconst debug = require('debug')('agenda:job');\n\n/**\n * Internal method used to compute next time a job should run and sets the proper values\n * @returns {exports} instance of Job instance\n */\nmodule.exports = function() {\n  const interval = this.attrs.repeatInterval;\n  const timezone = this.attrs.repeatTimezone;\n  const repeatAt = this.attrs.repeatAt;\n  this.attrs.nextRunAt = undefined;\n\n  const dateForTimezone = date => {\n    date = moment(date);\n    if (timezone !== null) {\n      date.tz(timezone);\n    }\n    return date;\n  };\n\n  /**\n   * Internal method that computes the interval\n   * @returns {undefined}\n   */\n  const computeFromInterval = () => {\n    debug('[%s:%s] computing next run via interval [%s]', this.attrs.name, this.attrs._id, interval);\n    let lastRun = this.attrs.lastRunAt || new Date();\n    lastRun = dateForTimezone(lastRun);\n    try {\n      const cronTime = new CronTime(interval);\n      let nextDate = cronTime._getNextDateFrom(lastRun);\n      if (nextDate.valueOf() === lastRun.valueOf()) {\n        // Handle cronTime giving back the same date for the next run time\n        nextDate = cronTime._getNextDateFrom(dateForTimezone(new Date(lastRun.valueOf() + 1000)));\n      }\n      this.attrs.nextRunAt = nextDate;\n      debug('[%s:%s] nextRunAt set to [%s]', this.attrs.name, this.attrs._id, this.attrs.nextRunAt.toISOString());\n    } catch (e) {\n      // Nope, humanInterval then!\n      try {\n        if (!this.attrs.lastRunAt && humanInterval(interval)) {\n          this.attrs.nextRunAt = lastRun.valueOf();\n          debug('[%s:%s] nextRunAt set to [%s]', this.attrs.name, this.attrs._id, this.attrs.nextRunAt.toISOString());\n        } else {\n          this.attrs.nextRunAt = lastRun.valueOf() + humanInterval(interval);\n          debug('[%s:%s] nextRunAt set to [%s]', this.attrs.name, this.attrs._id, this.attrs.nextRunAt.toISOString());\n        }\n      } catch (e) {}\n    } finally {\n      if (isNaN(this.attrs.nextRunAt)) {\n        this.attrs.nextRunAt = undefined;\n        debug('[%s:%s] failed to calculate nextRunAt due to invalid repeat interval', this.attrs.name, this.attrs._id);\n        this.fail('failed to calculate nextRunAt due to invalid repeat interval');\n      }\n    }\n  };\n\n  /**\n   * Internal method to compute next run time from the repeat string\n   * @returns {undefined}\n   */\n  function computeFromRepeatAt() {\n    const lastRun = this.attrs.lastRunAt || new Date();\n    const nextDate = date(repeatAt).valueOf();\n\n    // If you do not specify offset date for below test it will fail for ms\n    const offset = Date.now();\n    if (offset === date(repeatAt, offset).valueOf()) {\n      this.attrs.nextRunAt = undefined;\n      debug('[%s:%s] failed to calculate repeatAt due to invalid format', this.attrs.name, this.attrs._id);\n      this.fail('failed to calculate repeatAt time due to invalid format');\n    } else if (nextDate.valueOf() === lastRun.valueOf()) {\n      this.attrs.nextRunAt = date('tomorrow at ', repeatAt);\n      debug('[%s:%s] nextRunAt set to [%s]', this.attrs.name, this.attrs._id, this.attrs.nextRunAt.toISOString());\n    } else {\n      this.attrs.nextRunAt = date(repeatAt);\n      debug('[%s:%s] nextRunAt set to [%s]', this.attrs.name, this.attrs._id, this.attrs.nextRunAt.toISOString());\n    }\n  }\n\n  if (interval) {\n    computeFromInterval.call(this);\n  } else if (repeatAt) {\n    computeFromRepeatAt.call(this);\n  }\n  return this;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/lib/job/compute-next-run-at.js\n// module id = 70\n// module chunks = 0","module.exports = require(\"cron\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"cron\"\n// module id = 71\n// module chunks = 0","module.exports = require(\"moment-timezone\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"moment-timezone\"\n// module id = 72\n// module chunks = 0","'use strict';\n\n/**\n * Sets a job to repeat every X amount of time\n * @param {String} interval repeat every X\n * @param {Object} options options to use for job\n * @returns {exports} instance of Job\n */\nmodule.exports = function(interval, options) {\n  options = options || {};\n  this.attrs.repeatInterval = interval;\n  this.attrs.repeatTimezone = options.timezone ? options.timezone : null;\n  return this;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/lib/job/repeat-every.js\n// module id = 73\n// module chunks = 0","'use strict';\n\n/**\n * Sets a job to repeat at a specific time\n * @param {String} time time to repeat job at (human readable or number)\n * @returns {exports} instance of Job\n */\nmodule.exports = function(time) {\n  this.attrs.repeatAt = time;\n  return this;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/lib/job/repeat-at.js\n// module id = 74\n// module chunks = 0","'use strict';\n\n/**\n * Prevents the job type from running\n * @returns {exports} instance of Job\n */\nmodule.exports = function() {\n  this.attrs.disabled = true;\n  return this;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/lib/job/disable.js\n// module id = 75\n// module chunks = 0","'use strict';\n\n/**\n * Allows job type to run\n * @returns {exports} instance of Job\n */\nmodule.exports = function() {\n  this.attrs.disabled = false;\n  return this;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/lib/job/enable.js\n// module id = 76\n// module chunks = 0","'use strict';\n\n/**\n * Data to ensure is unique for job to be created\n * @param {Object} unique mongo data query for unique\n * @param {Object} opts unique options\n * @returns {exports} instance of Job\n */\nmodule.exports = function(unique, opts) {\n  this.attrs.unique = unique;\n  this.attrs.uniqueOpts = opts;\n  return this;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/lib/job/unique.js\n// module id = 77\n// module chunks = 0","'use strict';\nconst date = require('date.js');\n\n/**\n * Schedules a job to run at specified time\n * @param {String} time schedule a job to run \"then\"\n * @returns {exports} instance of Job\n */\nmodule.exports = function(time) {\n  this.attrs.nextRunAt = (time instanceof Date) ? time : date(time);\n  return this;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/lib/job/schedule.js\n// module id = 78\n// module chunks = 0","'use strict';\n\n/**\n * Internal method to turn priority into a number\n * @param {String|Number} priority string to parse into number\n * @returns {Number} priority that was parsed\n */\nconst parsePriority = priority => {\n  const priorityMap = {\n    lowest: -20,\n    low: -10,\n    normal: 0,\n    high: 10,\n    highest: 20\n  };\n  if (typeof priority === 'number' || priority instanceof Number) {\n    return priority;\n  }\n  return priorityMap[priority];\n};\n\n/**\n * Sets priority of the job\n * @param {String} priority priority of when job should be queued\n * @returns {exports} instance of Job\n */\nmodule.exports = function(priority) {\n  this.attrs.priority = parsePriority(priority);\n  return this;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/lib/job/priority.js\n// module id = 79\n// module chunks = 0","'use strict';\nconst debug = require('debug')('agenda:job');\n\n/**\n * Fails the job with a reason (error) specified\n * @param {Error|String} reason reason job failed\n * @returns {exports} instance of Job\n */\nmodule.exports = function(reason) {\n  if (reason instanceof Error) {\n    reason = reason.message;\n  }\n  this.attrs.failReason = reason;\n  this.attrs.failCount = (this.attrs.failCount || 0) + 1;\n  const now = new Date();\n  this.attrs.failedAt = now;\n  this.attrs.lastFinishedAt = now;\n  debug('[%s:%s] fail() called [%d] times so far', this.attrs.name, this.attrs._id, this.attrs.failCount);\n  return this;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/lib/job/fail.js\n// module id = 80\n// module chunks = 0","'use strict';\nconst debug = require('debug')('agenda:job');\n\n/**\n * Internal method (RUN)\n * @param {Function} cb called when job persistence in MongoDB fails or passes\n * @returns {undefined}\n */\nmodule.exports = function(cb) {\n  const self = this;\n  const agenda = self.agenda;\n  const definition = agenda._definitions[self.attrs.name];\n\n  setImmediate(() => {\n    self.attrs.lastRunAt = new Date();\n    debug('[%s:%s] setting lastRunAt to: %s', self.attrs.name, self.attrs._id, self.attrs.lastRunAt.toISOString());\n    self.computeNextRunAt();\n    self.save(() => {\n      const jobCallback = function(err) {\n        if (err) {\n          self.fail(err);\n        }\n\n        if (!err) {\n          self.attrs.lastFinishedAt = new Date();\n        }\n        self.attrs.lockedAt = null;\n        debug('[%s:%s] job finished at [%s] and was unlocked', self.attrs.name, self.attrs._id, self.attrs.lastFinishedAt);\n\n        self.save((saveErr, job) => {\n          cb && cb(err || saveErr, job);  // eslint-disable-line no-unused-expressions\n          if (err) {\n            agenda.emit('fail', err, self);\n            agenda.emit('fail:' + self.attrs.name, err, self);\n            debug('[%s:%s] failed to be saved to MongoDB', self.attrs.name, self.attrs._id);\n          } else {\n            agenda.emit('success', self);\n            agenda.emit('success:' + self.attrs.name, self);\n            debug('[%s:%s] was saved successfully to MongoDB', self.attrs.name, self.attrs._id);\n          }\n          agenda.emit('complete', self);\n          agenda.emit('complete:' + self.attrs.name, self);\n          debug('[%s:%s] job has finished', self.attrs.name, self.attrs._id);\n        });\n      };\n\n      try {\n        agenda.emit('start', self);\n        agenda.emit('start:' + self.attrs.name, self);\n        debug('[%s:%s] starting job', self.attrs.name, self.attrs._id);\n        if (!definition) {\n          debug('[%s:%s] has no definition, can not run', self.attrs.name, self.attrs._id);\n          throw new Error('Undefined job');\n        }\n        if (definition.fn.length === 2) {\n          debug('[%s:%s] process function being called', self.attrs.name, self.attrs._id);\n          definition.fn(self, jobCallback);\n        } else {\n          debug('[%s:%s] process function being called', self.attrs.name, self.attrs._id);\n          definition.fn(self);\n          jobCallback();\n        }\n      } catch (err) {\n        debug('[%s:%s] unknown error occurred', self.attrs.name, self.attrs._id);\n        jobCallback(err);\n      }\n    });\n  });\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/lib/job/run.js\n// module id = 81\n// module chunks = 0","'use strict';\n\n/**\n * A job is running if:\n * (lastRunAt exists AND lastFinishedAt does not exist)\n * OR\n * (lastRunAt exists AND lastFinishedAt exists but the lastRunAt is newer [in time] than lastFinishedAt)\n * @returns {boolean} whether or not job is running at the moment (true for running)\n */\nmodule.exports = function() {\n  if (!this.attrs.lastRunAt) {\n    return false;\n  }\n  if (!this.attrs.lastFinishedAt) {\n    return true;\n  }\n  if (this.attrs.lockedAt && this.attrs.lastRunAt.getTime() > this.attrs.lastFinishedAt.getTime()) {\n    return true;\n  }\n  return false;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/lib/job/is-running.js\n// module id = 82\n// module chunks = 0","'use strict';\n\n/**\n * Saves a job into the MongoDB\n * @param {Function} cb called after job is saved or errors\n * @returns {exports} instance of Job\n */\nmodule.exports = function(cb) {\n  this.agenda.saveJob(this, cb);\n  return this;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/lib/job/save.js\n// module id = 83\n// module chunks = 0","'use strict';\n\n/**\n * Remove the job from MongoDB\n * @param {Function} cb called when job removal fails or passes\n * @returns {undefined}\n */\nmodule.exports = function(cb) {\n  this.agenda.cancel({_id: this.attrs._id}, cb);\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/lib/job/remove.js\n// module id = 84\n// module chunks = 0","'use strict';\n\n/**\n * Updates \"lockedAt\" time so the job does not get picked up again\n * @param {Function} cb called when job \"touch\" fails or passes\n * @returns {undefined}\n */\nmodule.exports = function(cb) {\n  this.attrs.lockedAt = new Date();\n  this.save(cb);\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/lib/job/touch.js\n// module id = 85\n// module chunks = 0","'use strict';\nconst utils = require('../utils');\n\nconst createJob = utils.createJob;\n\n/**\n * Finds all jobs matching 'query'\n * @param {Object} query object for MongoDB\n * @param {Function} cb called when fails or passes\n * @returns {undefined}\n */\nmodule.exports = function(query, cb) {\n  const self = this;\n  this._collection.find(query).toArray((error, result) => {\n    let jobs;\n    if (!error) {\n      jobs = result.map(createJob.bind(null, self));\n    }\n    cb(error, jobs);\n  });\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/lib/agenda/jobs.js\n// module id = 86\n// module chunks = 0","'use strict';\n// @TODO: What should we use for internal util functions?\n//        Maybe we should use agenda:util:processJobs which would move agenda:* to agenda:agenda;*\nconst debug = require('debug')('agenda:internal:processJobs');\nconst createJob = require('./create-job');\n\n/**\n * Process methods for jobs\n * @param {module.Job} extraJob job to run immediately\n * @returns {undefined}\n */\nmodule.exports = function(extraJob) {\n  debug('starting to process jobs');\n  // Make sure an interval has actually been set\n  // Prevents race condition with 'Agenda.stop' and already scheduled run\n  if (!this._processInterval) {\n    debug('no _processInterval set when calling processJobs, returning');\n    return;\n  }\n\n  const self = this;\n  const definitions = this._definitions;\n  const jobQueue = this._jobQueue;\n  let jobName;\n\n  // Determine whether or not we have a direct process call!\n  if (!extraJob) {\n    // Go through each jobName set in 'Agenda.process' and fill the queue with the next jobs\n    for (jobName in definitions) {\n      if ({}.hasOwnProperty.call(definitions, jobName)) {\n        debug('queuing up job to process: [%s]', jobName);\n        jobQueueFilling(jobName);\n      }\n    }\n  } else if (definitions[extraJob.attrs.name]) {\n    // Add the job to list of jobs to lock and then lock it immediately!\n    debug('job [%s] was passed directly to processJobs(), locking and running immediately', extraJob.attrs.name);\n    self._jobsToLock.push(extraJob);\n    lockOnTheFly();\n  }\n\n  /**\n   * Returns true if a job of the specified name can be locked.\n   * Considers maximum locked jobs at any time if self._lockLimit is > 0\n   * Considers maximum locked jobs of the specified name at any time if jobDefinition.lockLimit is > 0\n   * @param {String} name name of job to check if we should lock or not\n   * @returns {boolean} whether or not you should lock job\n   */\n  function shouldLock(name) {\n    const jobDefinition = definitions[name];\n    let shouldLock = true;\n    if (self._lockLimit && self._lockLimit <= self._lockedJobs.length) {\n      shouldLock = false;\n    }\n    if (jobDefinition.lockLimit && jobDefinition.lockLimit <= jobDefinition.locked) {\n      shouldLock = false;\n    }\n    debug('job [%s] lock status: shouldLock = %s', name, shouldLock);\n    return shouldLock;\n  }\n\n  /**\n   * Internal method that adds jobs to be processed to the local queue\n   * @param {*} jobs Jobs to queue\n   * @param {boolean} inFront puts the job in front of queue if true\n   * @returns {undefined}\n   */\n  function enqueueJobs(jobs, inFront) {\n    if (!Array.isArray(jobs)) {\n      jobs = [jobs];\n    }\n\n    jobs.forEach(job => {\n      let jobIndex;\n      let start;\n      let loopCondition;\n      let endCondition;\n      let inc;\n\n      if (inFront) {\n        start = jobQueue.length ? jobQueue.length - 1 : 0;\n        inc = -1;\n        loopCondition = function() {\n          return jobIndex >= 0;\n        };\n        endCondition = function(queuedJob) {\n          return !queuedJob || queuedJob.attrs.priority < job.attrs.priority;\n        };\n      } else {\n        start = 0;\n        inc = 1;\n        loopCondition = function() {\n          return jobIndex < jobQueue.length;\n        };\n        endCondition = function(queuedJob) {\n          return queuedJob.attrs.priority >= job.attrs.priority;\n        };\n      }\n\n      for (jobIndex = start; loopCondition(); jobIndex += inc) {\n        if (endCondition(jobQueue[jobIndex])) {\n          break;\n        }\n      }\n\n      // Insert the job to the queue at its prioritized position for processing\n      jobQueue.splice(jobIndex, 0, job);\n    });\n  }\n\n  /**\n   * Internal method that will lock a job and store it on MongoDB\n   * This method is called when we immediately start to process a job without using the process interval\n   * We do this because sometimes jobs are scheduled but will be run before the next process time\n   * @returns {undefined}\n   */\n  function lockOnTheFly() {\n    // Already running this? Return\n    if (self._isLockingOnTheFly) {\n      debug('lockOnTheFly() already running, returning');\n      return;\n    }\n\n    // Don't have any jobs to run? Return\n    if (self._jobsToLock.length === 0) {\n      debug('no jobs to current lock on the fly, returning');\n      self._isLockingOnTheFly = false;\n      return;\n    }\n\n    // Set that we are running this\n    self._isLockingOnTheFly = true;\n\n    // Grab a job that needs to be locked\n    const now = new Date();\n    const job = self._jobsToLock.pop();\n\n    // If locking limits have been hit, stop locking on the fly.\n    // Jobs that were waiting to be locked will be picked up during a\n    // future locking interval.\n    if (!shouldLock(job.attrs.name)) {\n      debug('lock limit hit for: [%s]', job.attrs.name);\n      self._jobsToLock = [];\n      self._isLockingOnTheFly = false;\n      return;\n    }\n\n    // Query to run against collection to see if we need to lock it\n    const criteria = {\n      _id: job.attrs._id,\n      lockedAt: null,\n      nextRunAt: job.attrs.nextRunAt,\n      disabled: {$ne: true}\n    };\n\n    // Update / options for the MongoDB query\n    const update = {$set: {lockedAt: now}};\n    const options = {returnOriginal: false};\n\n    // Lock the job in MongoDB!\n    self._collection.findOneAndUpdate(criteria, update, options, (err, resp) => {\n      if (err) {\n        throw err;\n      }\n      // Did the \"job\" get locked? Create a job object and run\n      if (resp.value) {\n        const job = createJob(self, resp.value);\n        debug('found job [%s] that can be locked on the fly', job.attrs.name);\n        self._lockedJobs.push(job);\n        definitions[job.attrs.name].locked++;\n        enqueueJobs(job);\n        jobProcessing();\n      }\n\n      // Mark lock on fly is done for now\n      self._isLockingOnTheFly = false;\n\n      // Re-run in case anything is in the queue\n      lockOnTheFly();\n    });\n  }\n\n  /**\n   * Internal method used to fill a queue with jobs that can be run\n   * @param {String} name fill a queue with specific job name\n   * @returns {undefined}\n   */\n  function jobQueueFilling(name) {\n    // Don't lock because of a limit we have set (lockLimit, etc)\n    if (!shouldLock(name)) {\n      debug('lock limit reached in queue filling for [%s]', name);\n      return;\n    }\n\n    // Set the date of the next time we are going to run _processEvery function\n    const now = new Date();\n    self._nextScanAt = new Date(now.valueOf() + self._processEvery);\n\n    // For this job name, find the next job to run and lock it!\n    self._findAndLockNextJob(name, definitions[name], (err, job) => {\n      if (err) {\n        debug('[%s] job lock failed while filling queue', name);\n        throw err;\n      }\n\n      // Still have the job?\n      // 1. Add it to lock list\n      // 2. Add count of locked jobs\n      // 3. Queue the job to actually be run now that it is locked\n      // 4. Recursively run this same method we are in to check for more available jobs of same type!\n      if (job) {\n        debug('[%s:%s] job locked while filling queue', name, job.attrs._id);\n        self._lockedJobs.push(job);\n        definitions[job.attrs.name].locked++;\n        enqueueJobs(job);\n        jobQueueFilling(name);\n        jobProcessing();\n      }\n    });\n  }\n\n  /**\n   * Internal method that processes any jobs in the local queue (array)\n   * @returns {undefined}\n   */\n  function jobProcessing() {\n    // Ensure we have jobs\n    if (jobQueue.length === 0) {\n      return;\n    }\n\n    // Store for all sorts of things\n    const now = new Date();\n\n    // Get the next job that is not blocked by concurrency\n    let next;\n    for (next = jobQueue.length - 1; next > 0; next -= 1) {\n      const def = definitions[jobQueue[next].attrs.name];\n      if (def.concurrency > def.running) {\n        break;\n      }\n    }\n\n    // We now have the job we are going to process and its definition\n    const job = jobQueue.splice(next, 1)[0];\n    const jobDefinition = definitions[job.attrs.name];\n\n    debug('[%s:%s] about to process job', job.attrs.name, job.attrs._id);\n\n    // If the 'nextRunAt' time is older than the current time, run the job\n    // Otherwise, setTimeout that gets called at the time of 'nextRunAt'\n    if (job.attrs.nextRunAt < now) {\n      debug('[%s:%s] nextRunAt is in the past, run the job immediately', job.attrs.name, job.attrs._id);\n      runOrRetry();\n    } else {\n      const runIn = job.attrs.nextRunAt - now;\n      debug('[%s:%s] nextRunAt is in the future, calling setTimeout(%d)', job.attrs.name, job.attrs._id, runIn);\n      setTimeout(runOrRetry, runIn);\n    }\n\n    /**\n     * Internal method that tries to run a job and if it fails, retries again!\n     * @returns {undefined}\n     */\n    function runOrRetry() {\n      if (self._processInterval) {\n        if (jobDefinition.concurrency > jobDefinition.running && self._runningJobs.length < self._maxConcurrency) {\n          // Get the deadline of when the job is not supposed to go past for locking\n          const lockDeadline = new Date(Date.now() - jobDefinition.lockLifetime);\n\n          // This means a job has \"expired\", as in it has not been \"touched\" within the lockoutTime\n          // Remove from local lock\n          // NOTE: Shouldn't we update the 'lockedAt' value in MongoDB so it can be picked up on restart?\n          if (job.attrs.lockedAt < lockDeadline) {\n            debug('[%s:%s] job lock has expired, freeing it up', job.attrs.name, job.attrs._id);\n            self._lockedJobs.splice(self._lockedJobs.indexOf(job), 1);\n            jobDefinition.locked--;\n            jobProcessing();\n            return;\n          }\n\n          // Add to local \"running\" queue\n          self._runningJobs.push(job);\n          jobDefinition.running++;\n\n          // CALL THE ACTUAL METHOD TO PROCESS THE JOB!!!\n          debug('[%s:%s] processing job', job.attrs.name, job.attrs._id);\n          job.run(processJobResult);\n\n          // Re-run the loop to check for more jobs to process (locally)\n          jobProcessing();\n        } else {\n          // Run the job immediately by putting it on the top of the queue\n          debug('[%s:%s] concurrency preventing immediate run, pushing job to top of queue', job.attrs.name, job.attrs._id);\n          enqueueJobs(job, true);\n        }\n      }\n    }\n  }\n\n  /**\n   * Internal method used to run the job definition\n   * @param {Error} err thrown if can't process job\n   * @param {module.Job} job job to process\n   * @returns {undefined}\n   */\n  function processJobResult(err, job) {\n    if (err && !job) {\n      throw (err);\n    }\n    const name = job.attrs.name;\n\n    // Job isn't in running jobs so throw an error\n    if (self._runningJobs.indexOf(job) === -1) {\n      debug('[%s] callback was called, job must have been marked as complete already', job.attrs._id);\n      throw new Error('callback already called - job ' + name + ' already marked complete');\n    }\n\n    // Remove the job from the running queue\n    self._runningJobs.splice(self._runningJobs.indexOf(job), 1);\n    if (definitions[name].running > 0) {\n      definitions[name].running--;\n    }\n\n    // Remove the job from the locked queue\n    self._lockedJobs.splice(self._lockedJobs.indexOf(job), 1);\n    if (definitions[name].locked > 0) {\n      definitions[name].locked--;\n    }\n\n    // Re-process jobs now that one has finished\n    jobProcessing();\n  }\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/lib/utils/process-jobs.js\n// module id = 87\n// module chunks = 0","'use strict';\nconst debug = require('debug')('agenda:purge');\n\n/**\n * Removes all jobs from queue\n * NOTE: Only use after defining your jobs\n * @param {Function} cb called when fails or passes\n * @returns {undefined}\n */\nmodule.exports = function(cb) {\n  const definedNames = Object.keys(this._definitions);\n  debug('Agenda.purge(%o)');\n  this.cancel({name: {$not: {$in: definedNames}}}, cb);\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/lib/agenda/purge.js\n// module id = 88\n// module chunks = 0","'use strict';\nconst debug = require('debug')('agenda:define');\n\n/**\n * Setup definition for job\n * Method is used by consumers of lib to setup their functions\n * @param {String} name name of job\n * @param {Object} options options for job to run\n * @param {Function} processor function to be called to run actual job\n * @returns {undefined}\n */\nmodule.exports = function(name, options, processor) {\n  if (!processor) {\n    processor = options;\n    options = {};\n  }\n  this._definitions[name] = {\n    fn: processor,\n    concurrency: options.concurrency || this._defaultConcurrency,\n    lockLimit: options.lockLimit || this._defaultLockLimit,\n    priority: options.priority || 0,\n    lockLifetime: options.lockLifetime || this._defaultLockLifetime,\n    running: 0,\n    locked: 0\n  };\n  debug('job [%s] defined with following options: \\n%O', name, this._definitions[name]);\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/lib/agenda/define.js\n// module id = 89\n// module chunks = 0","'use strict';\nconst debug = require('debug')('agenda:every');\n\n/**\n * Creates a scheduled job with given interval and name/names of the job to run\n * @param {Number} interval run every X interval\n * @param {*} names String or strings of jobs to schedule\n * @param {Object} data data to run for job\n * @param {Object} options options to run job for\n * @param {Function} cb called when schedule fails or passes\n * @returns {*} Job or jobs created\n */\nmodule.exports = function(interval, names, data, options, cb) {\n  const self = this;\n\n  if (cb === undefined && typeof data === 'function') {\n    cb = data;\n    data = undefined;\n  } else if (cb === undefined && typeof options === 'function') {\n    cb = options;\n    options = undefined;\n  }\n\n  /**\n   * Internal method to setup job that gets run every interval\n   * @param {Number} interval run every X interval\n   * @param {*} name String job to schedule\n   * @param {Object} data data to run for job\n   * @param {Object} options options to run job for\n   * @param {Function} cb called when schedule fails or passes\n   * @returns {module.Job} instance of job\n   */\n  const createJob = (interval, name, data, options, cb) => {\n    const job = self.create(name, data);\n    job.attrs.type = 'single';\n    job.repeatEvery(interval, options);\n    job.computeNextRunAt();\n    job.save(cb);\n    return job;\n  };\n\n  /**\n   * Internal helper method that uses createJob to create jobs for an array of names\n   * @param {Number} interval run every X interval\n   * @param {*} names Strings of jobs to schedule\n   * @param {Object} data data to run for job\n   * @param {Object} options options to run job for\n   * @param {Function} cb called when schedule fails or passes\n   * @returns {*} array of jobs created\n   */\n  const createJobs = (interval, names, data, options, cb) => {\n    const results = [];\n    let pending = names.length;\n    let errored = false;\n    return names.map((name, i) => {\n      return createJob(interval, name, data, options, (err, result) => {\n        if (err) {\n          if (!errored) {\n            cb(err);\n          }\n          errored = true;\n          return;\n        }\n        results[i] = result;\n        if (--pending === 0 && cb) {\n          debug('every() -> all jobs created successfully');\n          cb(null, results);\n        } else {\n          debug('every() -> error creating one or more of the jobs');\n        }\n      });\n    });\n  };\n\n  if (typeof names === 'string' || names instanceof String) {\n    debug('Agenda.every(%s, %O, [Object], %O, cb)', interval, names, options);\n    return createJob(interval, names, data, options, cb);\n  } else if (Array.isArray(names)) {\n    debug('Agenda.every(%s, %s, [Object], %O, cb)', interval, names, options);\n    return createJobs(interval, names, data, options, cb);\n  }\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/lib/agenda/every.js\n// module id = 90\n// module chunks = 0","'use strict';\nconst debug = require('debug')('agenda:schedule');\n\n/**\n * Schedule a job or jobs at a specific time\n * @param {String} when when the job gets run\n * @param {*} names array of job names to run\n * @param {Object} data data to send to job\n * @param {Function} cb called when schedule fails or passes\n * @returns {*} job or jobs created\n */\nmodule.exports = function(when, names, data, cb) {\n  const self = this;\n\n  if (cb === undefined && typeof data === 'function') {\n    cb = data;\n    data = undefined;\n  }\n\n  /**\n   * Internal method that creates a job with given date\n   * @param {String} when when the job gets run\n   * @param {String} name of job to run\n   * @param {Object} data data to send to job\n   * @param {Function} cb called when job persistence in MongoDB fails or passes\n   * @returns {module.Job} instance of new job\n   */\n  const createJob = (when, name, data, cb) => {\n    const job = self.create(name, data);\n    job.schedule(when);\n    job.save(cb);\n    return job;\n  };\n\n  /**\n   * Internal helper method that calls createJob on a names array\n   * @param {String} when when the job gets run\n   * @param {*} names of jobs to run\n   * @param {Object} data data to send to job\n   * @param {Function} cb called when job(s) persistence in MongoDB fails or passes\n   * @returns {*} jobs that were created\n   */\n  const createJobs = (when, names, data, cb) => {\n    const results = [];\n    let pending = names.length;\n    let errored = false;\n    return names.map((name, i) => {\n      return createJob(when, name, data, (err, result) => {\n        if (err) {\n          if (!errored) {\n            cb(err);\n          }\n          errored = true;\n          return;\n        }\n        results[i] = result;\n        if (--pending === 0 && cb) {\n          debug('Agenda.schedule()::createJobs() -> all jobs created successfully');\n          cb(null, results);\n        } else {\n          debug('Agenda.schedule()::createJobs() -> error creating one or more of the jobs');\n        }\n      });\n    });\n  };\n\n  if (typeof names === 'string' || names instanceof String) {\n    debug('Agenda.schedule(%s, %O, [Object], cb)', when, names);\n    return createJob(when, names, data, cb);\n  } else if (Array.isArray(names)) {\n    debug('Agenda.schedule(%s, %O, [Object], cb)', when, names);\n    return createJobs(when, names, data, cb);\n  }\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/lib/agenda/schedule.js\n// module id = 91\n// module chunks = 0","'use strict';\nconst debug = require('debug')('agenda:now');\n\n/**\n * Create a job for this exact moment\n * @param {String} name name of job to schedule\n * @param {Object} data data to pass to job\n * @param {Function} cb called when job scheduling fails or passes\n * @returns {module.Job} new job instance created\n */\nmodule.exports = function(name, data, cb) {\n  if (!cb && typeof data === 'function') {\n    cb = data;\n    data = undefined;\n  }\n  debug('Agenda.now(%s, [Object])', name);\n  const job = this.create(name, data);\n  job.schedule(new Date());\n  job.save(cb);\n  return job;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/lib/agenda/now.js\n// module id = 92\n// module chunks = 0","'use strict';\nconst debug = require('debug')('agenda:cancel');\n\n/**\n * Cancels any jobs matching the passed MongoDB query, and removes them from the database.\n *  @param {Object} query MongoDB query to use when cancelling\n *  @param {Function} cb callback(error, numRemoved) when cancellation fails or passes\n *  @caller client code, Agenda.purge(), Job.remove()\n *  @returns {undefined}\n */\nmodule.exports = function(query, cb) {\n  debug('attempting to cancel all Agenda jobs', query);\n  this._collection.deleteMany(query, (error, result) => {\n    if (cb) {\n      if (error) {\n        debug('error trying to delete jobs from MongoDB');\n      } else {\n        debug('jobs cancelled');\n      }\n      cb(error, result && result.result ? result.result.n : undefined);\n    }\n  });\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/lib/agenda/cancel.js\n// module id = 93\n// module chunks = 0","'use strict';\nconst debug = require('debug')('agenda:saveJob');\nconst utils = require('../utils');\n\nconst processJobs = utils.processJobs;\n\n/**\n * Save the properties on a job to MongoDB\n * @param {module.Job} job job to save into MongoDB\n * @param {Function} cb called when job is saved or errors\n * @returns {undefined}\n */\nmodule.exports = function(job, cb) {\n  debug('attempting to save a job into Agenda instance');\n\n  // Grab information needed to save job but that we don't want to persist in MongoDB\n  const fn = cb;\n  const self = this;\n  const id = job.attrs._id;\n  const unique = job.attrs.unique;\n  const uniqueOpts = job.attrs.uniqueOpts;\n\n  // Store job as JSON and remove props we don't want to store from object\n  const props = job.toJSON();\n  delete props._id;\n  delete props.unique;\n  delete props.uniqueOpts;\n\n  // Store name of agenda queue as last modifier in job data\n  props.lastModifiedBy = this._name;\n  debug('set job props: \\n%O', props);\n\n  // Grab current time and set default query options for MongoDB\n  const now = new Date();\n  const protect = {};\n  let update = {$set: props};\n  debug('current time stored as %s', now.toISOString());\n\n  // If the job already had an ID, then update the properties of the job\n  // i.e, who last modified it, etc\n  if (id) {\n    // Update the job and process the resulting data'\n    debug('job already has _id, calling findOneAndUpdate() using _id as query');\n    this._collection.findOneAndUpdate({\n      _id: id\n    },\n    update, {\n      returnOriginal: false\n    },\n    processDbResult);\n  } else if (props.type === 'single') {\n    // Job type set to 'single' so...\n    // NOTE: Again, not sure about difference between 'single' here and 'once' in job.js\n    debug('job with type of \"single\" found');\n\n    // If the nextRunAt time is older than the current time, \"protect\" that property, meaning, don't change\n    // a scheduled job's next run time!\n    if (props.nextRunAt && props.nextRunAt <= now) {\n      debug('job has a scheduled nextRunAt time, protecting that field from upsert');\n      protect.nextRunAt = props.nextRunAt;\n      delete props.nextRunAt;\n    }\n\n    // If we have things to protect, set them in MongoDB using $setOnInsert\n    if (Object.keys(protect).length > 0) {\n      update.$setOnInsert = protect;\n    }\n\n    // Try an upsert\n    // NOTE: 'single' again, not exactly sure what it means\n    debug('calling findOneAndUpdate() with job name and type of \"single\" as query');\n    this._collection.findOneAndUpdate({\n      name: props.name,\n      type: 'single'\n    },\n    update, {\n      upsert: true,\n      returnOriginal: false\n    },\n    processDbResult);\n  } else if (unique) {\n    // If we want the job to be unique, then we can upsert based on the 'unique' query object that was passed in\n    const query = job.attrs.unique;\n    query.name = props.name;\n    if (uniqueOpts && uniqueOpts.insertOnly) {\n      update = {$setOnInsert: props};\n    }\n\n    // Use the 'unique' query object to find an existing job or create a new one\n    debug('calling findOneAndUpdate() with unique object as query: \\n%O', query);\n    this._collection.findOneAndUpdate(query, update, {upsert: true, returnOriginal: false}, processDbResult);\n  } else {\n    // If all else fails, the job does not exist yet so we just insert it into MongoDB\n    debug('using default behavior, inserting new job via insertOne() with props that were set: \\n%O', props);\n    this._collection.insertOne(props, processDbResult);\n  }\n\n  /**\n   * Given a result for findOneAndUpdate() or insert() above, determine whether to process\n   * the job immediately or to let the processJobs() interval pick it up later\n   * @param {Error} err error passed in via MongoDB call as to whether modify call failed or passed\n   * @param {*} result the data returned from the findOneAndUpdate() call or insertOne() call\n   * @access private\n   * @returns {undefined}\n   */\n  function processDbResult(err, result) {\n    // Check if there is an error and either cb(error) or throw if there is no callback\n    if (err) {\n      debug('processDbResult() received an error, job was not updated/created');\n      if (fn) {\n        return fn(err);\n      }\n      throw err;\n    } else if (result) {\n      debug('processDbResult() called with success, checking whether to process job immediately or not');\n\n      // We have a result from the above calls\n      // findAndModify() returns different results than insertOne() so check for that\n      let res = result.ops ? result.ops : result.value;\n      if (res) {\n        // If it is an array, grab the first job\n        if (Array.isArray(res)) {\n          res = res[0];\n        }\n\n        // Grab ID and nextRunAt from MongoDB and store it as an attribute on Job\n        job.attrs._id = res._id;\n        job.attrs.nextRunAt = res.nextRunAt;\n\n        // If the current job would have been processed in an older scan, process the job immediately\n        if (job.attrs.nextRunAt && job.attrs.nextRunAt < self._nextScanAt) {\n          debug('[%s:%s] job would have ran by nextScanAt, processing the job immediately', job.attrs.name, res._id);\n          processJobs.call(self, job);\n        }\n      }\n    }\n\n    // If we have a callback, return the Job instance\n    if (fn) {\n      fn(null, job);\n    }\n  }\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/lib/agenda/save-job.js\n// module id = 94\n// module chunks = 0","'use strict';\nconst debug = require('debug')('agenda:start');\nconst utils = require('../utils');\n\nconst processJobs = utils.processJobs;\n\n/**\n * Starts processing jobs using processJobs() methods, storing an interval ID\n * @returns {undefined}\n */\nmodule.exports = function() {\n  if (this._processInterval) {\n    debug('Agenda.start was already called, ignoring');\n  } else {\n    debug('Agenda.start called, creating interval to call processJobs every [%dms]', this._processEvery);\n    this._processInterval = setInterval(processJobs.bind(this), this._processEvery);\n    process.nextTick(processJobs.bind(this));\n  }\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/lib/agenda/start.js\n// module id = 95\n// module chunks = 0","'use strict';\nconst debug = require('debug')('agenda:stop');\n\n/**\n * Clear the interval that processes the jobs\n * @param {Function} cb called when job unlocking fails or passes\n * @returns {undefined}\n */\nmodule.exports = function(cb) {\n  const self = this;\n  /**\n   * Internal method to unlock jobs so that they can be re-run\n   * NOTE: May need to update what properties get set here, since job unlocking seems to fail\n   * @param {Function} done callback called when job unlocking fails or passes\n   * @access private\n   * @returns {undefined}\n   */\n  const _unlockJobs = function(done) {\n    debug('Agenda._unlockJobs()');\n    const jobIds = self._lockedJobs.map(job => job.attrs._id);\n\n    if (jobIds.length === 0) {\n      debug('no jobs to unlock');\n      return done();\n    }\n\n    debug('about to unlock jobs with ids: %O', jobIds);\n    self._collection.updateMany({_id: {$in: jobIds}}, {$set: {lockedAt: null}}, err => {\n      if (err) {\n        return done(err);\n      }\n\n      self._lockedJobs = [];\n      return done();\n    });\n  };\n\n  debug('Agenda.stop called, clearing interval for processJobs()');\n  cb = cb || function() {};\n  clearInterval(this._processInterval);\n  this._processInterval = undefined;\n  _unlockJobs(cb);\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/lib/agenda/stop.js\n// module id = 96\n// module chunks = 0","'use strict';\nconst debug = require('debug')('agenda:_findAndLockNextJob');\nconst utils = require('../utils');\n\nconst createJob = utils.createJob;\n\n/**\n * Find and lock jobs\n * @param {String} jobName name of job to try to lock\n * @param {Object} definition definition used to tell how job is run\n * @param {Function} cb called when job lock fails or passes\n * @access protected\n * @caller jobQueueFilling() only\n * @returns {undefined}\n */\nmodule.exports = function(jobName, definition, cb) {\n  const self = this;\n  const now = new Date();\n  const lockDeadline = new Date(Date.now().valueOf() - definition.lockLifetime);\n  debug('_findAndLockNextJob(%s, [Function], cb)', jobName);\n\n  // Don't try and access MongoDB if we've lost connection to it.\n  // Trying to resolve crash on Dev PC when it resumes from sleep. NOTE: Does this still happen?\n  const s = this._mdb.s || this._mdb.db.s;\n  if (s.topology.connections().length === 0) {\n    if (s.topology.autoReconnect && !s.topology.isDestroyed()) {\n      // Continue processing but notify that Agenda has lost the connection\n      debug('Missing MongoDB connection, not attempting to find and lock a job');\n      self.emit('error', new Error('Lost MongoDB connection'));\n      cb();\n    } else {\n      // No longer recoverable\n      debug('topology.autoReconnect: %s, topology.isDestroyed(): %s', s.topology.autoReconnect, s.topology.isDestroyed());\n      cb(new Error('MongoDB connection is not recoverable, application restart required'));\n    }\n  } else {\n    /**\n    * Query used to find job to run\n    * @type {{$or: [*]}}\n    */\n    const JOB_PROCESS_WHERE_QUERY = {\n      $or: [{\n        name: jobName,\n        lockedAt: null,\n        nextRunAt: {$lte: this._nextScanAt},\n        disabled: {$ne: true}\n      }, {\n        name: jobName,\n        lockedAt: {$exists: false},\n        nextRunAt: {$lte: this._nextScanAt},\n        disabled: {$ne: true}\n      }, {\n        name: jobName,\n        lockedAt: {$lte: lockDeadline},\n        disabled: {$ne: true}\n      }]\n    };\n\n    /**\n    * Query used to set a job as locked\n    * @type {{$set: {lockedAt: Date}}}\n    */\n    const JOB_PROCESS_SET_QUERY = {$set: {lockedAt: now}};\n\n    /**\n    * Query used to affect what gets returned\n    * @type {{returnOriginal: boolean, sort: object}}\n    */\n    const JOB_RETURN_QUERY = {returnOriginal: false, sort: this._sort};\n\n    // Find ONE and ONLY ONE job and set the 'lockedAt' time so that job begins to be processed\n    this._collection.findOneAndUpdate(JOB_PROCESS_WHERE_QUERY, JOB_PROCESS_SET_QUERY, JOB_RETURN_QUERY, (err, result) => {\n      let job;\n      if (!err && result.value) {\n        debug('found a job available to lock, creating a new job on Agenda with id [%s]', result.value._id);\n        job = createJob(self, result.value);\n      }\n      if (err) {\n        debug('error occurred when running query to find and lock job');\n      }\n      cb(err, job);\n    });\n  }\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/Agenda/lib/agenda/find-and-lock-next-job.js\n// module id = 97\n// module chunks = 0","module.exports = require(\"lodash\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"lodash\"\n// module id = 98\n// module chunks = 0","import mongoose, {Schema} from 'mongoose';\n\nconst JourneyContentSchema = new Schema({\n  filePath: {type: String},\n  image: {type: String},\n}, {\n  timestamps: true\n});\n\nconst JourneyContent = mongoose.model('JourneyContent', JourneyContentSchema);\n\nexport default JourneyContent;\n\n\n\n\n\n// WEBPACK FOOTER //\n// ./models/journey_content.js"],"sourceRoot":""}