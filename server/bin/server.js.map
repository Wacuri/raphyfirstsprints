{"version":3,"sources":["webpack:///webpack/bootstrap 34094e97c233c1d82d0f","webpack:///external \"react\"","webpack:///external \"express\"","webpack:///external \"mongoose\"","webpack:///external \"dotenv\"","webpack:///external \"path\"","webpack:///external \"isomorphic-fetch\"","webpack:///external \"opentok-react\"","webpack:///external \"@opentok/client\"","webpack:///external \"react-easy-state\"","webpack:///external \"babel-polyfill/lib/index\"","webpack:///./index.js","webpack:///./routes/index.js","webpack:///external \"body-parser\"","webpack:///./routes/api.js","webpack:///external \"fs\"","webpack:///external \"opentok\"","webpack:///./models/tok_session.js","webpack:///external \"another-mongoose-statemachine\"","webpack:///./models/tok_session_participant.js","webpack:///./routes/ssr.js","webpack:///external \"react-dom/server\"","webpack:///external \"redux\"","webpack:///external \"react-redux\"","webpack:///external \"react-router\"","webpack:///../client/src/app.js","webpack:///external \"react-router-dom\"","webpack:///../client/src/components/header.js","webpack:///../client/src/components/home.js","webpack:///../client/src/components/generator_form.js","webpack:///../client/src/components/session_info.js","webpack:///../client/src/components/event_message.js","webpack:///../client/src/components/Room.js","webpack:///../client/src/state.js","webpack:///external \"prop-types\"","webpack:///external \"uuid\"","webpack:///external \"opentok-layout-js\"","webpack:///external \"es6-promise\""],"names":["dotenv","require","config","global","__CLIENT__","__SERVER__","routes","exports","app","set","path","join","__dirname","use","bodyParser","json","express","static","api","ssr","listen","process","env","PORT","console","log","mongoose","connect","MONGODB_URI","MONGO_URL","promisify","fn","promisified","params","Promise","resolve","reject","concat","err","args","length","opentok","OpenTok","OPENTOK_KEY","OPENTOK_SECRET","router","Router","generateToken","sessionId","tokenOptions","role","token","get","req","res","room","TokSession","findOne","lean","exec","existingSession","TokSessionParticipant","find","session","present","participants","createSession","newSession","save","toJSON","signal","type","data","sendStatus","connection","connectionId","participant","ready","count","allReady","readdirAsync","fs","readdir","extname","file","journeyFiles","filter","map","put","journey","body","post","start","flags","push","user","event","id","participantExists","fetch","headers","method","mode","JSON","stringify","then","response","FlagSchema","Schema","String","reason","TokSessionSchema","index","default","plugin","statemachine","states","created","started","completed","transitions","from","to","end","model","TokSessionParticipantSchema","Types","ObjectId","ref","Boolean","context","html","ReactDOMServer","renderToString","originalUrl","url","writeHead","Location","status","render","NODE_ENV","script","openTokKey","App","Home","Room","Header","OTSession","OTPublisher","OTStreams","OTSubscriber","OT","window","state","props","streams","publisherId","totalConnectionsCreated","connectedUsers","publisher","roomUrl","sessionHelper","apiKey","onConnect","setTimeout","refreshSession","onStreamsUpdated","setState","sh","on","updatedConnectionCount","newData","indexOf","splice","displayMessageVisible","displayMessageText","sessionUrl","journeys","Component","GeneratorForm","sessionLinkName","sessionLinkUrl","handleNameChange","bind","urlFriendlyName","createSessionLink","target","value","name","replace","toLowerCase","SessionInfo","jumpToSession","nextProps","sessionLink","open","fontWeight","backgroundColor","padding","EventMessage","message","undefined","polyfill","match","onInitPublisher","onConfirmReady","e","onChangeJourney","cache","credentials","redirect","referrer","onStartSession","onLoadedMetadata","journeyDuration","duration","audioTag","removeEventListener","onTimeUpdate","addEventListener","playerProgress","currentTime","playerProgressMS","onFlag","preventDefault","playerState","publishAudio","play","disconnect","currentParticipant","currentUserHasFlaggedJourney","flag","display","position","top","right","split","width","flex","timeRemaining","container","gridTemplateColumns","gridGap","marginRight","stream","fontSize","bottom","seconds","minutes","Math","floor","remainingSeconds","toFixed","__INITIAL_STATE__"],"mappings":"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","file":"./server.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 9);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 34094e97c233c1d82d0f","module.exports = require(\"react\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"react\"\n// module id = 0\n// module chunks = 0","module.exports = require(\"express\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"express\"\n// module id = 1\n// module chunks = 0","module.exports = require(\"mongoose\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"mongoose\"\n// module id = 2\n// module chunks = 0","module.exports = require(\"dotenv\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"dotenv\"\n// module id = 3\n// module chunks = 0","module.exports = require(\"path\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"path\"\n// module id = 4\n// module chunks = 0","module.exports = require(\"isomorphic-fetch\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"isomorphic-fetch\"\n// module id = 5\n// module chunks = 0","module.exports = require(\"opentok-react\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"opentok-react\"\n// module id = 6\n// module chunks = 0","module.exports = require(\"@opentok/client\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"@opentok/client\"\n// module id = 7\n// module chunks = 0","module.exports = require(\"react-easy-state\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"react-easy-state\"\n// module id = 8\n// module chunks = 0","module.exports = require(\"babel-polyfill/lib/index\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"babel-polyfill/lib/index\"\n// module id = 10\n// module chunks = 0","const dotenv = require('dotenv');\n\ndotenv.config();\nglobal.__CLIENT__ = false;\nglobal.__SERVER__ = true;\n\nconst routes = require('./routes');\n\nexports = routes;\n\n\n\n// WEBPACK FOOTER //\n// ./index.js","import path from 'path';\nimport express from 'express';\nimport bodyParser from 'body-parser';\nimport api from './api';\nimport ssr from './ssr';\n\nconst app = express();\n\napp.set('view engine', 'ejs');\napp.set('views', path.join(__dirname, '../views'));\napp.use(bodyParser.json());\n\napp.use(express.static(path.join(__dirname, '..', 'public')));\n\napp.use('/api', api);\napp.use('/*', ssr);\n\napp.listen(process.env.PORT || 5000, () => {\n  console.log('Hello World listening on port 5000!');\n});\n\n\n\n// WEBPACK FOOTER //\n// ./routes/index.js","module.exports = require(\"body-parser\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"body-parser\"\n// module id = 13\n// module chunks = 0","import fs from 'fs';\nimport path from 'path';\nimport express from 'express';\nimport OpenTok from 'opentok';\nimport mongoose from 'mongoose';\nimport TokSession from '../models/tok_session';\nimport TokSessionParticipant from '../models/tok_session_participant';\nimport dotenv from 'dotenv';\nrequire('isomorphic-fetch');\n\ndotenv.config();\n\nmongoose.connect(process.env.MONGODB_URI || process.env.MONGO_URL);\n\nfunction promisify(fn) {\n  /**\n   * @param {...Any} params The params to pass into *fn*\n   * @return {Promise<Any|Any[]>}\n   */\n  return function promisified(...params) {\n    return new Promise((resolve, reject) => fn(...params.concat([(err, ...args) => err ? reject(err) : resolve( args.length < 2 ? args[0] : args )])))\n  }\n}\n\nconst opentok = new OpenTok(process.env.OPENTOK_KEY, process.env.OPENTOK_SECRET);\nconst router = express.Router();\n\nfunction generateToken(sessionId) {\n\tlet tokenOptions = {};\n\ttokenOptions.role = \"publisher\";\n\t// Generate a token.\n\tconst token = opentok.generateToken(sessionId, tokenOptions);\n  console.log('return token', token);\n\treturn token;\n}\n\n// TODO: switch to POST, just using GET for easier testing\nrouter.get('/sessions/:room', async (req, res) => {\n\tconst {room} = req.params;\n\tconst existingSession = await TokSession.findOne({room}).lean().exec();\n\tif (existingSession) {\n    const participants = await TokSessionParticipant.find({session: existingSession, present: true}).lean().exec();\n    existingSession.participants = participants;\n\t\tres.json({\n\t\t\t...existingSession,\n\t\t\ttoken: generateToken(existingSession.sessionId),\n\t\t});\n\t} else {\n\t\topentok.createSession(async (err, session) => {\n\t\t  if (err) throw err;\n\t\t\t// save the sessionId\n\t\t\tconst newSession = new TokSession({room, sessionId: session.sessionId});\n\t\t\tawait newSession.save();\n\t\t\tres.json({\n\t\t\t\t...newSession.toJSON(),\n\t\t\t\ttoken: generateToken(session.sessionId),\n\t\t\t});\n\t\t});\n\t}\n});\n\n// TEMP: Use get for convenience. hardcode temp-home-location for the room\n// Trigger a general announcement to everyone\nrouter.get('/sessions/test/temp-home-location', async (req, res) => {\n  // const {room, connection} = req.params;\n  const existingSession = await TokSession.findOne({room:'temp-home-location'}).exec();\n  if (existingSession) {\n  console.log(\"**** SENDING SIGNAL\")\n  signal(existingSession.sessionId, {type: 'displayJourneyRequest', data: 'Rob has started a session. Join him (link)'});\n  return res.sendStatus(200);\n  }\n  res.sendStatus(200);\n});\n\nrouter.get('/sessions/:room/connections/:connection/ready', async (req, res) => {\n  const {room, connection} = req.params;\n  const existingSession = await TokSession.findOne({room}).exec();\n\tif (existingSession) {\n    const participant = await TokSessionParticipant.findOne({session: existingSession, connectionId: connection});\n    participant.ready = true;\n    await participant.save();\n    signal(existingSession.sessionId, {type: 'ready', data: 'foo'});\n    const allReady = (await TokSessionParticipant.count({session: existingSession, ready: false, present: true})) === 0;\n    if (allReady) {\n      // signal(existingSession.sessionId, {type: 'startJourney', data: 'foo'});\n    }\n    return res.sendStatus(200);\n  }\n  res.sendStatus(200);\n});\n\nrouter.get('/journeys', async (req, res) => {\n  const readdirAsync = promisify(fs.readdir)\n  const journeyFiles = (await readdirAsync(path.join(__dirname, '..', 'public/journeys'))).filter(file => {\n    return path.extname(file) === '.mp3';\n  }).map(file => {\n    return `/journeys/${file}`\n  });\n  res.json(journeyFiles);\n});\n\nrouter.put('/sessions/:room/journey', async (req, res) => {\n  console.log('UPDATE JOURNEY');\n  const {journey} = req.body;\n  const {room} = req.params;\n  const existingSession = await TokSession.findOne({room}).exec();\n\tif (existingSession) {\n    existingSession.journey = journey;\n    await existingSession.save();\n    signal(existingSession.sessionId, {type: 'updatedJourney', data: journey});\n  }\n  res.sendStatus(200);\n});\n\n// TODO: this should really verify that the user hitting this endpoint is authorized to do so (e.g. that they are the journey's host)\nrouter.post('/sessions/:room/start', async (req, res) => {\n  const {room} = req.params;\n  const existingSession = await TokSession.findOne({room}).exec();\n\tif (existingSession) {\n    await existingSession.start();\n    signal(existingSession.sessionId, {type: 'startJourney', data: ''});\n  }\n});\n\nrouter.post('/sessions/:room/flag', async (req, res) => {\n  const {room} = req.params;\n  const {connectionId} = req.body;\n  const existingSession = await TokSession.findOne({room}).exec();\n\tif (existingSession) {\n    existingSession.flags.push({user: connectionId});\n    await existingSession.save();\n    const participants = await TokSessionParticipant.find({session: existingSession, present: true}).lean().exec();\n    return res.json({...existingSession.toJSON(), participants});\n  }\n  res.sendStatus(404);\n});\n\nrouter.post('/event', async (req, res) => {\n  console.log('GOT EVENT', req.body);\n  res.sendStatus(200);\n  const {sessionId, connection} = req.body;\n  const session = await TokSession.findOne({sessionId}).exec();\n\n  console.log(\"*******\" + req.body)\n\n  switch(req.body.event) {\n    case 'connectionCreated':\n      if (session) {\n        const participantExists = (await TokSessionParticipant.count({session, connectionId: connection.id})) > 0;\n        if (!participantExists) {\n          const participant = new TokSessionParticipant({session, connectionId: connection.id});\n          await participant.save();\n        }\n      }\n      break;\n    case 'connectionDestroyed':\n      if (session) {\n        const participant= await TokSessionParticipant.findOne({session, connectionId: connection.id});\n        if (participant) {\n          participant.present = false;\n          await participant.save();\n        }\n      }\n      break\n  }\n});\n\nfunction signal(sessionId, data) {\n  fetch(`https://api.opentok.com/v2/project/${process.env.OPENTOK_KEY}/session/${sessionId}/signal`, {\n    headers: {\n      'X-TB-PARTNER-AUTH': `${process.env.OPENTOK_KEY}:${process.env.OPENTOK_SECRET}`\n    },\n    method: 'POST',\n    mode: 'cors',\n    body: JSON.stringify(data)\n  }).then(response => console.log(response));\n}\n\nexport default router;\n\n\n\n\n// WEBPACK FOOTER //\n// ./routes/api.js","module.exports = require(\"fs\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"fs\"\n// module id = 15\n// module chunks = 0","module.exports = require(\"opentok\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"opentok\"\n// module id = 16\n// module chunks = 0","import mongoose, {Schema} from 'mongoose';\nimport statemachine from 'another-mongoose-statemachine';\n\nconst FlagSchema = new Schema({\n  user: {type: String},\n  reason: {type: String},\n});\n\nconst TokSessionSchema = new Schema({\n  room: {type: String, index: true},\n  sessionId: {type: String, index: true},\n  journey: {type: String, default: '/journeys/Journey to A Spiderweb+Music.mp3'},\n  flags: {type: [FlagSchema], default: []},\n});\n\nTokSessionSchema.plugin(statemachine, {\n  states: {\n    created: {default: true},\n    started: {},\n    completed: {}\n  },\n  transitions: {\n    start: { from: 'created', to: 'started' },\n    end: { from: '*', to: 'completed' },\n  }\n});\n\nconst TokSession = mongoose.model('TokSession', TokSessionSchema);\n\nexport default TokSession;\n\n\n\n\n// WEBPACK FOOTER //\n// ./models/tok_session.js","module.exports = require(\"another-mongoose-statemachine\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"another-mongoose-statemachine\"\n// module id = 18\n// module chunks = 0","import mongoose, {Schema} from 'mongoose';\n\nconst TokSessionParticipantSchema = new Schema({\n  \"connectionId\": {type: String, index: true},\n  \"session\": {type: Schema.Types.ObjectId, ref: 'TokSession'},\n  \"ready\": {type: Boolean, default: false},\n  \"present\": {type: Boolean, default: true},\n});\n\nconst TokSessionParticipant = mongoose.model('TokSessionParticipant', TokSessionParticipantSchema);\n\nexport default TokSessionParticipant;\n\n\n\n\n// WEBPACK FOOTER //\n// ./models/tok_session_participant.js","import express from 'express';\nimport React from 'react';\nimport ReactDOMServer from 'react-dom/server';\nimport { createStore } from 'redux';\nimport { Provider } from 'react-redux';\nimport { StaticRouter } from 'react-router';\nimport App from '../../client/src/app';\nconsole.log(process.env);\n\nconst router = express.Router();\n\nrouter.get('/', (req, res) => {\n  const context = {};\n\n  const html = ReactDOMServer.renderToString(\n    <StaticRouter\n      location={req.originalUrl}\n      context={context}\n    >\n      <App />\n    </StaticRouter>\n  );\n\n  if (context.url) {\n    res.writeHead(301, {\n      Location: context.url,\n    });\n    res.end();\n  } else {\n    res.status(200).render(process.env.NODE_ENV === 'production' ? 'index.ejs' : 'index.dev.ejs', {\n      html,\n      script: JSON.stringify({openTokKey: process.env.OPENTOK_KEY}),\n    });\n  }\n});\n\n\nexport default router;\n\n\n\n// WEBPACK FOOTER //\n// ./routes/ssr.js","module.exports = require(\"react-dom/server\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"react-dom/server\"\n// module id = 21\n// module chunks = 0","module.exports = require(\"redux\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"redux\"\n// module id = 22\n// module chunks = 0","module.exports = require(\"react-redux\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"react-redux\"\n// module id = 23\n// module chunks = 0","module.exports = require(\"react-router\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"react-router\"\n// module id = 24\n// module chunks = 0","import React from 'react';\nimport { Route } from 'react-router-dom';\nimport Header from './components/header';\nimport Home from './components/home';\nimport Room from './components/Room';\n\nconst App = () => (\n  <div>\n    <Header />\n    <Route exact path=\"/\" component={Home} />\n\t\t<Route exact path=\"/:room\" component={Room} />\n  </div>\n);\n\nexport default App;\n\n\n\n// WEBPACK FOOTER //\n// ../client/src/app.js","module.exports = require(\"react-router-dom\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"react-router-dom\"\n// module id = 26\n// module chunks = 0","import React from 'react';\n\nconst Header = () => (\n  <div className=\"header pl-4\">\n    <h1>Get started with Wacuri!</h1>\n  </div>\n);\n\nexport default Header;\n\n\n\n// WEBPACK FOOTER //\n// ../client/src/components/header.js","import React from 'react';\nimport GeneratorForm from './generator_form'\nimport EventMessage from './event_message'\n\n\nvar { OTSession, OTPublisher, OTStreams, OTSubscriber, createSession } = {};\n\nif (__CLIENT__) {\n  var { OTSession, OTPublisher, OTStreams, OTSubscriber, createSession } = require('opentok-react');\n  const OT = require('@opentok/client');\n  window.state = state;\n}\n\n\nexport default class Home extends Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      streams: [],\n      publisherId: '',\n      session: null,\n      totalConnectionsCreated: 0,\n      connectedUsers: []\n    }\n    this.publisher = {};\n  }\n\n\n  componentDidMount() {\n    const roomUrl = 'temp-home-location'\n\n    fetch(`/api/sessions/${roomUrl}`)\n      .then(res => res.json())\n      .then(json => {\n        state.session = json;\n        this.sessionHelper = createSession({\n          apiKey: state.openTokKey,\n          sessionId: state.session.sessionId,\n          token: state.session.token,\n          onConnect: () => {\n            console.log('assigned connection to publisher', this.sessionHelper.session.connection);\n            setTimeout(this.refreshSession, 1000);\n          },\n          onStreamsUpdated: streams => {\n            console.log('Current subscriber streams:', streams);\n            this.setState({ streams });\n          }\n        });\n        window.sh = this.sessionHelper;\n        this.sessionHelper.session.on(\"connectionDestroyed\", (event) => {\n          console.log('DESTROYED', event);\n          const data = {\n            sessionId: this.sessionHelper.session.sessionId,\n            connection: {\n              id: event.connection.id\n            },\n            event: 'connectionDestroyed',\n\n          }\n\n          const updatedConnectionCount = this.state.totalConnectionsCreated - 1\n          this.setState({totalConnectionsCreated: updatedConnectionCount})\n\n          let newData = [...this.state.connectedUsers]\n          let index = newData.indexOf(event.connection.id)\n          newData.splice(index, 1)\n          this.setState({connectedUsers: newData})\n\n          console.log('data is', data);\n          // fetch(`/api/event`, {\n          //   body: JSON.stringify(data), // must match 'Content-Type' header\n          //   cache: 'no-cache', // *default, no-cache, reload, force-cache, only-if-cached\n          //   credentials: 'same-origin', // include, same-origin, *omit\n          //   headers: {\n          //     'user-agent': 'Mozilla/4.0 MDN Example',\n          //     'content-type': 'application/json'\n          //   },\n          //   method: 'POST', // *GET, POST, PUT, DELETE, etc.\n          //   mode: 'cors', // no-cors, cors, *same-origin\n          //   redirect: 'follow', // manual, *follow, error\n          //   referrer: 'no-referrer', // *client, no-referrer\n          // });\n          // this.refreshSession();\n        });\n\n\n\n        this.sessionHelper.session.on(\"connectionCreated\", (event) => {\n          console.log('CREATED', event);\n          const updatedConnectionCount = this.state.totalConnectionsCreated + 1\n          this.setState({totalConnectionsCreated: updatedConnectionCount})\n          console.log('**** Total connections: ' + this.state.totalConnectionsCreated)\n          const data = {\n            sessionId: this.sessionHelper.session.sessionId,\n            connection: {\n              id: event.connection.id\n            },\n            event: 'connectionCreated',\n          }\n\n          this.setState({ connectedUsers: [...this.state.connectedUsers, event.connection.id] })\n          console.log('data is', data);\n          // fetch(`/api/event`, {\n          //   body: JSON.stringify(data), // must match 'Content-Type' header\n          //   cache: 'no-cache', // *default, no-cache, reload, force-cache, only-if-cached\n          //   credentials: 'same-origin', // include, same-origin, *omit\n          //   headers: {\n          //     'user-agent': 'Mozilla/4.0 MDN Example',\n          //     'content-type': 'application/json'\n          //   },\n          //   method: 'POST', // *GET, POST, PUT, DELETE, etc.\n          //   mode: 'cors', // no-cors, cors, *same-origin\n          //   redirect: 'follow', // manual, *follow, error\n          //   referrer: 'no-referrer', // *client, no-referrer\n          // });\n          // this.refreshSession();\n        });\n\n\n\n        this.sessionHelper.session.on(\"signal\", (event) => {\n          console.log(\"Signal sent from connection \", event);\n          console.log(\"Signal type\", event.type);\n          // this.refreshSession(); // FIXME Error: home.js:110 Uncaught TypeError: _this2.refreshSession is not a function\n\n          if (event.type === 'signal:displayJourneyRequest') {\n            console.log(\"**** CAPTURED the journey request !! \")\n            this.setState({\n              displayMessageVisible: true,\n              displayMessageText: \"George has created a session 'Daily Jetsons Meditation'.\", //TEMP hard coded\n              sessionUrl: '/another-jetsons-url'\n            });\n          }\n        });\n\n        this.setState({\n          session: this.sessionHelper.session\n        });\n      });\n\n\n    fetch('/api/journeys')\n      .then(res => res.json())\n      .then(json => {\n        state.journeys = json;\n      });\n\n  }\n\n\n\n\n\n  render() {\n    return (\n      <div className=\"home\">\n        <UserList userCount={this.state.totalConnectionsCreated} userIds={this.state.connectedUsers} />\n        <EventMessage message={this.state.displayMessageText} sessionUrl={this.state.sessionUrl} />\n        <GeneratorForm />\n      </div>\n      )\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ../client/src/components/home.js","import React, {Component} from 'react'\nimport SessionInfo from './session_info'\n\nexport default class GeneratorForm extends Component {\n\n  constructor(props){\n    super(props)\n    this.state = {\n      sessionLinkName: '',\n      sessionLinkUrl: ''\n    }\n\n    this.handleNameChange = this.handleNameChange.bind(this)\n    this.urlFriendlyName = this.urlFriendlyName.bind(this)\n    this.createSessionLink = this.createSessionLink.bind(this)\n  }\n\n  createSessionLink() {\n    this.setState({sessionLinkUrl: this.urlFriendlyName(this.state.sessionLinkName) })\n    fetch('/api/sessions/test/temp-home-location')\n  }\n\n  sendNotifications() {\n\n  }\n\n  handleNameChange(event) {\n    this.setState({sessionLinkName: event.target.value})\n  }\n\n  urlFriendlyName(name){\n    return name.replace(/\\s+/g, '-').toLowerCase()\n  }\n\n\n  render() {\n      return(\n        <div>\n          <form>\n            <h3>Enter Session Details</h3>\n            <p>\n              Give your room a name:<br/>\n              <input type=\"text\" id=\"session_link\" onChange={this.handleNameChange} /> &nbsp; or <a href='#'>Generate a name</a>\n            </p>\n            <p>\n              Description (optional):<br/>\n              <textarea id=\"session_description\" rows=\"2\" cols=\"25\"></textarea>\n            </p>\n            <p>\n              <input type=\"button\" value=\"Create a session\" onClick={this.createSessionLink} />\n\n            </p>\n          </form>\n          <SessionInfo sessionLink={this.state.sessionLinkUrl} />\n        </div>\n      )\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ../client/src/components/generator_form.js","import React, {Component} from 'react'\n\nexport default class SessionInfo extends Component {\n\n  constructor(props){\n    super(props)\n    this.state = {\n      sessionLinkName: 'Reasonable Default',\n      sessionLinkUrl: 'reasonable-default'\n    }\n\n    this.jumpToSession = this.jumpToSession.bind(this)\n  }\n\n  componentWillReceiveProps(nextProps) {\n    this.setState({ sessionLinkUrl: nextProps.sessionLink });\n  }\n\n  jumpToSession() {\n    window.open(this.state.sessionLinkUrl, \"_blank\")\n  }\n\n  // TODO: npm install --save react@^16.2.0 react-dom@^16.2.0 for getDerivedstateFromProps\n\n  render() {\n      return(\n        <div>\n          <h3>Session Created</h3>\n          <p><span style={{ fontWeight: 'bold', backgroundColor: '#ccc', padding: '7px' }}>www.wacuri.com/{this.state.sessionLinkUrl}</span> <a href=\"#\">Copy link to share</a></p>\n\n            <p><input type=\"button\" value=\"Jump to the session\" onClick={this.jumpToSession} /></p>\n\n        </div>\n      )\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ../client/src/components/session_info.js","import React, {Component} from 'react'\n\nexport default class EventMessage extends Component {\n  constructor(props) {\n    super(props);\n  }\n\n  render() {\n    return (\n      <div style={{ backgroundColor: '#fc9' }}>\n        {this.props.message} {this.props.message === undefined ? \"\" : (<a href={this.props.sessionUrl} target='_blank'>Join Now</a>)}\n      </div>\n    )\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ../client/src/components/event_message.js","import React, {Component} from 'react';\nimport { view } from 'react-easy-state'\nimport state from '../state';\nimport PropTypes from 'prop-types';\nimport uuid from 'uuid';\nimport {initLayoutContainer} from 'opentok-layout-js';\nrequire('es6-promise').polyfill();\nrequire('isomorphic-fetch');\n\nvar { OTSession, OTPublisher, OTStreams, OTSubscriber, createSession } = {};\n\nif (__CLIENT__) {\n\tvar { OTSession, OTPublisher, OTStreams, OTSubscriber, createSession } = require('opentok-react');\n\tconst OT = require('@opentok/client');\n\twindow.state = state;\n}\n\nclass Room extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      streams: [],\n      publisherId: '',\n      session: null,\n      playerState: 'waiting',\n      playerProgress: 0,\n      playerProgressMS: 0,\n      journeyDuration: 0,\n    }\n    this.publisher = {};\n    this.audioTag = {};\n  }\n\n\tcomponentDidMount() {\n    this.audioTag.addEventListener('ended', (event) => {\n      this.publisher.state.publisher.publishAudio(true);\n      this.setState({\n        playerState: 'ended'\n      });\n    });\n\n\t\tfetch(`/api/sessions/${this.props.match.params.room}`)\n\t\t\t.then(res => res.json())\n\t\t\t.then(json => {\n\t\t\t\tstate.session = json;\n        this.sessionHelper = createSession({\n          apiKey: state.openTokKey,\n          sessionId: state.session.sessionId,\n          token: state.session.token,\n          onConnect: () => {\n            console.log('assigned connection to publisher', this.sessionHelper.session.connection);\n            setTimeout(this.refreshSession, 1000);\n          },\n          onStreamsUpdated: streams => {\n            console.log('Current subscriber streams:', streams);\n            this.setState({ streams });\n          }\n        });\n        this.sessionHelper.session.on(\"connectionDestroyed\", (event) => {\n          console.log('DESTROYED', event);\n          const data = {\n            sessionId: this.sessionHelper.session.sessionId,\n            connection: {\n              id: event.connection.id\n            },\n            event: 'connectionDestroyed',\n          }\n          this.refreshSession();\n        });\n        this.sessionHelper.session.on(\"connectionCreated\", (event) => {\n          console.log('CREATED', event);\n          const data = {\n            sessionId: this.sessionHelper.session.sessionId,\n            connection: {\n              id: event.connection.id\n            },\n            event: 'connectionCreated',\n          }\n          this.refreshSession();\n        });\n        this.sessionHelper.session.on(\"signal\", (event) => {\n          console.log(\"Signal sent from connection \", event);\n          this.refreshSession();\n          if (event.type === 'signal:startJourney') {\n            this.publisher.state.publisher.publishAudio(false);\n            this.audioTag.play();\n            this.setState({\n              playerState: 'playing'\n            });\n          }\n        });\n        this.setState({\n          session: this.sessionHelper.session\n        });\n\t\t\t});\n    fetch('/api/journeys')\n      .then(res => res.json())\n      .then(json => {\n        state.journeys = json;\n      });\n\t}\n\n  componentWillUnmount() {\n    if (this.sessionHelper) {\n      this.sessionHelper.disconnect();\n    }\n  }\n\n  refreshSession = () => {\n\t\tfetch(`/api/sessions/${this.props.match.params.room}`)\n\t\t\t.then(res => res.json())\n\t\t\t.then(json => {\n\t\t\t\tstate.session = json;\n      });\n  }\n\n  get timeRemaining() {\n    const seconds = this.state.journeyDuration - this.state.playerProgressMS;\n    const minutes = Math.floor(seconds / 60);\n    const remainingSeconds = (seconds % 60).toFixed(0);\n    return minutes + \":\" + (remainingSeconds < 10 ? '0' : '') + remainingSeconds;\n  }\n\n  onInitPublisher = () => {\n    console.log('initialized publisher');\n  }\n\n  onConfirmReady = (e) => {\n    fetch(`/api/sessions/${this.props.match.params.room}/connections/${this.sessionHelper.session.connection.id}/ready`);\n  }\n\n  onChangeJourney = (e) => {\n    console.log('CHANGE', e.target.value);\n    fetch(`/api/sessions/${this.props.match.params.room}/journey`, {\n      body: JSON.stringify({journey: e.target.value}), // must match 'Content-Type' header\n      cache: 'no-cache', // *default, no-cache, reload, force-cache, only-if-cached\n      credentials: 'same-origin', // include, same-origin, *omit\n      headers: {\n        'user-agent': 'Mozilla/4.0 MDN Example',\n        'content-type': 'application/json'\n      },\n      method: 'PUT', // *GET, POST, PUT, DELETE, etc.\n      mode: 'cors', // no-cors, cors, *same-origin\n      redirect: 'follow', // manual, *follow, error\n      referrer: 'no-referrer', // *client, no-referrer\n    });\n  }\n\n  onStartSession = (e) => {\n    fetch(`/api/sessions/${this.props.match.params.room}/start`, {\n      cache: 'no-cache',\n      credentials: 'same-origin',\n      headers: {\n        'user-agent': 'Mozilla/4.0 MDN Example',\n        'content-type': 'application/json'\n      },\n      method: 'POST',\n      mode: 'cors',\n    });\n  }\n\n  onLoadedMetadata = (e) => {\n    this.setState({\n      journeyDuration: e.target.duration\n    });\n    this.audioTag.removeEventListener('timeupdate', this.onTimeUpdate);\n    this.audioTag.addEventListener('timeupdate', this.onTimeUpdate);\n  }\n\n  onTimeUpdate = (e) => {\n    this.setState({\n      playerProgress: (e.target.currentTime / e.target.duration) * 100,\n      playerProgressMS: e.target.currentTime,\n    });\n  }\n\n  onFlag = (e) => {\n    e.preventDefault();\n    fetch(`/api/sessions/${this.props.match.params.room}/flag`, {\n      cache: 'no-cache',\n      body: JSON.stringify({connectionId: this.state.session.connection.id}),\n      credentials: 'same-origin',\n      headers: {\n        'user-agent': 'Mozilla/4.0 MDN Example',\n        'content-type': 'application/json'\n      },\n      method: 'POST',\n      mode: 'cors',\n    })\n      .then(res => res.json())\n      .then(json => state.session = json);\n  }\n\n\trender() {\n    const currentParticipant = this.state.session && state.session && state.session.participants.find(participant => participant.connectionId === this.state.session.connection.id);\n    let currentUserHasFlaggedJourney = false;\n    if (currentParticipant) {\n      currentUserHasFlaggedJourney = state.session.flags.map(flag => flag.user).indexOf(currentParticipant.connectionId) > -1;\n    }\n\t\treturn (\n\t\t\t<div className='journey-container'>\n\t\t\t\t<p style={{display: 'none'}}>{JSON.stringify(state.session, null, 2)}</p>\n        <audio style={{display: 'none'}} onLoadedMetadata={this.onLoadedMetadata} key={state.session && state.session.journey} controls=\"true\" ref={audioTag => { this.audioTag = audioTag }}>\n         <source src={state.session && state.session.journey} type=\"audio/mpeg\"/>\n        </audio>\n\t\t\t\t{this.state.session &&\n          <div style={{position: 'relative'}}>\n            <button style={{position: 'absolute', top: 0, right: 0}} className='btn btn-danger btn-flag-session' disabled={currentUserHasFlaggedJourney} onClick={this.onFlag}>{currentUserHasFlaggedJourney ? \"You've flagged this journey\" : \"Flag this journey\"}</button>\n            <div className='row'>\n              <div className='col-6'>\n                <h2>{state.session.journey.split('/')[state.session.journey.split('/').length - 1]}</h2>\n                { currentParticipant && state.session.participants.indexOf(currentParticipant) === 0 &&\n                  <div>\n                    <select className='mb-3' onChange={this.onChangeJourney} value={state.session && state.session.journey}>\n                      {state.journeys.map(journey => (\n                        <option value={journey}>{journey.split('/')[journey.split('/').length -1]}</option>\n                      ))}\n                    </select>\n                    { state.session.state === 'created' &&\n                      <div className='mb-2'>\n                        <button onClick={this.onStartSession} className='btn btn-primary'>Start session <i className=\"fa fa-play\" ariaHidden=\"true\"></i></button>\n                      </div>\n                    }\n                  </div>\n                }\n              </div>\n            </div>\n            <div className='row'>\n              <div className='col-3'>\n                <progress max=\"100\" value={this.state.playerProgress} style={{width: '100%'}}></progress>\n                <p style={{display: 'flex'}}><strong style={{flex: 1}}>Time remaining:</strong><span>{this.timeRemaining}</span></p>\n              </div>\n            </div>\n            <div className='row'>\n              <div className='tok-container col' ref={container => this.container = container }>\n                {this.state.streams.length == 0 &&\n                  <p>Waiting for others to join this journey...</p>\n                }\n                <div className='row no-gutters' style={{display: 'grid', gridTemplateColumns: 'repeat(3, 1fr)', gridGap: '10px', marginRight: '350px'}}>\n                  {this.state.streams.map(stream => {\n                    const participant = state.session.participants.find(participant => participant.connectionId === stream.connection.id);\n                    return (\n                      <div className={`subscriber`}>\n                        <p style={{fontSize: '14px'}} className={participant && participant.ready ? 'text-success' : 'text-warning'}>{participant && participant.ready ? 'Ready to start!' : 'Not ready yet'}</p>\n                        <OTSubscriber\n                          key={stream.id}\n                          session={this.sessionHelper.session}\n                          stream={stream}\n                        />\n                      </div>\n                    );\n                  })}\n                </div>\n                <div style={{position: 'fixed', bottom: 0, right: 0}}>\n                  <OTPublisher session={this.sessionHelper.session} onInit={this.onInitPublisher} ref={publisher => {this.publisher = publisher}}/>\n                  {currentParticipant && currentParticipant.ready &&\n                    <p>You are ready!</p>\n                  }\n                  {(!currentParticipant || !currentParticipant.ready) &&\n                    <a className='btn btn-primary' href='#' onClick={this.onConfirmReady}>Ready?</a>\n                  }\n                </div>\n              </div>\n            </div>\n          </div>\n\t\t\t\t}\n\t\t\t</div>\n\t\t)\n\t}\n}\n\nexport default view(Room);\n\n\n\n// WEBPACK FOOTER //\n// ../client/src/components/Room.js","import { store } from 'react-easy-state'\n\nexport default store({\n  ...(global.__INITIAL_STATE__ || {}),\n  session: null,\n  journeys: [],\n});\n\n\n\n// WEBPACK FOOTER //\n// ../client/src/state.js","module.exports = require(\"prop-types\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"prop-types\"\n// module id = 34\n// module chunks = 0","module.exports = require(\"uuid\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"uuid\"\n// module id = 35\n// module chunks = 0","module.exports = require(\"opentok-layout-js\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"opentok-layout-js\"\n// module id = 36\n// module chunks = 0","module.exports = require(\"es6-promise\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"es6-promise\"\n// module id = 37\n// module chunks = 0"],"sourceRoot":""}